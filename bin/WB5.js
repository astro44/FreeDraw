(function(l){var g={browser:null,version:null,os:null,isIE:function(){return"Explorer"==g.browser},isVista:function(){return-1!=navigator.userAgent.indexOf("Windows NT 6.0")},isXP:function(){return-1!=navigator.userAgent.indexOf("Windows NT 5")},isWindows:function(){return"Windows"==g.os},isWP8:function(){return-1!=navigator.userAgent.indexOf("Windows Phone 8")},isWP7:function(){return-1!=navigator.userAgent.indexOf("Windows Phone 7")},isAndroid:function(){return-1!=navigator.userAgent.indexOf("Android")},
isIE9:function(){return this.isIE()&&9==this.getInternetExplorerVersion()},isMac:function(){return"Mac"==g.os||g.isIOS()},isIOS:function(){return"iPhone/iPod"==g.os||"iPad"==g.os},isIOSRetina:function(){return g.isIOS()&&1<window.devicePixelRatio},isMobileSafari:function(){return g.isSafari()&&g.isIOS()},isSafari:function(){return"Safari"==g.browser},isChrome:function(){return"Chrome"==g.browser},isFirefox:function(){return"Firefox"==g.browser||"Mozilla"==g.browser},isOpera:function(){return"Opera"==
g.browser},getInternetExplorerVersion:function(){var g=-1;"Microsoft Internet Explorer"==navigator.appName&&null!=/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)&&(g=parseFloat(RegExp.$1));return g}};g._dataBrowser=[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",
versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},
{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}];g._dataOS=[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.userAgent,subString:"iPad",identity:"iPad"},{string:navigator.platform,subString:"Linux",identity:"Linux"}];g._versionSearchString=null;g.init=function(){g.browser=g._searchString(g._dataBrowser)||
"An unknown browser";g.version=g._searchVersion(navigator.userAgent)||g._searchVersion(navigator.appVersion)||"An unknown version";g.os=g._searchString(g._dataOS)||"An unknown OS"};g._searchString=function(k){for(var a=0,b=k.length;a<b;a++){var c=k[a].string,f=k[a].prop;g._versionSearchString=k[a].versionSearch||k[a].identity;if(c){if(-1!=c.indexOf(k[a].subString))return k[a].identity}else if(f)return k[a].identity}};g._searchVersion=function(k){var a=k.indexOf(g._versionSearchString);if(-1!=a)return parseFloat(k.substring(a+
g._versionSearchString.length+1))};l.BrowserDetect=g;g.init()})(null!=window.Main?window.Main:window);(function(l){function g(a,b,c,f,h,e){this.Container_constructor();this.method=e;this.color=h;this.label=f;this.name=this.id=a;this.hint=c;this.icon=b;this.type="btn";this.height=this.width=0;this.setup()}var k=createjs.extend(g,createjs.Container);k.setup=function(){var a=window.WBdraw.luma(this.color),b=window.WBdraw.getContrast50(this.color);130>a&&(b="#FFF");a=new createjs.Text(this.label,"20px Arial",b);a.textBaseline="top";a.textAlign="center";this.width=a.getMeasuredWidth()+30;this.height=a.getMeasuredHeight()+
20;a.x=this.width/2;a.y=10;b=new createjs.Shape;b.graphics.beginFill(this.color).drawRoundRect(0,0,this.width,this.height,10);this.addChild(b,a);this.on("click",this.handleClick);this.on("rollover",this.handleRollOver);this.on("rollout",this.handleRollOver);this.cursor="pointer";this.mouseChildren=!1;this.offset=10*Math.random();this.count=0};k.handleClick=function(a){this.method(this,this.id)};k.handleRollOver=function(a){this.alpha="rollover"==a.type?.4:1};l.Button=createjs.promote(g,"Container")})(window.WBdraw);var BUILD="debug";
(function(l){function g(){}function k(a){a=mainStage.getChildByName("BASE_main");window.stats.begin();window.stats1.begin();window.stats2.begin();if(a.width!=mainStage.canvas.width||a.height!=mainStage.canvas.height)if(a.setSize(mainStage.canvas.width,mainStage.canvas.height,"#CCC"),console.log("abc tick  width:"+a.width+"  widthCvs:"+mainStage.canvas.width+"  height:"+a.height+"  heightCvs:"+mainStage.canvas.height),a=mainStage.canvas,void 0!=a){var b=mainStage.getChildByName("BASE_main"),b=new window.WBdraw.ConfigWB(BrowserDetect.os,
b.width,b.height);window.WBdraw.trace(b.width+", "+b.height+", "+b.scaleFactor);a.width=b.width;a.height=b.height;a.style.width=b.width*b.scaleFactor+"px";a.style.height=b.height*b.scaleFactor+"px"}window.stats.end();window.stats1.end();window.stats2.end()}g.main=function(){(new g).initialize()};g.prototype.initialize=function(){this.mainCanvas=document.getElementById("mainCanvas");this.mainCanvas.setStrokeStyle="#FF0000";this.mainStage=new createjs.Stage(this.mainCanvas);this.mainStage.snapToPixelsEnabled=
!0;this.mainStage.id="mainIn";window.mainStage=this.mainStage;this.mainStage.enableMouseOver(10);var a=new Stats,b=new Stats,c=new Stats;a.setMode(0);b.setMode(1);c.setMode(2);a.domElement.style.position="absolute";a.domElement.style.left="0px";a.domElement.style.bottom="10px";document.body.appendChild(a.domElement);window.stats=a;b.domElement.style.position="absolute";b.domElement.style.left="90px";b.domElement.style.bottom="10px";document.body.appendChild(b.domElement);window.stats1=b;c.domElement.style.position=
"absolute";c.domElement.style.left="180px";c.domElement.style.bottom="10px";document.body.appendChild(c.domElement);window.stats2=c;createjs.Ticker.addEventListener("tick",this.mainStage);createjs.Ticker.timingMode=createjs.Ticker.RAF_SYNCHED;createjs.Ticker.setFPS(60);createjs.Ticker.on("tick",k);createjs.Touch.enable(this.mainStage);this.mainStage.enableMouseOver();window.WBdraw.trace("main...start");window.WBdraw.trace(BrowserDetect.browser);window.WBdraw.trace(BrowserDetect.version);window.WBdraw.trace(BrowserDetect.os);
a=new WBdraw.WBoard("BASE_main","#ccc");WBdraw.currentBoard=a;this.mainStage.addChild(a)};l.Main=g})(window);this.ndgmr=this.ndgmr||{};
(function(l){var g=document.createElement("canvas"),k=g.getContext("2d");k.save();var a=document.createElement("canvas"),b=a.getContext("2d");b.save();var c=[],f=function(a,e){var f,b;f=n(a);b=n(e);return m(f,b)};ndgmr.checkRectCollision=f;ndgmr.checkPixelCollision=function(e,m,c,n){if(ndgmr.DEBUG||ndgmr.DEBUG_COLLISION)document.body.appendChild(g),document.body.appendChild(a);n=n||!1;intersection=f(e,m);if(!intersection)return!1;c=Math.min(.99999,c||0);g.width=intersection.width;g.height=intersection.height;
a.width=intersection.width;a.height=intersection.height;e=h(intersection,e,k,1);a:{m=h(intersection,m,b,2);var B=intersection.width,t=intersection.height,u,l,y,x,w=3,v={x:Infinity,y:Infinity,x2:-Infinity,y2:-Infinity};for(x=0;x<t;++x)for(y=0;y<B;++y){u=e.length>w+1?e[w]/255:0;l=m.length>w+1?m[w]/255:0;if(u>c&&l>c)if(n)y<v.x&&(v.x=y),y>v.x2&&(v.x2=y),x<v.y&&(v.y=x),x>v.y2&&(v.y2=x);else{e={x:y,y:x,width:1,height:1};break a}w+=4}Infinity!=v.x?(v.width=v.x2-v.x+1,v.height=v.y2-v.y+1,e=v):e=null}if(e)e.x+=
intersection.x,e.x2+=intersection.x,e.y+=intersection.y,e.y2+=intersection.y;else return!1;return e};var h=function(a,f,b,h){var m,n,g;f instanceof createjs.Bitmap?n=f.image:f instanceof createjs.Sprite&&(frame=f.spriteSheet.getFrame(f.currentFrame),m=frame.image.src+":"+frame.rect.x+":"+frame.rect.y+":"+frame.rect.width+":"+frame.rect.height,c[m]?n=c[m]:c[m]=n=createjs.SpriteSheetUtils.extractFrame(f.spriteSheet,f.currentFrame));m=f.globalToLocal(a.x,a.y);b.restore();b.save();b.rotate(e(f,"rotation")*
(Math.PI/180));b.scale(e(f,"scaleX","*"),e(f,"scaleY","*"));b.translate(-m.x-a["rect"+h].regX,-m.y-a["rect"+h].regY);void 0!=(g=f.sourceRect)?b.drawImage(n,g.x,g.y,g.width,g.height,0,0,g.width,g.height):b.drawImage(n,0,0,n.width,n.height);return b.getImageData(0,0,a.width,a.height).data},e=function(a,f,b){b=b||"+";if(a.parent&&a.parent[f]){var h=a[f];a=e(a.parent,f,b);return"*"==b?h*a:h+a}return a[f]},m=function(a,e){var f,b,h,m,c,n,g,k;f=a.x+(h=a.width/2);b=a.y+(m=a.height/2);c=e.x+(n=e.width/2);
g=e.y+(k=e.height/2);f=Math.abs(f-c)-(h+n);b=Math.abs(b-g)-(m+k);return 0>f&&0>b?(f=Math.min(Math.min(a.width,e.width),-f),b=Math.min(Math.min(a.height,e.height),-b),{x:Math.max(a.x,e.x),y:Math.max(a.y,e.y),width:f,height:b,rect1:a,rect2:e}):null};ndgmr.calculateIntersection=m;var n=function(a){var e={x:Infinity,y:Infinity,width:0,height:0};if(a instanceof createjs.Container){e.x2=-Infinity;e.y2=-Infinity;a=a.children;var f=a.length,b,h;for(h=0;h<f;h++)b=n(a[h]),b.x<e.x&&(e.x=b.x),b.y<e.y&&(e.y=b.y),
b.x+b.width>e.x2&&(e.x2=b.x+b.width),b.y+b.height>e.y2&&(e.y2=b.y+b.height);Infinity==e.x&&(e.x=0);Infinity==e.y&&(e.y=0);Infinity==e.x2&&(e.x2=0);Infinity==e.y2&&(e.y2=0);e.width=e.x2-e.x;e.height=e.y2-e.y;delete e.x2;delete e.y2}else{var m,c,g;a instanceof createjs.Bitmap?(b=a.sourceRect||a.image,m=b.width,c=b.height):a instanceof createjs.Sprite?a.spriteSheet._frames&&a.spriteSheet._frames[a.currentFrame]&&a.spriteSheet._frames[a.currentFrame].image?(b=a.spriteSheet.getFrame(a.currentFrame),m=
b.rect.width,c=b.rect.height,f=b.regX,g=b.regY):(e.x=a.x||0,e.y=a.y||0):(e.x=a.x||0,e.y=a.y||0);f=f||0;m=m||0;g=g||0;c=c||0;e.regX=f;e.regY=g;b=a.localToGlobal(0-f,0-g);h=a.localToGlobal(m-f,c-g);m=a.localToGlobal(m-f,0-g);a=a.localToGlobal(0-f,c-g);e.x=Math.min(Math.min(Math.min(b.x,h.x),m.x),a.x);e.y=Math.min(Math.min(Math.min(b.y,h.y),m.y),a.y);e.width=Math.max(Math.max(Math.max(b.x,h.x),m.x),a.x)-e.x;e.height=Math.max(Math.max(Math.max(b.y,h.y),m.y),a.y)-e.y}return e};ndgmr.getBounds=n})(window.Main);(function(l){function g(a,b,c,f){this.Container_constructor();this.method=c;this.methodStop=f;this.color=b;this.name=this.id=a;this.type="btn";this.height=this.width=0;this.setup()}var k=createjs.extend(g,createjs.Container);k.setup=function(){this.height=this.width=30;var a=new createjs.Shape;a.graphics.beginStroke("#000");a.graphics.beginFill(this.color).drawCircle(0,0,10);this.addChild(a);this.on("click",this.handleClick);this.on("mousedown",this.handlePress);this.on("pressup",this.handleRelease);
this.on("rollover",this.handleRollOver);this.on("rollout",this.handleRollOver);this.cursor="pointer";this.mouseChildren=!1;this.offset=10*Math.random();this.count=0};k.handlePress=function(a){this.method(this,this.id);a.stopImmediatePropagation()};k.handleRelease=function(a){console.log("release");this.methodStop(this,this.id);a.stopImmediatePropagation()};k.handleClick=function(a){a.stopImmediatePropagation()};k.handleRollOver=function(a){this.alpha="rollover"==a.type?.4:1};l.resizeBtn=createjs.promote(g,
"Container")})(window.WBdraw);var Stats=function(){function l(e,a,f){e=document.createElement(e);e.id=a;e.style.cssText=f;return e}function g(e,a,f){var b=l("div",e,"padding:0 0 3px 3px;text-align:left;background:"+f),h=l("div",e+"Text","font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px;color:"+a);h.innerHTML=e.toUpperCase();b.appendChild(h);e=l("div",e+"Graph","width:74px;height:30px;background:"+a);b.appendChild(e);for(a=0;74>a;a++)e.appendChild(l("span","","width:1px;height:30px;float:left;opacity:0.9;background:"+
f));return b}function k(a){for(var f=m.children,b=0;b<f.length;b++)f[b].style.display=b===a?"block":"none";e=a}function a(e,a){e.appendChild(e.firstChild).style.height=Math.min(30,30-30*a)+"px"}var b=self.performance&&self.performance.now?self.performance.now.bind(performance):Date.now,c=b(),f=c,h=0,e=0,m=l("div","stats","width:80px;opacity:0.9;cursor:pointer");m.addEventListener("mousedown",function(a){a.preventDefault();k(++e%m.children.length)},!1);var n=0,q=Infinity,C=0,p=g("fps","#0ff","#002"),
z=p.children[0],B=p.children[1];m.appendChild(p);var t=0,u=Infinity,A=0,p=g("ms","#0f0","#020"),y=p.children[0],x=p.children[1];m.appendChild(p);if(self.performance&&self.performance.memory){var w=0,v=Infinity,D=0,p=g("mb","#f08","#201"),E=p.children[0],F=p.children[1];m.appendChild(p)}k(e);return{REVISION:14,domElement:m,setMode:k,begin:function(){c=b()},end:function(){var e=b();t=e-c;u=Math.min(u,t);A=Math.max(A,t);y.textContent=(t|0)+" MS ("+(u|0)+"-"+(A|0)+")";a(x,t/200);h++;if(e>f+1E3&&(n=Math.round(1E3*
h/(e-f)),q=Math.min(q,n),C=Math.max(C,n),z.textContent=n+" FPS ("+q+"-"+C+")",a(B,n/100),f=e,h=0,void 0!==w)){var m=performance.memory.usedJSHeapSize,g=performance.memory.jsHeapSizeLimit;w=Math.round(9.54E-7*m);v=Math.min(v,w);D=Math.max(D,w);E.textContent=w+" MB ("+v+"-"+D+")";a(F,m/g)}return e},update:function(){c=this.end()}}};"object"===typeof module&&(module.exports=Stats);(function(l){function g(e,a){this.Container_constructor();this.id=this.name=e;this.color=a;this.layers={};this.controller=null;this.currentTab=0;this.allTabs={};this._tempModel=this._sandboxRect=this._isConnector=this._undoRange=this._objectInit=this.shapeNOW=this._currentdeckIndex=null;this._isSynched=!1;this._int=0;this.setup()}function k(e){var a=e.currentTarget;if("links"!=this._tempModel.type){var f=e.stageY-a.rel.y+a.regY;a.x=e.stageX-a.rel.x+a.regX;a.y=f;update=!0;e.stopImmediatePropagation();
a.dispatchEvent({type:"MoveEvent",param:a})}}function a(e){window.WBdraw.trace("=========commited-========"+this.currentTab);var a=e.param;console.log(a);if("links"==a.type&&e.action!=window.WBdraw.FormProxy.DELETE){var f=this.uniqueLink(a,this.currentTab);f&&(window.WBdraw.trace("========= C O P Y ========"),this.onDelete(a,this.currentTab,!1,!0),a=f)}a._commited=!0;this.updateShape(a,e.action,this.currentTab)}function b(a){window.WBdraw.trace("=========onPRESS-========"+this.currentTab);console.log("now target link to this shape if this is the type tool currently in use");
console.log("skip the rest of the function if type == links");a=a.param;console.log("   ===>"+a.id);if("links"==this._tempModel.type){console.log("ola links just happened");var b=null;null==this.shapeNOW?(b=f(this),console.log("=========  ( A )")):"links"==this.shapeNOW.type?(b=this.shapeNOW,console.log("=========  ( B )"+b),b.linked&&console.log("=========  ( C )")):(b=f(this),console.log("=========  ( D )"));b.link(a)?this.shapeNOW=null:(this.shapeNOW=b,b.x=a.x,b.y=a.y,mainStage.addEventListener("stagemousemove",
this.drawLine.bind(this)))}else mainStage.addEventListener("stagemouseup",a.moveEND.bind(a)),a.scaled||(createjs.Tween.get(a,{override:!0}).to({scaleX:1.05,scaleY:1.05},100,createjs.Ease.quadIn),a.scaled=!0,a.rel2=new createjs.Point(mainStage.mouseX-a.x,mainStage.mouseY-a.y),a.rel=new createjs.Point(.5*a.width+a.rel2.x,.5*a.height+a.rel2.y))}function c(a){window.WBdraw.trace("=========onRelease-========"+this.currentTab);var b=a.param;"links"==this._tempModel.type?console.log("ola links just happened"):
(mainStage.removeEventListener("stagemousemove",b.moveSTART),mainStage.removeEventListener("stagemouseup",b.moveEND),window.WBdraw.trace(this.resizer),window.WBdraw.trace("=========onSelect-=22222======="),this.resizer.handleRollOver(a),void 0==this.resizer.parent&&this.addChild(this.resizer),this.resizer.wrapTarget(this.resizer,b),console.log(b),this.shapeNOW=b)}function f(e){console.log("!!!!! create    !!!"+e._tempModel.classIn);var f=e.layers.cvsMAIN,h=e._tempModel.type,q="rcolvi_";e._isSynched||
(q+=e._int,++e._int);h=new (WBdraw["Form"+window.WBdraw.toTitleCase(e._tempModel.classIn)])(q,h);h.x=mainStage.mouseX;h.y=mainStage.mouseY;f.addChild(h);e.shapeNOW=h;h.addEventListener("CommitEvent",a.bind(e));h.addEventListener("PressEvent",b.bind(e));h.addEventListener("ReleaseEvent",c.bind(e));if("links"!=h.type)h.on("pressmove",k.bind(e));return h}var h=createjs.extend(g,createjs.Container);h.getLayer=function(a){return this.layers[a]};h.drawinit=function(a,b,f,h){if(null==f||""==f)f=b;console.log("!@#@!!@###@@@====>>  form:"+
b+" type:"+f);switch(b){case "modify":switch(f){case "delete":null!=this.shapeNOW&&(this.onDelete(this.shapeNOW,this.currentTab,!1,!1),this.shapeNOW=null)}break;case "clear":this.onDeleteAll(this.currentTab);this.shapeNOW=null;break;case "print":break;default:a._objectInit=!1,a._tempModel={classIn:b,type:f,path:h}}};h.shapeTweenUpdate=function(a,b){b.alpha=.5;createjs.Tween.get(owner.form,{override:!0}).to({x:b.x,y:b.y,alpha:1},300,createjs.Ease.quadIn)};h.menuEventProxy=function(a){this.drawinit(this,
a.param[0],a.param[1])};h.shapeStart=function(){if(null!=this.shapeNOW){console.log("...found shape in use..."+this.shapeNOW.id);if(!this.shapeNOW._commited)if("links"!=this.shapeNOW.type)this.shapeNOW.drawPerm(this.shapeNOW,!1);else this.onDelete(this.shapeNOW,this.currentTab,!1,!0);this.shapeNOW=null}console.log(this.shapeNOW);switch(this._tempModel.type){case "select":break;case "ungroup":break;case "links":console.log("links[IN]");break;default:this._objectInit||(window.WBdraw.trace(" Form"+window.WBdraw.toTitleCase(this._tempModel.classIn)),
f(this))}};h.drawing=function(a,b){if(0==this._objectInit&&(console.log("..drawing nwo"),void 0!=this.shapeNOW&&this.shapeNOW!=this.resizer.formTarget)){var f=this.shapeNOW.bg.globalToLocal(a,b);this.shapeNOW.drawTemp(f.x,f.y)}};h.drawdone=function(a){window.WBdraw.trace("...done nwo",h);void 0!=a.shapeNOW&&(a.shapeNOW.drawPerm(a.shapeNOW,!1),"text"==a.shapeNOW.type&&(void 0==a.resizer.parent&&a.addChild(this.resizer),a.resizer.wrapTarget(a.resizer,a.shapeNOW),a.test_draw("line","free")));a.shapeNOW=
null};h.clearObject=function(){this.shapeNOW=null};h.setup=function(){var a=new createjs.Shape;a.alpha=1;a.name=a.id="bg";var b=new WBdraw.Box("cvsDECK","#ccc",!0),f=new WBdraw.Box("cvsMAIN","#ccc",!0),h=new WBdraw.Box("cvsSAND","#ccc",!0);this.layers[b.id]=b;this.layers[f.id]=f;this.layers[h.id]=h;window.WBdraw.trace("8=====1====o");this.resizer=new WBdraw.FormResize("rsize","rtool");this.resizer.x=200;this.resizer.y=20;this.addChild(a,b,f,h);this.menu=new WBdraw.Menu("m1",this);this.menu.addEventListener("MenuEvent",
this.menuEventProxy.bind(this));this.addChild(this.menu);this.on("click",this.handleClick.bind(this));this.on("mousedown",this.handlePress.bind(this));this.on("pressup",this.handleRelease.bind(this));this.offset=10*Math.random();this.count=0;this.test_draw("line","free")};h.width=0;h.height=0;h.setSize=function(a,b,f){var c=this.getChildByName("bg");console.log("resizeBy");c.graphics.clear().beginStroke("#ccc").beginFill(f).drawRect(0,0,a,b);for(var g in this.layers)this.layers[g].setSize(a,b,f);
h.width=a;h.height=b};h.getWidth=function(){console.log("get width");return width};h.wbRegister=function(a,b){};h.clear=function(a,b){};h.wbSwitch=function(a){};h.unshift=function(a){};h.push=function(a){};h.handleClick=function(a){window.WBdraw.trace("click1")};h.handlePress=function(a){console.log("pressing.33gfw...");this.shapeStart();this.on("pressmove",this.drawLine.bind(this));this.resizer.wrapTarget(this.resizer,null);a.stopImmediatePropagation()};h.handleRelease=function(a){this.drawdone(this);
this.off("pressmove",this.drawLine)};h.drawLine=function(a){this.drawing(mainStage.mouseX,mainStage.mouseY)};h.endDraw=function(a){window.WBdraw.trace("enddraw1");this.off("pressmove",this.drawLine)};h.test_draw=function(a,b){window.WBdraw.trace("enddraw1");this.drawinit(this,a,b)};h.onDelete=function(a,b,f,h){window.WBdraw.trace("8=========o");console.log(a);void 0==a?window.WBdraw.trace("<<<<<<<<<< undefined in DELETE >>>>>>>>>>"):(a=this.layers.cvsMAIN.getChildByName(a.name),f||this.updateShape(a,
window.WBdraw.FormProxy.DELETE,b),null!=a&&null!=a.parent&&(console.log(a.parent),a.destroy(h),window.WBdraw.trace("<<<<===delete...====o"),a.commit(window.WBdraw.FormProxy.DELETE),a.removeAllEventListeners(),a.parent.removeChild(a),delete a),h||console.log("send to JMS server"),this.resizer.wrapTarget(this.resizer,null))};h.onDeleteAll=function(a){if(a==this.currentTab){window.WBdraw.trace("< [START] removeAll>");console.log(this.allTabs);for(var b=this.allTabs[a].length;0<this.allTabs[a].length;)console.log(this.allTabs[a][b-
1]),this.onDelete(this.allTabs[a][b-1],a,!0,!1),--b}window.WBdraw.trace("< [END] removeAll>");console.log(this.allTabs[a]);void 0!=this.allTabs[a]&&this.allTabs[a].splice(0)};h.updateShape=function(a,b,f){var h=!1;console.log("~~~~!-updateShape-!~~~~"+f);void 0==a&&(window.WBdraw.trace("<<<<<<<  [1] ???????????   >>>>>>>>>"+a),window.WBdraw.trace("<<<<<<<<<<      >>>>>>>>>>"),window.WBdraw.trace("<<<<<<<<<<      >>>>>>>>>>"),window.WBdraw.trace("<<<<<<<<<< undefined in updateShape >>>>>>>>>>"));void 0==
this.allTabs[f]&&(this.allTabs[f]=[]);var c=this.allTabs[f].length;console.log(this.allTabs);console.log(this.allTabs[f]);var g=new window.WBdraw.FormProxy;window.WBdraw.FormProxy.flattenForm(g,a);void 0==g&&(window.WBdraw.trace("     [2]   <<<<<<<   ???????????   >>>>>>>>>"+g),window.WBdraw.trace("        <<<<<<<<<<      >>>>>>>>>>"),window.WBdraw.trace("        <<<<<<<<<<      >>>>>>>>>>"),window.WBdraw.trace("        <<<<<<<<<< undefined in updateShape >>>>>>>>>>"));for(a=0;a<c;++a)if(this.allTabs[f][a].name==
g.name){b==window.WBdraw.FormProxy.DELETE?this.allTabs[f].splice(a,1):this.allTabs[f][a]=g;h=!0;break}h||b==window.WBdraw.FormProxy.DELETE?b==window.WBdraw.FormProxy.DELETE&&console.log("see if event already exists in undo/redo with SAME timeStamp"):this.allTabs[f].push(g)};h.uniqueLink=function(a,b){console.log("~~~~!-link check-!~~~~"+b);void 0==this.allTabs[b]&&(this.allTabs[b]=[]);for(var f=this.allTabs[b].length,h=a.related,c=null,g=null,k=0;k<f;++k)if("links"==this.allTabs[b][k].type&&this.allTabs[b][k].id!=
a.id){g=this.allTabs[b][k];c=g.related;if(h.to.id==g.id||h.from.id==g.id)if(h.from.id==c.to.id||h.from.id==c.from.id||h.to.id==c.to.id||h.to.id==c.from.id)return console.log("  @@!!@@!!@@found same And ITS A copy"),g;if(c.from.id==h.from.id||c.from.id==h.to.id)if(c.to.id==h.to.id||c.to.id==h.from.id)return f=this.allTabs[b][k],c.from.id!=h.from.id&&(f.bidirection=!0),f}return!1};createjs.EventDispatcher.initialize(g.prototype);l.WBoard=createjs.promote(g,"Container")})(window.WBdraw);(function(l){function g(a,b,c){this.Container_constructor();this.id=this.name=a;this.transparent=c;this.color=b;this.setup()}var k=createjs.extend(g,createjs.Container);k.setup=function(){var a=new createjs.Shape;a.alpha=1;a.name=a.id="bg";this.on("click",this.handleClick);this.on("mousedown",this.handlePress);this.on("pressup",this.handleRelease);console.log("box1");this.offset=10*Math.random();this.count=0};k.width=0;k.height=0;k.setSize=function(a,b,c){k.width=a;k.height=b;if(!this.transparent){var f=
this.getChildByName("bg");console.log("resizerrrBy");f.graphics.clear().beginStroke("#ccc").beginFill(c).drawRect(0,0,a,b);this.cache(0,0,a,b)}};k.getWidth=function(){console.log("get width");return width};k.handleClick=function(a){console.log("click");a.stopImmediatePropagation()};k.handlePress=function(a){console.log(a);console.log("press")};k.handleRelease=function(a){console.log("release");a.stopImmediatePropagation()};k.drawLine=function(a){console.log("draw");a.stopImmediatePropagation()};k.endDraw=
function(a){console.log("enddraw");a.stopImmediatePropagation()};l.Box=createjs.promote(g,"Container")})(window.WBdraw);(function(l){function g(a,c){this.Container_constructor();this.id=this.name=a;this.color="";this.type=c;this.limitDraw=!1;this.rect=null;this.segSize=12;this.regY=this.regX=0;this.scaled=!1;this.tempOrigin=this.rel=null;this.lastXY={x:0,y:0};this.related=null;this._commited=this.biderectional=!1;this.rotary=this.elastic=!0;this.setup()}function k(a,c){0>c.x&&(c.x=Math.abs(c.x),a.x-=c.x);0>c.y&&(c.y=Math.abs(c.y),a.y-=c.y);return c}createjs.EventDispatcher.initialize(g.prototype);var a=createjs.extend(g,
createjs.Container);a.setup=function(){this.points=[];this.bg=new createjs.Shape;this.hitHelper=new createjs.Shape;this.bg.hitArea=this.hitHelper;this.addChild(this.bg);this.on("mousedown",this.handlePress.bind(this));this.on("pressup",this.handleRelease.bind(this));this.cursor="pointer";this.mouseChildren=!1;this.offset=10*Math.random();this.count=0;this.status=window.WBdraw.FormProxy.NEW};a.drawTemp=function(b,c){this._commited=!1;this.uncache();a[this.type](this,b,c)};a.drawPerm=function(b,c){if(b.id==
this.id){try{var f=a[this.type+"Perm"](this,b,c)}catch(h){throw"[E] No function matches:"+this.type+"Perm() in FormFill (wbFormFill.js)";}f&&this.commit(window.WBdraw.FormProxy.UPDATE)}};a.commit=function(a){this.dispatchEvent({type:"CommitEvent",param:this,action:a})};a.scaleState=function(a){this.scaled=a;this.scaleX=this.scaleY=1};a.setSize=function(a,c,f){};a.moveSTART=function(a){a.stopImmediatePropagation();a=a.target;var c;a=a.getObjectsUnderPoint(a.mouseX,a.mouseY,1);for(var f=0;f<a.length;f++)if(a[f].parent.scaled){c=
a[f].parent;break}null!=c&&console.log("@@@  start 9 @@@@")};a.moveEND=function(a){a=a.target;if(this.x!=this.lastXY.x||this.y!=this.lastXY.y){var c;a=a.getObjectsUnderPoint(a.mouseX,a.mouseY,1);for(var f=0;f<a.length;f++)if(a[f].parent.scaled){c=a[f].parent;break}null!=c&&(c.scaled=!1,createjs.Tween.get(c,{override:!0}).to({scaleX:1,scaleY:1},100,createjs.Ease.quadIn));this.commit(window.WBdraw.FormProxy.MOVED);this.lastXY.x=this.x;this.lastXY.y=this.y}};a.handlePress=function(a){var c={type:"PressEvent",
param:this};a.stopImmediatePropagation();this.dispatchEvent(c)};a.handleRelease=function(a){var c={type:"ReleaseEvent",param:this};a.stopImmediatePropagation();this.dispatchEvent(c)};a.handleRollOver=function(a){this.alpha="rollover"==a.type?.4:1};a.square=function(a,c,f){c=new createjs.Point(c,f);f=a.bg.graphics;f.clear();a.points=[];f.setStrokeStyle(5);f.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));f.beginFill("#"+Math.floor(16777215*Math.random()).toString(16));f.rect(0,0,c.x,
c.y);a.points.push(c);f.endStroke();f.endFill()};a.squarePerm=function(a,c,f){c=a.bg.graphics;f=a.bg.hitArea.graphics;c.clear();f.clear();if(0==a.points.length)return a.parent.removeChild(this),!1;olc=a.points[0];lc=k(a,olc);a.regX=0>lc.x?-Math.abs(.5*lc.x):Math.abs(.5*lc.x);a.x+=a.regX;a.regY=0>lc.y?-Math.abs(.5*lc.y):Math.abs(.5*lc.y);a.y+=a.regY;var h=Math.floor(lc.x),e=Math.floor(lc.y);a.width=Math.abs(h);a.height=Math.abs(e);if(10>a.width||10>a.height)return a.parent.removeChild(a),delete a,
!1;c.setStrokeStyle(5);c.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));c.beginFill("#"+Math.floor(16777215*Math.random()).toString(16));f.setStrokeStyle(10);f.beginStroke("#000");f.beginFill("red");f.rect(0,0,h,e);c.rect(0,0,h,e);c.endStroke();f.endStroke();f.endFill();c.endFill();a.cache(-5+(0>h?h:0),-5+(0>e?e:0),a.width+10,a.height+10);return!0};a.circle=function(a,c,f){c=new createjs.Point(c,f);f=a.bg.graphics;f.clear();a.points=[];f.setStrokeStyle(5);f.beginStroke("#"+Math.floor(16777215*
Math.random()).toString(16));f.beginFill("#"+Math.floor(16777215*Math.random()).toString(16));f.drawEllipse(0,0,c.x,c.y);a.points.push(c);f.endStroke();f.endFill()};a.circlePerm=function(a,c,f){c=a.bg.graphics;f=a.bg.hitArea.graphics;c.clear();f.clear();if(0==a.points.length)return a.parent.removeChild(this),!1;olc=a.points[0];lc=k(a,olc);a.regX=0>lc.x?-Math.abs(.5*lc.x):Math.abs(.5*lc.x);a.x+=a.regX;a.regY=0>lc.y?-Math.abs(.5*lc.y):Math.abs(.5*lc.y);a.y+=a.regY;var h=Math.floor(lc.x),e=Math.floor(lc.y);
a.width=Math.abs(h);a.height=Math.abs(e);if(10>a.width||10>a.height)return a.parent.removeChild(a),delete a,!1;c.setStrokeStyle(5);c.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));c.beginFill("#"+Math.floor(16777215*Math.random()).toString(16));f.setStrokeStyle(10);f.beginStroke("#000");f.beginFill("red");f.drawEllipse(0,0,h,e);c.drawEllipse(0,0,h,e);c.endStroke();f.endStroke();f.endFill();c.endFill();a.cache(-5+(0>h?h:0),-5+(0>e?e:0),a.width+10,a.height+10);return!0};a.star=function(a,
c,f){new createjs.Point(c,f);var h={},e=a.bg.graphics;e.clear();a.points=[];e.setStrokeStyle(5);e.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));e.beginFill("#"+Math.floor(16777215*Math.random()).toString(16));console.log("---=-=-=--=-=-=-=-=>>>>");h.radius=c/mainStage.canvas.width*200;h.pointy=f/mainStage.canvas.height*.9;h.points=5;e.drawPolyStar(0,0,h.radius,h.points,h.pointy,-90);a.points.push(h);e.endStroke();e.endFill()};a.starPerm=function(a,c,f){c=a.bg.graphics;f=a.bg.hitArea.graphics;
c.clear();f.clear();if(0==a.points.length)return c=a.parent,console.log(c.getNumChildren()),a.parent.removeChild(this),console.log(c.getNumChildren()),!1;sPos=a.points[0];a.width=Math.abs(Math.floor(2*sPos.radius));a.height=Math.abs(Math.floor(2*sPos.radius));c.setStrokeStyle(5);c.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));c.beginFill("#"+Math.floor(16777215*Math.random()).toString(16));f.setStrokeStyle(10);f.beginStroke("#000");f.beginFill("red");f.drawPolyStar(0,0,sPos.radius,
sPos.points,sPos.pointy,-90);c.drawPolyStar(0,0,sPos.radius,sPos.points,sPos.pointy,-90);a.x-=sPos.radius;a.y-=sPos.radius;this.x+=sPos.radius;this.y+=sPos.radius;c.endStroke();f.endStroke();f.endFill();c.endFill();return!0};a.destroy=function(a){this.uncache();this._commited=!1};l.FormFill=createjs.promote(g,"Container")})(window.WBdraw);(function(l){function g(a,b){this.Container_constructor();this.id=this.name=a;this.color="";this.type=b;this.limitDraw=!1;this.rect=null;this.segSize=12;this.regY=this.regX=0;this.scaled=!1;this.rel=null;this.lastXY={x:0,y:0};this._commited=!1;this.related=this._listenEnd=this._listenMove=null;this.bidirection=!1;this.rotary=this.elastic=!0;this.setup()}function k(f){console.log(f);a(this,"MoveEvent")}function a(a,b){var e=a.related.to,c=a.related.from;a.x=c.x;a.y=c.y;a.points=[];a.points.push(new createjs.Point(e.x-
c.x,e.y-c.y));a.linksPerm(a,e,c,a.bidirection);null!=b&&a.commit(b)}function b(f){f.action==window.WBdraw.FormProxy.DELETE?(this._commited=!1,this.commit(f.action),this.parent&&this.parent.removeChild(this),this.destroy(!1)):a(this,window.WBdraw.FormProxy.UPDATE);console.log(f)}createjs.EventDispatcher.initialize(g.prototype);var c=createjs.extend(g,createjs.Container);c.setup=function(){this.points=[];this.bg=new createjs.Shape;this.hitHelper=new createjs.Shape;this.bg.hitArea=this.hitHelper;this.addChild(this.bg);
this.on("mousedown",this.handlePress.bind(this));this.on("pressup",this.handleRelease.bind(this));this.cursor="pointer";this.mouseChildren=!1;this.offset=10*Math.random();this.count=0;"links"==this.type&&(this.elastic=this.rotary=!1,this.arrow=new createjs.Shape,this.ball=new createjs.Shape,this.addChild(this.arrow,this.ball));this.status=window.WBdraw.FormProxy.NEW};c.drawTemp=function(a,b){this._commited=!1;c[this.type](this,a,b)};c.linked=function(){console.log(this.related);return null!=this.related?
null!=this.related.from:!1};c.link=function(a){var h={from:null,to:null};if(null!=this.related){h=this.related;if(h.from==a)return console.log("[E]  --\x3eSAME shape AS to"),!1;if(null!=h.to&&null!=h.from)return!0;h.to=a;console.log(h);a=h.to;var e=h.from;this._listenMove=k.bind(this);this._listenEnd=b.bind(this);a.addEventListener("MoveEvent",this._listenMove);e.addEventListener("MoveEvent",this._listenMove);a.addEventListener("CommitEvent",this._listenEnd);e.addEventListener("CommitEvent",this._listenEnd);
(finalIn=this.linksPerm(this,h.to,h.from,this.bidirection))&&this.commit(window.WBdraw.FormProxy.UPDATE);return!0}h.from=a;this.related=h;return!1};c.drawPerm=function(a,b){if(a.id==this.id){try{var e=c[this.type+"Perm"](this,a,b)}catch(g){throw console.log(g),"[E] No function matches:"+this.type+"Perm() in FormLine (wbFormLine.js)";}e&&this.commit(window.WBdraw.FormProxy.UPDATE)}};c.commit=function(a){this.dispatchEvent({type:"CommitEvent",param:this,action:a})};c.width=0;c.height=0;c.scaleState=
function(a){this.scaled=a;this.scaleX=this.scaleY=1};c.setSize=function(a,b,e){};c.getWidth=function(){return width};c.moveSTART=function(a){a.stopImmediatePropagation();a=a.target;for(var b,e=a.getObjectsUnderPoint(a.mouseX,a.mouseY,1),c=0;c<e.length;c++)if(e[c].parent.scaled){b=e[c].parent;break}null!=b&&(b.x=a.mouseX-b.rel.x+b.regX,b.y=a.mouseY-b.rel.y+b.regY)};c.moveEND=function(a){a=a.target;if(this.x!=this.lastXY.x||this.y!=this.lastXY.y){var b;a=a.getObjectsUnderPoint(a.mouseX,a.mouseY,1);
for(var e=0;e<a.length;e++)if(a[e].parent.scaled){b=a[e].parent;break}null!=b&&(b.scaled=!1,createjs.Tween.get(b,{override:!0}).to({scaleX:1,scaleY:1},100,createjs.Ease.quadIn));this.commit(window.WBdraw.FormProxy.MOVED);this.lastXY.x=this.x;this.lastXY.y=this.y}};c.handlePress=function(a){var b={type:"PressEvent",param:this};a.stopImmediatePropagation();this.dispatchEvent(b)};c.handleRelease=function(a){var b={type:"ReleaseEvent",param:this};a.stopImmediatePropagation();this.dispatchEvent(b)};c.handleRollOver=
function(a){this.alpha="rollover"==a.type?.4:1};c.straight=function(a,b,e){b=new createjs.Point(b,e);e=a.bg.graphics;e.clear();a.points=[];e.setStrokeStyle(5);d=Math.sqrt(b.x*b.x+b.y*b.y);r=d%a.segSize;tot=d/a.segSize;for(var c=0,g=0,q=0;q<tot;++q){var k=q/tot*b.x,p=q/tot*b.y;e.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));e.moveTo(c,g);e.lineTo(k,p);c=k;g=p}e.moveTo(c,g);e.lineTo(b.x,b.y);a.points.push(b);e.endStroke()};c.straightPerm=function(a,b,e){b=a.bg.graphics;e=a.bg.hitArea.graphics;
b.clear();e.clear();if(0==a.points.length)return a.parent.removeChild(this),!1;lc=a.points[0];a.regX=0>lc.x?-Math.abs(.5*lc.x):Math.abs(.5*lc.x);a.x+=a.regX;a.regY=0>lc.y?-Math.abs(.5*lc.y):Math.abs(.5*lc.y);a.y+=a.regY;b.setStrokeStyle(5);b.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));e.setStrokeStyle(10);e.beginStroke("#000");e.beginFill("red");e.moveTo(0,0);b.moveTo(0,0);b.lineTo(lc.x,lc.y);e.lineTo(lc.x,lc.y);b.endStroke();e.endStroke();e.endFill();a.setDimension(a,lc.x,lc.y);
return!0};c.free=function(a,b,e){var c=a.bg.graphics,g=a.points[a.points.length-1],q=0;b=new createjs.Point(b,e);c.setStrokeStyle(5);c.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));void 0==g&&(g=new createjs.Point(0,0));q=b.y;e=g.x;var k=g.y,q=Math.sqrt((e-=b.x)*e+(k-=q)*k);q>a.segSize&&(c.moveTo(g.x,g.y),c.lineTo(b.x,b.y),c.endStroke(),a.points.push(b))};c.freePerm=function(a,b,e){b=a.bg.graphics;e=a.bg.hitArea.graphics;var c=a.points.length;if(0==c)return a.parent.removeChild(this),
!1;new createjs.Point(0,0);b.clear();b.setStrokeStyle(5);b.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));e.setStrokeStyle(10);e.beginStroke("#000");e.beginFill("red");for(var g=0,q=0,k=0,p=0,z=0,l=0,t=0;t<c;++t){var u=a.points[t];u.x>q&&(q=u.x);u.y>g&&(g=u.y);u.x<k&&(k=u.x);u.y<p&&(p=u.y)}0>k&&(z=k);0>p&&(l=p);for(t=0;t<c;++t)a.points[t].x+=Math.abs(z),a.points[t].y+=Math.abs(l),u=a.points[t],0==t&&(e.moveTo(u.x,u.y),b.moveTo(u.x,u.y)),b.lineTo(u.x,u.y),e.lineTo(u.x,u.y);b.endStroke();
e.endStroke();e.endFill();a.x+=z;a.y+=l;a.rect=new createjs.Rectangle(0,0,Math.abs(z)+q,Math.abs(l)+g);b=.5*a.rect.width;e=.5*a.rect.height;a.x-=b;a.y-=e;a.regX=b;a.x+=2*b;a.regY=e;a.y+=2*e;a.setDimension(a,a.rect.width,a.rect.height);return!0};c.bezier=function(a,b,e){var c={x:0,y:0},g=a.bg.graphics;e=new createjs.Point(b,e);g.clear();a.points=[];g.setStrokeStyle(5);b=Math.round(e.x);e=Math.round(e.y);c.fx=b;c.cx=c.fx;c.fy=e;c.cy=c.y;g.setStrokeStyle(1);g.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));
g.moveTo(c.fx,c.fy);g.lineTo(c.cx,c.cy);g.lineTo(c.x,c.y);g.setStrokeStyle(5);g.bezierCurveTo(c.fx,c.fy,c.cx,c.cy,c.x,c.y);a.points.push(c);g.endStroke()};c.bezierPerm=function(a,b,e){var c=a.points.length;b=a.bg.graphics;e=a.bg.hitArea.graphics;b.clear();e.clear();if(0==c)return b=a.parent,console.log(b.getNumChildren()),a.parent.removeChild(this),console.log(b.getNumChildren()),!1;c=a.points[0];e.setStrokeStyle(25);e.beginStroke("#000");b.setStrokeStyle(5);b.beginStroke("#"+Math.floor(16777215*
Math.random()).toString(16));b.bezierCurveTo(c.fx,c.fy,c.cx,c.cy,c.x,c.y);e.bezierCurveTo(c.fx,c.fy,c.cx,c.cy,c.x,c.y);b.endStroke();e.endStroke();a.setDimension(a,c.cx,c.fy);return!0};c.links=function(a,b,e){b=new createjs.Point(b,e);e=a.bg.graphics;e.clear();a.points=[];e.setStrokeStyle(5);d=Math.sqrt(b.x*b.x+b.y*b.y);r=d%a.segSize;tot=d/a.segSize;for(var c=0,g=0,q=0;q<tot;++q){var k=q/tot*b.x,p=q/tot*b.y;e.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));e.moveTo(c,g);e.lineTo(k,
p);c=k;g=p}e.moveTo(c,g);e.lineTo(b.x,b.y);a.points.push(b);e.endStroke()};c.linksPerm=function(a,b,e,c){a.straightPerm(a,a,!1);return!0};c.connectorFollowEdge=function(a,b,e){point=new createjs.Point(b.x+.5*b.width,b.y+.5*b.height);target=new createjs.Point(e.x+.5*e.width,e.y+.5*e.height);b=point.x-target.x;var c=point.y-target.y;a=c;b>c&&(a=b);b=Math.atan2(target.Y-point.Y,target.X-point.X);for(var c=canvas.getContext("2d"),g=0;g<a;++g){var q=2*Math.sin(b),k=2*Math.cos(b),q=new createjs.Point(e.x+
k,e.y+q),q=c.getImageData(q.x,q.y,2,2).data,q="rgba("+q[pos]+","+q[pos+1]+","+q[pos+2]+","+q[pos+3]+")";"#CCCCCC"==q&&console.log("pixel found::"+q);console.log(" found::"+q)}};c.setDimension=function(a,b,e){a.width=Math.abs(b);a.height=Math.abs(e);console.log(a.width+"x"+a.height)};c.destroy=function(a){this.uncache();this._commited=!1;if("links"==this.type){a=this.related.to;var b=this.related.from;a&&(a.removeEventListener("MoveEvent",this._listenMove),a.removeEventListener("CommitEvent",this._listenEnd));
b.removeEventListener("MoveEvent",this._listenMove);b.removeEventListener("CommitEvent",this._listenEnd)}console.log(" delete link in FormLine................................")};l.FormLine=createjs.promote(g,"Container")})(window.WBdraw);(function(l){function g(a,b){console.log("hellow NO dude");this.segSize=3;this.id=this.name=null;this.color=k;this.type=null;this.status=k;this.pod=this.tab=null;this.y=this.x=0;this.related=this.points=this.type=k;this.biderectional=!1}var k="";g.NEW=1;g.UPDATE=2;g.DELETE=3;g.CLEAR=4;g.ORDER=5;g.STATISTIC=6;g.DELETE_SELECTABLE_AREA=7;g.MOVED=2;g.setup=function(){};g.flattenForm=function(a,b){a.id=a.name=b.name;a.x=b.x;a.y=b.y;a.status=b.status;a.type=b.type;a.points=b.points;a.related=b.related;
a.biderectional=b.biderectional;a.arrow=b.arrow;a.ball=b.ball;a.tab=b.tab;a.pod=b.pod;return a};l.FormProxy=g})(window.WBdraw);(function(l){function g(a,b){this.Container_constructor();this.id=this.name=a;this.color="";this.type=b;this.limitDraw=!1;this.rect=null;this.segSize=12;this.tolerance=10;this.regY=this.regX=0;this.scaled=!1;this.TXT=this.boxr=this.box4=this.box3=this.box2=this.box1=this.formTargetLAST=this.formTarget=this.rel=null;this.setup();console.log("@@@@@@  NEW FormResize  ")}function k(a,e){null!==this.TXT&&(this.TXT.visible=!1);if(-1!=e.indexOf("r"))a.on("pressmove",b.bind(this));else a.on("pressmove",c.bind(this));
return""}function a(a,b){a.off("pressmove");console.log("bx1------------\x3e>>>>>>>>>>> stop"+this.formTarget.type);this.formTarget.globalToLocal(2*this.box4.x,2*this.box4.y);this.rotation=this.formTarget.rotation;switch(this.formTarget.type){case "bezier":break;case "free":break;default:this.formTarget.x=this.x-this.box4.x+this.tolerance,this.formTarget.y=this.y-this.box4.y+this.tolerance,this.formTarget.drawTemp(2*this.box4.x-2*this.tolerance,2*this.box4.y-2*this.tolerance),this.formTarget.drawPerm(this.formTarget)}null!==
this.TXT&&(this.TXT.visible=!0,f(this,this.formTarget));this.formTarget.commit("resize");return""}function b(a){a=this.globalToLocal(a.stageX,a.stageY);var b=0-Math.sqrt(Math.abs(a.x-0)*Math.abs(a.x-0)+Math.abs(a.y-0)*Math.abs(a.y-0));a=360*Math.atan2(a.y-b,a.x-0)/Math.PI;this.formTarget.rotation=a+this.rotation}function c(a){var b=a.currentTarget,c=this.globalToLocal(a.stageX,a.stageY),f=0,g=0,f=b.x,g=b.y;b.x=c.x;b.y=c.y;nX=Math.abs(c.x);nY=Math.abs(c.y);var c=Math.ceil(.5*nX),k=Math.ceil(.5*nY),
n=!1,m=this.box1.globalToLocal(a.stageX,a.stageY),l=this.box2.globalToLocal(a.stageX,a.stageY),x=this.box3.globalToLocal(a.stageX,a.stageY);a=this.box4.globalToLocal(a.stageX,a.stageY);if(10>c||10>k)n=!0;this.box1.hitTest(m.x,m.y)&&"bx1"!=b.name?n=!0:this.box2.hitTest(l.x,l.y)&&"bx2"!=b.name?n=!0:this.box3.hitTest(x.x,x.y)&&"bx3"!=b.name?n=!0:this.box4.hitTest(a.x,a.y)&&"bx4"!=b.name&&(n=!0);n?(b.x=f,b.y=g):(h(this,2*c,2*k,b),e(this,Math.ceil(nX),Math.ceil(nY)))}function f(a,b){var c=window.WBdraw.getCanvasDiv("editTxt");
window.WBdraw.getCanvasDiv("txt2edit").style.width="inherit";c.style.width=b.width+"px";var c=Math.ceil(.5*b.width)+a.tolerance,e=Math.ceil(.5*b.height)+a.tolerance;a.TXT.x=-c+5;a.TXT.y=-e+5}function h(a,b,c,e){"bx4"!=e.name&&(a.box4.x=b,a.box4.y=c);"bx3"!=e.name&&(a.box3.x=0-b,a.box3.y=c);"bx2"!=e.name&&(a.box2.x=b,a.box2.y=0-c);"bx1"!=e.name&&(a.box1.x=0-b,a.box1.y=0-c);a.boxr.x=0;a.boxr.y=-60-c}function e(a,b,c){var e=a.bg.graphics;e.clear();e.beginStroke("red");e.setStrokeStyle(2);var f=new createjs.Point(-b,
-c),g=new createjs.Point(0,0),h=new createjs.Point(b,-c),k=new createjs.Point(b,c),n=new createjs.Point(-b,c);b=new createjs.Point(b,c);c=new createjs.Point(0,-60-c);m(e,f,h,!1);m(e,f,n,!0);m(e,n,k,!1);m(e,h,b,!0);a.boxr.visible&&m(e,c,g,!0)}function m(a,b,c,e){dx1=b.x;var f=dx2=c.x;dy1=b.y;c=dy2=c.y;d=Math.sqrt((dx2-=dx1)*dx2+(dy2-=dy1)*dy2);tot=d/12;var g=b.x;b=b.y;for(var h=d/tot,k=0;k<=tot;++k){if(e){var n=Math.ceil(b+h),m=f;b=n<b?b-2:b+2;if(n>Math.abs(c))break}else{var m=Math.ceil(g+h),n=c,g=
m<g?g-2:g+2;if(Math.abs(m)>Math.abs(f))break}a.moveTo(g,b);a.lineTo(m,n);g=m;b=n}}createjs.EventDispatcher.initialize(g.prototype);var n=createjs.extend(g,createjs.Container);n.setup=function(){this.points=[];this.bg=new createjs.Shape;this.box1=new WBdraw.resizeBtn("bx1","#FFF",k.bind(this),a.bind(this));this.box2=new WBdraw.resizeBtn("bx2","#FFF",k.bind(this),a.bind(this));this.box3=new WBdraw.resizeBtn("bx3","#FFF",k.bind(this),a.bind(this));this.box4=new WBdraw.resizeBtn("bx4","#FFF",k.bind(this),
a.bind(this));this.boxr=new WBdraw.resizeBtn("bxr","#FFF",k.bind(this),a.bind(this));var b=window.WBdraw.getCanvasDiv("editTxt");b.style.display="none";b.innerHTML='<textarea name="txt2edit" id="txt2edit" cols="" rows="" style="width:inherit" readOnly>dfasf</textarea>';var c=window.WBdraw.getCanvasDiv("txt2edit"),e=this;c.onclick=function(a){c.readOnly=!1};c.onblur=function(a){null!=e.formTargetLAST&&(e.formTargetLAST.setText(c.value),e.formTargetLAST.commit("text"));e.formTargetLAST=null};this.TXT=
new createjs.DOMElement(b);this.addChild(this.bg,this.box1,this.box2,this.box3,this.box4,this.boxr,this.TXT)};n.width=0;n.height=0;n.handleRollOver=function(a){this.alpha="rollover"==a.type?.4:1};n.wrapTarget=function(a,b){var c=window.WBdraw.getCanvasDiv("editTxt"),g=window.WBdraw.getCanvasDiv("txt2edit");if(null==b)g.blur(),null!=a.formTarget&&(a.formTarget.scaleState(!1),a.formTargetLAST=a.formTarget),a.formTarget=null,a.parent&&a.parent.removeChild(this),c.style.display="none";else{this.rotation=
b.rotation;var k="text"==b.type;k&&g.blur();a.formTargetLAST=a.formTarget;a.formTarget=b;a.x=b.x;a.y=b.y;var n=Math.ceil(.5*b.width)+a.tolerance,m=Math.ceil(.5*b.height)+a.tolerance;a.box4.visible=a.box3.visible=a.box2.visible=a.box1.visible=b.elastic;a.boxr.visible=b.rotary;f(a,b);h(a,n,m,"");e(a,n,m);null!=a.formTarget&&(k?(a.formTargetLAST=a.formTarget,""!=a.formTarget.text.text&&(c.style.display="block",g.focus(),g.value=a.formTarget.text.text,"enter text here"==g.value&&g.select())):c.style.display=
"none")}};l.FormResize=createjs.promote(g,"Container")})(window.WBdraw);(function(l){function g(a,b,c,f){this.Container_constructor();this.id=this.name=a;this.color=f;this.type=c;this.label=b;this.setup();this._commited=!1}var k=createjs.extend(g,createjs.Container);k.setup=function(){var a=new createjs.Text(this.label,"20px Arial","#000");a.name=a.id="txt";a.textBaseline="top";a.textAlign="center";var b=a.getMeasuredWidth()+30,c=a.getMeasuredHeight()+20;a.x=b/2;a.y=10;var f=new createjs.Shape;f.name=f.id="bg";f.graphics.setStrokeStyle(5);f.graphics.beginStroke("#"+Math.floor(16777215*
Math.random()).toString(16));f.graphics.beginFill(this.color).drawRoundRect(0,0,b,c,10);this.addChild(f,a);this.on("click",this.handleClick);this.on("rollover",this.handleRollOver);this.on("rollout",this.handleRollOver);this.on("mousedown",this.handlePress);this.on("pressup",this.handleRelease);this.cursor="pointer";this.mouseChildren=!1;this.offset=10*Math.random();this.count=0};k.handleClick=function(a){};k.hello=function(a){console.log(a);k.width=100};k.width=0;k.height=0;k.setSize=function(a,
b,c){target.getChildByName("bg").graphics.clear().beginStroke("#ccc").beginFill("#"+Math.floor(16777215*Math.random())).drawRect(0,0,a,b);k.width=a;k.height=b};k.getWidth=function(){return width};k.handlePress=function(a){mainStage.addEventListener("stagemousemove",this.drawLine);mainStage.addEventListener("stagemouseup",this.endDraw);console.log(this.id);this.scaled||(createjs.Tween.get(this,{override:!0}).to({scaleX:1.1,scaleY:1.1},100,createjs.Ease.quadIn),this.scaled=!0,this.rel=this.globalToLocal(mainStage.mouseX,
mainStage.mouseY))};k.handleRelease=function(a){mainStage.removeEventListener("stagemousemove",this.drawLine);mainStage.removeEventListener("stagemouseup",this.endDraw);this.dispatchEvent({type:"SelectEvent",param:this})};k.drawLine=function(a){a=a.target;for(var b,c=a.getObjectsUnderPoint(a.mouseX,a.mouseY,1),f=0;f<c.length;f++)if(c[f].parent.scaled){b=c[f].parent;break}null!=b&&(b.x=a.mouseX-b.rel.x,b.y=a.mouseY-b.rel.y,b.getChildByName("bg").graphics.clear().beginStroke("#"+Math.floor(16777215*
Math.random())).beginFill("#"+Math.floor(16777215*Math.random())).drawRect(0,0,a.mouseX,a.mouseY))};k.endDraw=function(a){a=a.target;var b;a=a.getObjectsUnderPoint(a.mouseX,a.mouseY,1);for(var c=0;c<a.length;c++)if(a[c].parent.scaled){b=a[c].parent;break}console.log(b.scaled);null!=b&&(b.scaled=!1,createjs.Tween.get(b,{override:!0}).to({scaleX:1,scaleY:1},100,createjs.Ease.quadIn))};k.handleRollOver=function(a){this.alpha="rollover"==a.type?.4:1};l.FormShape=createjs.promote(g,"Container")})(window.WBdraw);(function(l){function g(a,b){this.Container_constructor();this.id=this.name=a;this.color="000";this.type=b;this.limitDraw=!1;this.rect=null;this.segSize=12;this.regY=this.regX=0;this.scaled=!1;this.tempOrigin=this.text=this.rel=null;this.lastXY={x:0,y:0};this.points=[];this.related=null;this.biderectional=!1;this.label="enter text here";this.rotary=this.elastic=!0;this.setup()}createjs.EventDispatcher.initialize(g.prototype);var k=createjs.extend(g,createjs.Container);k.setup=function(){this.bg=new createjs.Shape;
this.hitHelper=new createjs.Shape;this.text=new createjs.Text(this.label,"20px Arial","#000");this.text.hitArea=this.hitHelper;this.addChild(this.bg,this.text);this.on("mousedown",this.handlePress.bind(this));this.on("pressup",this.handleRelease.bind(this));this.cursor="pointer";this.mouseChildren=!1;this.offset=10*Math.random();this.count=0;this.text.name=this.text.id="txt";this.text.textBaseline="top";this.text.textAlign="left";this.text.wordWrap=!0;this.width=this.text.getMeasuredWidth()+30;this.height=
this.text.getMeasuredHeight()+20;this.points.push(new createjs.Point(this.text.getMeasuredWidth()+30,this.text.getMeasuredHeight()+20));this.squarePerm(this);this.status=window.WBdraw.FormProxy.NEW};k.setText=function(a){this.text.text=a;this.updateCache()};k.drawTemp=function(a,b){this.uncache();this.bg.alpha=1;this.square(this,a,b)};k.drawPerm=function(a,b){if(a.id==this.id){try{var c=this.squarePerm(this,a,b)}catch(f){throw console.log(f),"[E] No function matches:"+this.type+"Perm() in FormText (wbFormText.js)";
}console.log("...create....");c&&this.commit(window.WBdraw.FormProxy.UPDATE)}};k.commit=function(a){this.dispatchEvent({type:"CommitEvent",param:this,action:a})};k.width=0;k.height=0;k.scaleState=function(a){this.scaled=a;this.scaleX=this.scaleY=1};k.setSize=function(a,b,c){};k.getWidth=function(){return width};k.moveSTART=function(a){a.stopImmediatePropagation();for(var b=a.target,c,b=b.getObjectsUnderPoint(b.mouseX,b.mouseY,1),f=0;f<b.length;f++)if(b[f].parent.scaled){c=b[f].parent;break}null!=
c&&(console.log(c.rel+","+c.regX),console.log(a),console.log("@@@  start 9 @@@@"))};k.moveEND=function(a){a=a.target;if(this.x!=this.lastXY.x||this.y!=this.lastXY.y){var b;a=a.getObjectsUnderPoint(a.mouseX,a.mouseY,1);for(var c=0;c<a.length;c++)if(a[c].parent.scaled){b=a[c].parent;break}null!=b&&(b.scaled=!1,createjs.Tween.get(b,{override:!0}).to({scaleX:1,scaleY:1},100,createjs.Ease.quadIn));console.log("...moved....");this.commit(window.WBdraw.FormProxy.MOVED);this.lastXY.x=this.x;this.lastXY.y=
this.y}};k.handlePress=function(a){console.log("...handlePress....");var b={type:"PressEvent",param:this};a.stopImmediatePropagation();this.dispatchEvent(b)};k.handleRelease=function(a){var b={type:"ReleaseEvent",param:this};a.stopImmediatePropagation();this.dispatchEvent(b)};k.handleRollOver=function(a){this.alpha="rollover"==a.type?.4:1};k.square=function(a,b,c){b=new createjs.Point(b,c);c=a.bg.graphics;c.clear();a.points=[];c.setStrokeStyle(5);c.beginStroke("#000");c.beginFill("#FFF");c.rect(0,
0,b.x,b.y);a.points.push(b);c.endStroke();c.endFill()};k.squarePerm=function(a,b,c){b=a.bg.graphics;c=a.text.hitArea.graphics;b.clear();c.clear();if(0==a.points.length)return b=a.parent,console.log(b.getNumChildren()),a.parent.removeChild(this),console.log(b.getNumChildren()),!1;var f=olc=a.points[0];0>f.x&&(f.x=Math.abs(f.x),a.x-=f.x);0>f.y&&(f.y=Math.abs(f.y),a.y-=f.y);lc=f;a.regX=0>lc.x?-Math.abs(.5*lc.x):Math.abs(.5*lc.x);a.x+=a.regX;a.regY=0>lc.y?-Math.abs(.5*lc.y):Math.abs(.5*lc.y);a.y+=a.regY;
var f=Math.floor(lc.x),g=Math.floor(lc.y);a.width=Math.abs(f);a.height=Math.abs(g);if(30>a.width||20>a.height)a.width<a.text.getMeasuredWidth()&&(a.width=a.text.getMeasuredWidth()+30),a.height<a.text.getMeasuredHeight()&&(a.height=a.text.getMeasuredHeight()+20);b.setStrokeStyle(5);b.beginStroke("#000");b.beginFill("#FFF");c.setStrokeStyle(10);c.beginStroke("#000");c.beginFill("red");c.rect(0,0,f,g);b.rect(0,0,f,g);b.endStroke();c.endStroke();c.endFill();b.endFill();a.text.x=a.text.y=5;a.text.lineWidth=
f;a.text.width=f;a.text.height=g;a.bg.visible=!1;a.cache(-5+(0>f?f:0),-5+(0>g?g:0),a.width+10,a.height+10);return!0};k.destroy=function(a){this.uncache();this._commited=!1};l.FormText=createjs.promote(g,"Container")})(window.WBdraw);(function(l){function g(a,b){this.Container_constructor();this.id=this.name=a;this.color=b;this.hi_Y=0;this.Controller=null;this.matrix=new createjs.Matrix2D;this.angle=Math.PI/12;this.currentMenu="";this.options={};this.subscriberWL={select:!0,line:!0,fill:!0,math:!0,media:!0,select:!1,print:!0,clear:!0,modify:!0,text:!0,undo:!0,redo:!0};this.hostWL={select:!0,line:!0,fill:!0,math:!0,media:!0,select:!0,print:!0,clear:!0,modify:!0,text:!0,undo:!0,redo:!0};this.options.BR=[{name:"select",btns:{icon:"ss.png",
hint:"select opject",action:"select"}},{name:"line",btns:{icon:"ss.png",hint:"line",">":[{name:"free",icon:"ss.png",action:"method1",hint:""},{name:"straight",icon:"ss.png",action:"method1",hint:""},{name:"bezier",icon:"ss.png",action:"method1",hint:""},{name:"links",icon:"ss.png",action:"method1",hint:""}]}},{name:"fill",btns:{icon:"ss.png",hint:"fill",">":[{name:"square",icon:"ss.png",action:"method1",hint:""},{name:"circle",icon:"ss.png",action:"method1",hint:""},{name:"star",icon:"ss.png",action:"method1",
hint:""}]}},{name:"math",btns:{icon:"ss.png",hint:"math",">":[{name:"sqrt",icon:"ss.png",action:"method1",hint:""},{name:"axis",icon:"ss.png",action:"method1",hint:""},{name:"graph",icon:"ss.png",action:"method1",hint:""}]}},{name:"media",btns:{icon:"ss.png",hint:"media",">":[{name:"ppt",icon:"ss.png",action:"method1",hint:""},{name:"video",icon:"ss.png",action:"method1",hint:""}]}},{name:"select_area",btns:{icon:"ss.png",hint:"selectable area",">":[{name:"add",icon:"ss.png",action:"method1",hint:""},
{name:"remove",icon:"ss.png",action:"method1",hint:""}]}},{name:"text",btns:{icon:"ss.png",hint:"text area",action:"method1"}},{name:"print",btns:{icon:"ss.png",hint:"selectable area",action:"print"}},{name:"clear",btns:{icon:"ss.png",hint:"selectable area",action:"method1"}},{name:"modify",btns:{icon:"ss.png",hint:"modify",">":[{name:"delete",icon:"ss.png",action:"method1",hint:""},{name:"color",icon:"ss.png",action:"method1",hint:""},{name:"alpha",icon:"ss.png",action:"method1",hint:""},{name:"undo",
icon:"ss.png",action:"method1",hint:""},{name:"redu",icon:"ss.png",action:"method1",hint:""}]}}];this.options.EN=[{name:"select",btns:{icon:"ss.png",hint:"select opject",action:"select"}},{name:"line",btns:{icon:"ss.png",hint:"line",">":[{name:"free",icon:"ss.png",action:"method1",hint:""},{name:"straight",icon:"ss.png",action:"method1",hint:""},{name:"bezier",icon:"ss.png",action:"method1",hint:""},{name:"links",icon:"ss.png",action:"method1",hint:""}]}},{name:"fill",btns:{icon:"ss.png",hint:"fill",
">":[{name:"square",icon:"ss.png",action:"method1",hint:""},{name:"circle",icon:"ss.png",action:"method1",hint:""},{name:"star",icon:"ss.png",action:"method1",hint:""}]}},{name:"math",btns:{icon:"ss.png",hint:"math",">":[{name:"sqrt",icon:"ss.png",action:"method1",hint:""},{name:"axis",icon:"ss.png",action:"method1",hint:""},{name:"graph",icon:"ss.png",action:"method1",hint:""}]}},{name:"media",btns:{icon:"ss.png",hint:"media",">":[{name:"ppt",icon:"ss.png",action:"method1",hint:""},{name:"video",
icon:"ss.png",action:"method1",hint:""}]}},{name:"select_area",btns:{icon:"ss.png",hint:"selectable area",">":[{name:"add",icon:"ss.png",action:"method1",hint:""},{name:"remove",icon:"ss.png",action:"method1",hint:""}]}},{name:"text",btns:{icon:"ss.png",hint:"text area",action:"method1"}},{name:"print",btns:{icon:"ss.png",hint:"selectable area",action:"print"}},{name:"clear",btns:{icon:"ss.png",hint:"selectable area",action:"method1"}},{name:"modify",btns:{icon:"ss.png",hint:"modify",">":[{name:"delete",
icon:"ss.png",action:"method1",hint:""},{name:"color",icon:"ss.png",action:"method1",hint:""},{name:"alpha",icon:"ss.png",action:"method1",hint:""},{name:"undo",icon:"ss.png",action:"method1",hint:""},{name:"redu",icon:"ss.png",action:"method1",hint:""}]}}];this.setup()}function k(a,c){b(a.parent.parent)}function a(a,b){}function b(a){createjs.Tween.get(a.submenu,{override:!0}).to({x:a.menucontain.width,scaleX:0},250,createjs.Ease.quadIn);createjs.Tween.get(a.menucontain,{override:!0}).to({x:0,scaleX:1},
250,createjs.Ease.quadIn);window.WBdraw.trace("-----\x3eOUT");window.WBdraw.trace(a);window.WBdraw.trace(a.hi_Y);if(0!=a.hi_Y){var b=a.getChildByName("hi");createjs.Tween.get(b,{override:!0}).to({y:a.hi_Y},250,createjs.Ease.quadIn)}}function c(a,b){var c=a.parent.parent;void 0==c.options&&console.log("[E] submenu functions out of context. Please make sure function is delegated");var g=void 0;null==g&&(g="EN");var h=c.options[g];stot=h.length;g=c.hostWL=null;if(c.submenu.currentMenu!=b){c.submenu.requestedMenu(b);
c.submenu.removeAllBtns();var p=new WBdraw.Button("back","back.png","back to menu","back","#999",k);c.submenu.addChild(p);g=p;for(p=0;p<stot;++p){var l=h[p];if(c.subscriberWL[l.name]&&l.name==b){h=l.btns[">"];stot=h.length;for(l=0;l<stot;++l)p=new WBdraw.Button(h[l].name,h[l].icon,h[l].hint,h[l].name,"#"+Math.floor(16777215*Math.random()).toString(16),f),null!=g?(p.x=0,p.y=g.y+g.height+10):p.x=p.y=0,p.alpha=.5,c.submenu.addChild(p),g=p;break}}window.WBdraw.trace(".........FINISHED ");c.submenu.setSize(c.menucontain.width,
c.menucontain.height,"#"+Math.floor(16777215*Math.random()).toString(16),!0);c.submenu.x=c.menucontain.width;c.submenu.scaleX=0}createjs.Tween.get(c.submenu,{override:!0}).to({x:0,scaleX:1},250,createjs.Ease.quadIn);createjs.Tween.get(c.menucontain,{override:!0}).to({x:0,scaleX:.01},250,createjs.Ease.quadIn);window.WBdraw.trace("-----\x3eIN");window.WBdraw.trace(c.hi_Y);0!=c.hi_Y&&(c=c.getChildByName("hi"),createjs.Tween.get(c,{override:!0}).to({y:-20},250,createjs.Ease.quadIn))}function f(a,c){var f=
a.parent.parent,g=f.getChildByName("hi"),h="",k="",l;if(0==f.submenu.scaleX)h=a.name,l=a;else{l=f.menucontain.getChildByName(f.submenu.currentMenu);var B=4,t;a:{t=f.options.EN;tot=t.length;for(var u=0;u<tot;++u){var A=t[u],y=A.btns[">"];if(void 0!=y)for(var x=y.length,w=0;w<x;++w)if(y[w].name==a.name){t=[A.name,a.name];break a}}t=[a.name]}console.log("....submenu Button pressed...");1<t.length&&(h=t[0],k=t[1])}g.x=f.menucontain.x+f.menucontain.width;null!=l&&(f.hi_Y=l.y,f.setHiSize(B,l.height,"#FF0000"));
window.WBdraw.trace("---==>> ||>>  main:"+h+"  sub:"+k);window.WBdraw.trace("........---------__bb__---\x3e>>>>   event Controller>>>>>   ");f.dispatchEvent({type:"MenuEvent",param:[h,k]});0==f.submenu.x&&b(f)}createjs.EventDispatcher.initialize(g.prototype);var h=createjs.extend(g,createjs.Container);h.getLayer=function(a){return this.layers[a]};h.hi_Y=0;h.width=0;h.height=0;h.setup=function(){var a=new createjs.Shape,b=new createjs.Shape;a.alpha=1;a.name=a.id="bg";b.alpha=1;b.name=b.id="hi";this.menucontain=
new WBdraw.MenuBar("wbmenu");this.menucontain.scaleX=1;this.submenu=new WBdraw.MenuBar("sub_wbmenu");this.menubuttons(this.options);this.addChild(a,this.menucontain,b,this.submenu);this.on("mousedown",this.handlePress);this.on("pressup",this.handleRelease);this.on("pressmove",this.moveLocally);window.WBdraw.trace("box1");this.offset=10*Math.random();this.count=0};h.setSize=function(a,b,c){this.setBgSize(a,b,c);this.width=a;this.height=b;for(var f in this.layers)this.layers[f].setSize(a,b,c);h.width=
a;h.height=b};h.setBgSize=function(a,b,c){var f=this.getChildByName("bg");null!=f&&f.graphics.clear().beginStroke("#ccc").beginFill(c).drawRect(0,0,a,b)};h.setHiSize=function(a,b,c){var f=this.getChildByName("hi");null!=f&&f.graphics.clear().beginFill(c).drawRect(0,0,a,b)};h.getWidth=function(){window.WBdraw.trace("get width");return width};h.wbRegister=function(a,b){};h.clear=function(a,b){};h.wbSwitch=function(a){};h.unshift=function(a){};h.push=function(a){};h.handlePress=function(a){a.stopImmediatePropagation()};
h.handleRelease=function(a){a.stopImmediatePropagation()};h.moveLocally=function(a){a.stopImmediatePropagation()};h.menubuttons=function(b,g){null==g&&(g="EN");options=b[g];stot=options.length;var h=this.hostWL=null,k=null,k=this.oInvoke,k=new WBdraw.Button("up","up.png","back to menu","up","#999",a);this.menucontain.addChild(k);for(var h=k,l=0;l<stot;++l){var p=options[l];this.subscriberWL[p.name]&&(k=void 0==p.btns[">"]?f:k=c,k=new WBdraw.Button(p.name,p.btns.icon,p.btns.hint,p.name,"#"+Math.floor(16777215*
Math.random()).toString(16),k),null!=h?(k.x=0,k.y=h.y+h.height+10):k.x=k.y=0,k.alpha=.5,this.menucontain.addChild(k,null==h?!0:!1),h=k)}window.WBdraw.trace("________done...");h=this.menucontain.getSize();console.log(h);createjs.Tween.get(this).wait(1).wait(300).call(this.setBgSize,[h.x,h.y,"#DDD"],this)};l.Menu=createjs.promote(g,"Container")})(window.WBdraw);(function(l){function g(a,b,c,f){this.Container_constructor();this.id=this.name=a;this.color=f;this.label=b;this.text=new createjs.Text("tools","20px Arial","#000");this.setup();this.currentMenu=""}var k=createjs.extend(g,createjs.Container);k.requestedMenu=function(a){this.currentMenu=a};k.addChild=function(a){console.log(a.id);this.Container_addChild(a);this.setSize(a.x+a.width,a.y+a.height,"#"+Math.floor(16777215*Math.random()).toString(16));a=this.children;for(var b in a)"btn"==a[b].type&&(a[b].x=
.5*Math.abs(this.width-a[b].width))};k.width=function(a){console.log("@@!!!!@@@  "+this.getWidth());this.Container_width(a)};k.removeAllBtns=function(){for(var a=this.children.length,b=0;b<a;++b)console.log(this.children[b]),"btn"==this.children[b].type&&(this.removeChild(this.children[b]),--a,--b)};k.setup=function(){this.scaleX=0;var a=new createjs.Shape;a.name=a.id="bg";a.alpha=.5;this.on("mousedown",this.handlePress);this.on("pressup",this.handleRelease);this.on("pressmove",this.moveLocally);
this.addChild(a);this.offset=10*Math.random();this.count=0};k.handlePress=function(a){a.stopImmediatePropagation()};k.handleRelease=function(a){a.stopImmediatePropagation()};k.moveLocally=function(a){a.stopImmediatePropagation()};k.width=0;k.height=0;k.setSize=function(a,b,c,f){var g=this.getChildByName("bg");if(null==g)throw Error("FAILED to load bg in wbMenuBar");g.graphics.clear().beginStroke("#ccc").beginFill(c).drawRect(0,0,a,b);this.width=a;this.height=b;if(f)for(c=this.children.length,f=0;f<
c;++f)"btn"==this.children[f].type&&(this.children[f].width=a),this.children[f].height=b};k.getWidth=function(){return width};k.getSize=function(){return new createjs.Point(this.width,this.height)};k.endDraw=function(a){a=a.target;var b;a=a.getObjectsUnderPoint(a.mouseX,a.mouseY,1);for(var c=0;c<a.length;c++)if(a[c].parent.scaled){b=a[c].parent;break}console.log(b.scaled);null!=b&&(b.scaled=!1,createjs.Tween.get(b,{override:!0}).to({scaleX:1,scaleY:1},100,createjs.Ease.quadIn))};l.MenuBar=createjs.promote(g,
"Container")})(window.WBdraw);(function(l){function g(g,a,b){this.initialize(g,a,b)}g.PLATFORM_DESKTOP="desktop";g.PLATFORM_WP7="wp7";g.PLATFORM_WP8="wp8";g.PLATFORM_IPHONE="iPhone";g.PLATFORM_IPHONE3="iPhone3";g.PLATFORM_IPHONE_PINNED="iPhonePinned";g.PLATFORM_IPHONE3_PINNED="iPhone3Pinned";g.QUALITY_NORMAL=0;g.QUALITY_HIGH=1;g.QUALITY_LOW=2;g.prototype={touchEnabled:!1,isIOS:!1,width:1024,height:622,scaleFactor:1,platform:null,quality:g.QUALITY_NORMAL,initialize:function(k,a,b){null!=a&&(this.width=a);null!=b&&(this.height=
b);this.platform=k;switch(k){case g.PLATFORM_DESKTOP:this.width=1024;this.height=622;break;case g.PLATFORM_WP7:this.width=800;this.height=410;this.scaleFactor=.6;this.quality=g.QUALITY_LOW;break;case g.PLATFORM_WP8:this.width=1280;this.height=700;this.scaleFactor=.6;this.quality=g.QUALITY_HIGH;break;case g.PLATFORM_IPHONE:this.width=960,this.height=640,this.scaleFactor=.5,this.quality=g.QUALITY_HIGH}},toString:function(){return"[Config.ConfigWB]"}};l.ConfigWB=g})(window.WBdraw);
//# sourceMappingURL=final.map
