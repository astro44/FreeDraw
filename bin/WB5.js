(function(m){var h={browser:null,version:null,os:null,isIE:function(){return"Explorer"==h.browser},isVista:function(){return-1!=navigator.userAgent.indexOf("Windows NT 6.0")},isXP:function(){return-1!=navigator.userAgent.indexOf("Windows NT 5")},isWindows:function(){return"Windows"==h.os},isWP8:function(){return-1!=navigator.userAgent.indexOf("Windows Phone 8")},isWP7:function(){return-1!=navigator.userAgent.indexOf("Windows Phone 7")},isAndroid:function(){return-1!=navigator.userAgent.indexOf("Android")},
isIE9:function(){return this.isIE()&&9==this.getInternetExplorerVersion()},isMac:function(){return"Mac"==h.os||h.isIOS()},isIOS:function(){return"iPhone/iPod"==h.os||"iPad"==h.os},isIOSRetina:function(){return h.isIOS()&&1<window.devicePixelRatio},isMobileSafari:function(){return h.isSafari()&&h.isIOS()},isSafari:function(){return"Safari"==h.browser},isChrome:function(){return"Chrome"==h.browser},isFirefox:function(){return"Firefox"==h.browser||"Mozilla"==h.browser},isOpera:function(){return"Opera"==
h.browser},getInternetExplorerVersion:function(){var g=-1;"Microsoft Internet Explorer"==navigator.appName&&null!=/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)&&(g=parseFloat(RegExp.$1));return g}};h._dataBrowser=[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",
versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},
{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}];h._dataOS=[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.userAgent,subString:"iPad",identity:"iPad"},{string:navigator.platform,subString:"Linux",identity:"Linux"}];h._versionSearchString=null;h.init=function(){h.browser=h._searchString(h._dataBrowser)||
"An unknown browser";h.version=h._searchVersion(navigator.userAgent)||h._searchVersion(navigator.appVersion)||"An unknown version";h.os=h._searchString(h._dataOS)||"An unknown OS"};h._searchString=function(g){for(var a=0,b=g.length;a<b;a++){var c=g[a].string,f=g[a].prop;h._versionSearchString=g[a].versionSearch||g[a].identity;if(c){if(-1!=c.indexOf(g[a].subString))return g[a].identity}else if(f)return g[a].identity}};h._searchVersion=function(g){var a=g.indexOf(h._versionSearchString);if(-1!=a)return parseFloat(g.substring(a+
h._versionSearchString.length+1))};m.BrowserDetect=h;h.init()})(null!=window.Main?window.Main:window);(function(m){function h(a,b,c,f,k,e){this.Container_constructor();this.method=e;this.color=k;this.label=f;this.name=this.id=a;this.hint=c;this.icon=b;this.type="btn";this.height=this.width=0;this.setup()}var g=createjs.extend(h,createjs.Container);g.setup=function(){var a=window.WBdraw.luma(this.color),b=window.WBdraw.getContrast50(this.color);130>a&&(b="#FFF");a=new createjs.Text(this.label,"20px Arial",b);a.textBaseline="top";a.textAlign="center";this.width=a.getMeasuredWidth()+30;this.height=a.getMeasuredHeight()+
20;a.x=this.width/2;a.y=10;b=new createjs.Shape;b.graphics.beginFill(this.color).drawRoundRect(0,0,this.width,this.height,10);this.addChild(b,a);this.on("click",this.handleClick);this.on("rollover",this.handleRollOver);this.on("rollout",this.handleRollOver);this.cursor="pointer";this.mouseChildren=!1;this.offset=10*Math.random();this.count=0};g.handleClick=function(a){this.method(this,this.id)};g.handleRollOver=function(a){this.alpha="rollover"==a.type?.4:1};m.Button=createjs.promote(h,"Container")})(window.WBdraw);var BUILD="debug";
(function(m){function h(){}function g(a){a=mainStage.getChildByName("BASE_main");window.stats.begin();window.stats1.begin();window.stats2.begin();if(a.width!=mainStage.canvas.width||a.height!=mainStage.canvas.height)if(a.setSize(mainStage.canvas.width,mainStage.canvas.height,"#CCC"),console.log("abc tick  width:"+a.width+"  widthCvs:"+mainStage.canvas.width+"  height:"+a.height+"  heightCvs:"+mainStage.canvas.height),a=mainStage.canvas,void 0!=a){var b=mainStage.getChildByName("BASE_main"),b=new window.WBdraw.ConfigWB(BrowserDetect.os,
b.width,b.height);window.WBdraw.trace(b.width+", "+b.height+", "+b.scaleFactor);a.width=b.width;a.height=b.height;a.style.width=b.width*b.scaleFactor+"px";a.style.height=b.height*b.scaleFactor+"px"}window.stats.end();window.stats1.end();window.stats2.end()}h.main=function(){(new h).initialize()};h.prototype.initialize=function(){this.mainCanvas=document.getElementById("mainCanvas");this.mainCanvas.setStrokeStyle="#FF0000";this.mainStage=new createjs.Stage(this.mainCanvas);this.mainStage.snapToPixelsEnabled=
!0;this.mainStage.id="mainIn";window.mainStage=this.mainStage;this.mainStage.enableMouseOver(10);var a=new Stats,b=new Stats,c=new Stats;a.setMode(0);b.setMode(1);c.setMode(2);a.domElement.style.position="absolute";a.domElement.style.left="0px";a.domElement.style.bottom="10px";document.body.appendChild(a.domElement);window.stats=a;b.domElement.style.position="absolute";b.domElement.style.left="90px";b.domElement.style.bottom="10px";document.body.appendChild(b.domElement);window.stats1=b;c.domElement.style.position=
"absolute";c.domElement.style.left="180px";c.domElement.style.bottom="10px";document.body.appendChild(c.domElement);window.stats2=c;createjs.Ticker.addEventListener("tick",this.mainStage);createjs.Ticker.timingMode=createjs.Ticker.RAF_SYNCHED;createjs.Ticker.setFPS(60);createjs.Ticker.on("tick",g);createjs.Touch.enable(this.mainStage);this.mainStage.enableMouseOver();window.WBdraw.trace("main...start");window.WBdraw.trace(BrowserDetect.browser);window.WBdraw.trace(BrowserDetect.version);window.WBdraw.trace(BrowserDetect.os);
a=new WBdraw.WBoard("BASE_main","#ccc");WBdraw.currentBoard=a;this.mainStage.addChild(a)};m.Main=h})(window);this.ndgmr=this.ndgmr||{};
(function(m){var h=document.createElement("canvas"),g=h.getContext("2d");g.save();var a=document.createElement("canvas"),b=a.getContext("2d");b.save();var c=[],f=function(e,a){var b,c;b=n(e);c=n(a);return p(b,c)};ndgmr.checkRectCollision=f;ndgmr.checkPixelCollision=function(e,p,n,c){if(ndgmr.DEBUG||ndgmr.DEBUG_COLLISION)document.body.appendChild(h),document.body.appendChild(a);c=c||!1;intersection=f(e,p);if(!intersection)return!1;n=Math.min(.99999,n||0);h.width=intersection.width;h.height=intersection.height;
a.width=intersection.width;a.height=intersection.height;e=k(intersection,e,g,1);a:{p=k(intersection,p,b,2);var B=intersection.width,t=intersection.height,u,w,q,m,v=3,x={x:Infinity,y:Infinity,x2:-Infinity,y2:-Infinity};for(m=0;m<t;++m)for(q=0;q<B;++q){u=e.length>v+1?e[v]/255:0;w=p.length>v+1?p[v]/255:0;if(u>n&&w>n)if(c)q<x.x&&(x.x=q),q>x.x2&&(x.x2=q),m<x.y&&(x.y=m),m>x.y2&&(x.y2=m);else{e={x:q,y:m,width:1,height:1};break a}v+=4}Infinity!=x.x?(x.width=x.x2-x.x+1,x.height=x.y2-x.y+1,e=x):e=null}if(e)e.x+=
intersection.x,e.x2+=intersection.x,e.y+=intersection.y,e.y2+=intersection.y;else return!1;return e};var k=function(a,b,p,n){var f,k,g;b instanceof createjs.Bitmap?k=b.image:b instanceof createjs.Sprite&&(frame=b.spriteSheet.getFrame(b.currentFrame),f=frame.image.src+":"+frame.rect.x+":"+frame.rect.y+":"+frame.rect.width+":"+frame.rect.height,c[f]?k=c[f]:c[f]=k=createjs.SpriteSheetUtils.extractFrame(b.spriteSheet,b.currentFrame));f=b.globalToLocal(a.x,a.y);p.restore();p.save();p.rotate(e(b,"rotation")*
(Math.PI/180));p.scale(e(b,"scaleX","*"),e(b,"scaleY","*"));p.translate(-f.x-a["rect"+n].regX,-f.y-a["rect"+n].regY);void 0!=(g=b.sourceRect)?p.drawImage(k,g.x,g.y,g.width,g.height,0,0,g.width,g.height):p.drawImage(k,0,0,k.width,k.height);return p.getImageData(0,0,a.width,a.height).data},e=function(a,b,p){p=p||"+";if(a.parent&&a.parent[b]){var n=a[b];a=e(a.parent,b,p);return"*"==p?n*a:n+a}return a[b]},p=function(e,a){var b,p,n,c,f,k,g,h;b=e.x+(n=e.width/2);p=e.y+(c=e.height/2);f=a.x+(k=a.width/2);
g=a.y+(h=a.height/2);b=Math.abs(b-f)-(n+k);p=Math.abs(p-g)-(c+h);return 0>b&&0>p?(b=Math.min(Math.min(e.width,a.width),-b),p=Math.min(Math.min(e.height,a.height),-p),{x:Math.max(e.x,a.x),y:Math.max(e.y,a.y),width:b,height:p,rect1:e,rect2:a}):null};ndgmr.calculateIntersection=p;var n=function(e){var a={x:Infinity,y:Infinity,width:0,height:0};if(e instanceof createjs.Container){a.x2=-Infinity;a.y2=-Infinity;e=e.children;var b=e.length,p,c;for(c=0;c<b;c++)p=n(e[c]),p.x<a.x&&(a.x=p.x),p.y<a.y&&(a.y=p.y),
p.x+p.width>a.x2&&(a.x2=p.x+p.width),p.y+p.height>a.y2&&(a.y2=p.y+p.height);Infinity==a.x&&(a.x=0);Infinity==a.y&&(a.y=0);Infinity==a.x2&&(a.x2=0);Infinity==a.y2&&(a.y2=0);a.width=a.x2-a.x;a.height=a.y2-a.y;delete a.x2;delete a.y2}else{var f,k,g;e instanceof createjs.Bitmap?(p=e.sourceRect||e.image,f=p.width,k=p.height):e instanceof createjs.Sprite?e.spriteSheet._frames&&e.spriteSheet._frames[e.currentFrame]&&e.spriteSheet._frames[e.currentFrame].image?(p=e.spriteSheet.getFrame(e.currentFrame),f=
p.rect.width,k=p.rect.height,b=p.regX,g=p.regY):(a.x=e.x||0,a.y=e.y||0):(a.x=e.x||0,a.y=e.y||0);b=b||0;f=f||0;g=g||0;k=k||0;a.regX=b;a.regY=g;p=e.localToGlobal(0-b,0-g);c=e.localToGlobal(f-b,k-g);f=e.localToGlobal(f-b,0-g);e=e.localToGlobal(0-b,k-g);a.x=Math.min(Math.min(Math.min(p.x,c.x),f.x),e.x);a.y=Math.min(Math.min(Math.min(p.y,c.y),f.y),e.y);a.width=Math.max(Math.max(Math.max(p.x,c.x),f.x),e.x)-a.x;a.height=Math.max(Math.max(Math.max(p.y,c.y),f.y),e.y)-a.y}return a};ndgmr.getBounds=n})(window.Main);(function(m){function h(a,b,c,f){this.Container_constructor();this.method=c;this.methodStop=f;this.color=b;this.name=this.id=a;this.type="btn";this.height=this.width=0;this.setup()}var g=createjs.extend(h,createjs.Container);g.setup=function(){this.height=this.width=30;var a=new createjs.Shape;a.graphics.beginStroke("#000");a.graphics.beginFill(this.color).drawCircle(0,0,10);this.addChild(a);this.on("click",this.handleClick);this.on("mousedown",this.handlePress);this.on("pressup",this.handleRelease);
this.on("rollover",this.handleRollOver);this.on("rollout",this.handleRollOver);this.cursor="pointer";this.mouseChildren=!1;this.offset=10*Math.random();this.count=0};g.handlePress=function(a){this.method(this,this.id);a.stopImmediatePropagation()};g.handleRelease=function(a){console.log("release");this.methodStop(this,this.id);a.stopImmediatePropagation()};g.handleClick=function(a){a.stopImmediatePropagation()};g.handleRollOver=function(a){this.alpha="rollover"==a.type?.4:1};m.resizeBtn=createjs.promote(h,
"Container")})(window.WBdraw);var Stats=function(){function m(e,a,b){e=document.createElement(e);e.id=a;e.style.cssText=b;return e}function h(e,a,b){var p=m("div",e,"padding:0 0 3px 3px;text-align:left;background:"+b),l=m("div",e+"Text","font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px;color:"+a);l.innerHTML=e.toUpperCase();p.appendChild(l);e=m("div",e+"Graph","width:74px;height:30px;background:"+a);p.appendChild(e);for(a=0;74>a;a++)e.appendChild(m("span","","width:1px;height:30px;float:left;opacity:0.9;background:"+
b));return p}function g(a){for(var b=p.children,l=0;l<b.length;l++)b[l].style.display=l===a?"block":"none";e=a}function a(e,a){e.appendChild(e.firstChild).style.height=Math.min(30,30-30*a)+"px"}var b=self.performance&&self.performance.now?self.performance.now.bind(performance):Date.now,c=b(),f=c,k=0,e=0,p=m("div","stats","width:80px;opacity:0.9;cursor:pointer");p.addEventListener("mousedown",function(a){a.preventDefault();g(++e%p.children.length)},!1);var n=0,l=Infinity,C=0,y=h("fps","#0ff","#002"),
z=y.children[0],B=y.children[1];p.appendChild(y);var t=0,u=Infinity,w=0,y=h("ms","#0f0","#020"),q=y.children[0],A=y.children[1];p.appendChild(y);if(self.performance&&self.performance.memory){var v=0,x=Infinity,D=0,y=h("mb","#f08","#201"),E=y.children[0],F=y.children[1];p.appendChild(y)}g(e);return{REVISION:14,domElement:p,setMode:g,begin:function(){c=b()},end:function(){var e=b();t=e-c;u=Math.min(u,t);w=Math.max(w,t);q.textContent=(t|0)+" MS ("+(u|0)+"-"+(w|0)+")";a(A,t/200);k++;if(e>f+1E3&&(n=Math.round(1E3*
k/(e-f)),l=Math.min(l,n),C=Math.max(C,n),z.textContent=n+" FPS ("+l+"-"+C+")",a(B,n/100),f=e,k=0,void 0!==v)){var p=performance.memory.usedJSHeapSize,g=performance.memory.jsHeapSizeLimit;v=Math.round(9.54E-7*p);x=Math.min(x,v);D=Math.max(D,v);E.textContent=v+" MB ("+x+"-"+D+")";a(F,p/g)}return e},update:function(){c=this.end()}}};"object"===typeof module&&(module.exports=Stats);(function(m){function h(e,a){this.Container_constructor();this.id=this.name=e;this.color=a;this.layers={};this.controller=null;this.currentTab=0;this.allTabs={};this._tempModel=this._sandboxRect=this._isConnector=this._undoRange=this._objectInit=this.shapeNOW=this._currentdeckIndex=null;this._isSynched=!1;this._int=0;this._pressMove=null;this.setup()}function g(e){var a=e.currentTarget;if("links"!=this._tempModel.type){var b=e.stageY-a.rel.y+a.regY;a.x=e.stageX-a.rel.x+a.regX;a.y=b;update=!0;e.stopImmediatePropagation();
a.dispatchEvent({type:"MoveEvent",param:a})}}function a(e){window.WBdraw.trace("=========commited-========"+this.currentTab);var a=e.param;console.log(a);if("links"==a.type&&e.action!=window.WBdraw.FormProxy.DELETE){var b=this.uniqueLink(a,this.currentTab);b&&(window.WBdraw.trace("========= C O P Y ========"),this.onDelete(a,this.currentTab,!1,!0),a=b)}a._commited=!0;this.updateShape(a,e.action,this.currentTab)}function b(e){window.WBdraw.trace("=========onPRESS-========"+this.currentTab);console.log("now target link to this shape if this is the type tool currently in use");
console.log("skip the rest of the function if type == links");e=e.param;console.log("   ===>"+e.id);if("links"==this._tempModel.type){console.log("ola links just happened");var a=null;null==this.shapeNOW?(a=f(this),console.log("=========  ( A )")):"links"==this.shapeNOW.type?(a=this.shapeNOW,console.log("=========  ( B )"+a),a.linked&&console.log("=========  ( C )")):(a=f(this),console.log("=========  ( D )"));a.link(e)?(this.shapeNOW=null,mainStage.removeEventListener("stagemousemove",this._pressMove)):
(this.shapeNOW=a,a.x=e.x,a.y=e.y,mainStage.addEventListener("stagemousemove",this._pressMove))}else mainStage.addEventListener("stagemouseup",e.moveEND.bind(e)),e.scaled||(createjs.Tween.get(e,{override:!0}).to({scaleX:1.05,scaleY:1.05},100,createjs.Ease.quadIn),e.scaled=!0,e.rel2=new createjs.Point(mainStage.mouseX-e.x,mainStage.mouseY-e.y),e.rel=new createjs.Point(.5*e.width+e.rel2.x,.5*e.height+e.rel2.y))}function c(e){window.WBdraw.trace("=========onRelease-========"+this.currentTab);var a=e.param;
"links"==this._tempModel.type?console.log("ola links just happened"):(mainStage.removeEventListener("stagemousemove",a.moveSTART),mainStage.removeEventListener("stagemouseup",a.moveEND),window.WBdraw.trace(this.resizer),window.WBdraw.trace("=========onSelect-=22222======="),this.resizer.handleRollOver(e),void 0==this.resizer.parent&&this.addChild(this.resizer),this.resizer.wrapTarget(this.resizer,a),console.log(a),this.shapeNOW=a)}function f(e){console.log("!!!!! create    !!!"+e._tempModel.classIn);
var p=e.layers.cvsMAIN,n=e._tempModel.type,l="rcolvi_";e._isSynched||(l+=e._int,++e._int);n=new (WBdraw["Form"+window.WBdraw.toTitleCase(e._tempModel.classIn)])(l,n);n.x=mainStage.mouseX;n.y=mainStage.mouseY;p.addChild(n);e.shapeNOW=n;n.addEventListener("CommitEvent",a.bind(e));n.addEventListener("PressEvent",b.bind(e));n.addEventListener("ReleaseEvent",c.bind(e));if("links"!=n.type)n.on("pressmove",g.bind(e));return n}var k=createjs.extend(h,createjs.Container);k.getLayer=function(e){return this.layers[e]};
k.drawinit=function(e,a,b,l){if(null==b||""==b)b=a;console.log("!@#@!!@###@@@====>>  form:"+a+" type:"+b);switch(a){case "modify":switch(b){case "delete":null!=this.shapeNOW&&(this.onDelete(this.shapeNOW,this.currentTab,!1,!1),this.shapeNOW=null)}break;case "clear":this.onDeleteAll(this.currentTab);this.shapeNOW=null;break;case "print":break;default:e._objectInit=!1,e._tempModel={classIn:a,type:b,path:l}}};k.shapeTweenUpdate=function(e,a){a.alpha=.5;createjs.Tween.get(owner.form,{override:!0}).to({x:a.x,
y:a.y,alpha:1},300,createjs.Ease.quadIn)};k.menuEventProxy=function(e){this.drawinit(this,e.param[0],e.param[1])};k.shapeStart=function(){if(null!=this.shapeNOW){console.log("...found shape in use..."+this.shapeNOW.id);if(!this.shapeNOW._commited)if("links"!=this.shapeNOW.type)this.shapeNOW.drawPerm(this.shapeNOW,!1);else this.onDelete(this.shapeNOW,this.currentTab,!1,!0);this.shapeNOW=null}console.log(this.shapeNOW);switch(this._tempModel.type){case "select":break;case "ungroup":break;case "links":console.log("links[IN]");
break;default:this._objectInit||(window.WBdraw.trace(" Form"+window.WBdraw.toTitleCase(this._tempModel.classIn)),f(this))}};k.drawing=function(e,a){if(0==this._objectInit&&(console.log("..drawing nwo"),void 0!=this.shapeNOW&&this.shapeNOW!=this.resizer.formTarget)){var b=this.shapeNOW.bg.globalToLocal(e,a);this.shapeNOW.drawTemp(b.x,b.y)}};k.drawdone=function(e){window.WBdraw.trace("...done nwo",k);void 0!=e.shapeNOW&&(e.shapeNOW.drawPerm(e.shapeNOW,!1),"text"==e.shapeNOW.type&&(void 0==e.resizer.parent&&
e.addChild(this.resizer),e.resizer.wrapTarget(e.resizer,e.shapeNOW),e.test_draw("line","free")));e.shapeNOW=null};k.clearObject=function(){this.shapeNOW=null};k.setup=function(){var e=new createjs.Shape;e.alpha=1;e.name=e.id="bg";var a=new WBdraw.Box("cvsDECK","#ccc",!0),b=new WBdraw.Box("cvsMAIN","#ccc",!0),l=new WBdraw.Box("cvsSAND","#ccc",!0);this.layers[a.id]=a;this.layers[b.id]=b;this.layers[l.id]=l;window.WBdraw.trace("8=====1====o");this.resizer=new WBdraw.FormResize("rsize","rtool");this.resizer.x=
200;this.resizer.y=20;this.addChild(e,a,b,l);this.menu=new WBdraw.Menu("m1",this);this.menu.addEventListener("MenuEvent",this.menuEventProxy.bind(this));this.addChild(this.menu);this.on("click",this.handleClick.bind(this));this.on("mousedown",this.handlePress.bind(this));this.on("pressup",this.handleRelease.bind(this));this.offset=10*Math.random();this.count=0;this.test_draw("line","free");this._pressMove=this.drawLine.bind(this)};k.width=0;k.height=0;k.setSize=function(e,a,b){var l=this.getChildByName("bg");
console.log("resizeBy");l.graphics.clear().beginStroke("#ccc").beginFill(b).drawRect(0,0,e,a);for(var c in this.layers)this.layers[c].setSize(e,a,b);k.width=e;k.height=a};k.getWidth=function(){console.log("get width");return width};k.wbRegister=function(e,a){};k.clear=function(e,a){};k.wbSwitch=function(e){};k.unshift=function(e){};k.push=function(e){};k.handleClick=function(e){window.WBdraw.trace("click1")};k.handlePress=function(e){console.log("pressing.33gfw...");this.shapeStart();this.on("pressmove",
this._pressMove);this.resizer.wrapTarget(this.resizer,null);e.stopImmediatePropagation()};k.handleRelease=function(e){this.drawdone(this);this.off("pressmove",this._pressMove)};k.drawLine=function(e){this.drawing(mainStage.mouseX,mainStage.mouseY)};k.endDraw=function(e){window.WBdraw.trace("enddraw1");this.off("pressmove",this._pressMove)};k.test_draw=function(e,a){window.WBdraw.trace("enddraw1");this.drawinit(this,e,a)};k.onDelete=function(e,a,b,l){window.WBdraw.trace("8=========o");console.log(e);
void 0==e?window.WBdraw.trace("<<<<<<<<<< undefined in DELETE >>>>>>>>>>"):(e=this.layers.cvsMAIN.getChildByName(e.name),b||this.updateShape(e,window.WBdraw.FormProxy.DELETE,a),null!=e&&null!=e.parent&&(console.log(e.parent),e.destroy(l),window.WBdraw.trace("<<<<===delete...====o"),e.commit(window.WBdraw.FormProxy.DELETE),e.removeAllEventListeners(),e.parent.removeChild(e),delete e),l||console.log("send to JMS server"),this.resizer.wrapTarget(this.resizer,null))};k.onDeleteAll=function(e){if(e==this.currentTab){window.WBdraw.trace("< [START] removeAll>");
console.log(this.allTabs);for(var a=this.allTabs[e].length;0<this.allTabs[e].length;)console.log(this.allTabs[e][a-1]),this.onDelete(this.allTabs[e][a-1],e,!0,!1),--a}window.WBdraw.trace("< [END] removeAll>");console.log(this.allTabs[e]);void 0!=this.allTabs[e]&&this.allTabs[e].splice(0)};k.updateShape=function(e,a,b){var l=!1;console.log("~~~~!-updateShape-!~~~~"+b);void 0==e&&(window.WBdraw.trace("<<<<<<<  [1] ???????????   >>>>>>>>>"+e),window.WBdraw.trace("<<<<<<<<<<      >>>>>>>>>>"),window.WBdraw.trace("<<<<<<<<<<      >>>>>>>>>>"),
window.WBdraw.trace("<<<<<<<<<< undefined in updateShape >>>>>>>>>>"));void 0==this.allTabs[b]&&(this.allTabs[b]=[]);var c=this.allTabs[b].length;console.log(this.allTabs);console.log(this.allTabs[b]);var f=new window.WBdraw.FormProxy;window.WBdraw.FormProxy.flattenForm(f,e);void 0==f&&(window.WBdraw.trace("     [2]   <<<<<<<   ???????????   >>>>>>>>>"+f),window.WBdraw.trace("        <<<<<<<<<<      >>>>>>>>>>"),window.WBdraw.trace("        <<<<<<<<<<      >>>>>>>>>>"),window.WBdraw.trace("        <<<<<<<<<< undefined in updateShape >>>>>>>>>>"));
for(e=0;e<c;++e)if(this.allTabs[b][e].name==f.name){a==window.WBdraw.FormProxy.DELETE?this.allTabs[b].splice(e,1):this.allTabs[b][e]=f;l=!0;break}l||a==window.WBdraw.FormProxy.DELETE?a==window.WBdraw.FormProxy.DELETE&&console.log("see if event already exists in undo/redo with SAME timeStamp"):this.allTabs[b].push(f)};k.uniqueLink=function(e,a){console.log("~~~~!-link check-!~~~~"+a);void 0==this.allTabs[a]&&(this.allTabs[a]=[]);for(var b=this.allTabs[a].length,l=e.related,c=null,f=null,g=0;g<b;++g)if("links"==
this.allTabs[a][g].type&&this.allTabs[a][g].id!=e.id){f=this.allTabs[a][g];c=f.related;if(l.to.id==f.id||l.from.id==f.id)if(l.from.id==c.to.id||l.from.id==c.from.id||l.to.id==c.to.id||l.to.id==c.from.id)return console.log("  @@!!@@!!@@found same And ITS A copy"),f;if(c.from.id==l.from.id||c.from.id==l.to.id)if(c.to.id==l.to.id||c.to.id==l.from.id)return b=this.allTabs[a][g],c.from.id!=l.from.id&&(f=this.layers.cvsMAIN.getChildByName(b.id),f.bidirection=b.bidirection=!0,f.moveLink(f,window.WBdraw.FormProxy.UPDATE)),
console.log("  @@!!@@!!@@f should it be bidirectionl?"),console.log(c.from.id),console.log(l.from.id),console.log(l.to.id),console.log("  @@!---------____________--------!!@@"),b}return!1};createjs.EventDispatcher.initialize(h.prototype);m.WBoard=createjs.promote(h,"Container")})(window.WBdraw);(function(m){function h(a,b,c){this.Container_constructor();this.id=this.name=a;this.transparent=c;this.color=b;this.setup()}var g=createjs.extend(h,createjs.Container);g.setup=function(){var a=new createjs.Shape;a.alpha=1;a.name=a.id="bg";this.on("click",this.handleClick);this.on("mousedown",this.handlePress);this.on("pressup",this.handleRelease);console.log("box1");this.offset=10*Math.random();this.count=0};g.width=0;g.height=0;g.setSize=function(a,b,c){g.width=a;g.height=b;if(!this.transparent){var f=
this.getChildByName("bg");console.log("resizerrrBy");f.graphics.clear().beginStroke("#ccc").beginFill(c).drawRect(0,0,a,b);this.cache(0,0,a,b)}};g.getWidth=function(){console.log("get width");return width};g.handleClick=function(a){console.log("click");a.stopImmediatePropagation()};g.handlePress=function(a){console.log(a);console.log("press")};g.handleRelease=function(a){console.log("release");a.stopImmediatePropagation()};g.drawLine=function(a){console.log("draw");a.stopImmediatePropagation()};g.endDraw=
function(a){console.log("enddraw");a.stopImmediatePropagation()};m.Box=createjs.promote(h,"Container")})(window.WBdraw);(function(m){function h(a,c){this.Container_constructor();this.id=this.name=a;this.color="";this.type=c;this.limitDraw=!1;this.rect=null;this.segSize=12;this.regY=this.regX=0;this.scaled=!1;this.tempOrigin=this.rel=null;this.lastXY={x:0,y:0};this.related=null;this._commited=this.biderectional=!1;this.rotary=this.elastic=!0;this.setup()}function g(a,c){0>c.x&&(c.x=Math.abs(c.x),a.x-=c.x);0>c.y&&(c.y=Math.abs(c.y),a.y-=c.y);return c}createjs.EventDispatcher.initialize(h.prototype);var a=createjs.extend(h,
createjs.Container);a.setup=function(){this.points=[];this.bg=new createjs.Shape;this.hitHelper=new createjs.Shape;this.bg.hitArea=this.hitHelper;this.addChild(this.bg);this.on("mousedown",this.handlePress.bind(this));this.on("pressup",this.handleRelease.bind(this));this.cursor="pointer";this.mouseChildren=!1;this.offset=10*Math.random();this.count=0;this.status=window.WBdraw.FormProxy.NEW};a.drawTemp=function(b,c){this._commited=!1;this.uncache();a[this.type](this,b,c)};a.drawPerm=function(b,c){if(b.id==
this.id){try{var f=a[this.type+"Perm"](this,b,c)}catch(g){throw"[E] No function matches:"+this.type+"Perm() in FormFill (wbFormFill.js)";}f&&this.commit(window.WBdraw.FormProxy.UPDATE)}};a.commit=function(a){this.dispatchEvent({type:"CommitEvent",param:this,action:a})};a.scaleState=function(a){this.scaled=a;this.scaleX=this.scaleY=1};a.setSize=function(a,c,f){};a.moveSTART=function(a){a.stopImmediatePropagation();a=a.target;var c;a=a.getObjectsUnderPoint(a.mouseX,a.mouseY,1);for(var f=0;f<a.length;f++)if(a[f].parent.scaled){c=
a[f].parent;break}null!=c&&console.log("@@@  start 9 @@@@")};a.moveEND=function(a){a=a.target;if(this.x!=this.lastXY.x||this.y!=this.lastXY.y){var c;a=a.getObjectsUnderPoint(a.mouseX,a.mouseY,1);for(var f=0;f<a.length;f++)if(a[f].parent.scaled){c=a[f].parent;break}null!=c&&(c.scaled=!1,createjs.Tween.get(c,{override:!0}).to({scaleX:1,scaleY:1},100,createjs.Ease.quadIn));this.commit(window.WBdraw.FormProxy.MOVED);this.lastXY.x=this.x;this.lastXY.y=this.y}};a.handlePress=function(a){var c={type:"PressEvent",
param:this};a.stopImmediatePropagation();this.dispatchEvent(c)};a.handleRelease=function(a){var c={type:"ReleaseEvent",param:this};a.stopImmediatePropagation();this.dispatchEvent(c)};a.handleRollOver=function(a){this.alpha="rollover"==a.type?.4:1};a.square=function(a,c,f){c=new createjs.Point(c,f);f=a.bg.graphics;f.clear();a.points=[];f.setStrokeStyle(5);f.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));f.beginFill("#"+Math.floor(16777215*Math.random()).toString(16));f.rect(0,0,c.x,
c.y);a.points.push(c);f.endStroke();f.endFill()};a.squarePerm=function(a,c,f){c=a.bg.graphics;f=a.bg.hitArea.graphics;c.clear();f.clear();if(0==a.points.length)return a.parent.removeChild(this),!1;olc=a.points[0];lc=g(a,olc);a.regX=0>lc.x?-Math.abs(.5*lc.x):Math.abs(.5*lc.x);a.x+=a.regX;a.regY=0>lc.y?-Math.abs(.5*lc.y):Math.abs(.5*lc.y);a.y+=a.regY;var k=Math.floor(lc.x),e=Math.floor(lc.y);a.width=Math.abs(k);a.height=Math.abs(e);if(10>a.width||10>a.height)return a.parent.removeChild(a),delete a,
!1;c.setStrokeStyle(5);c.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));c.beginFill("#"+Math.floor(16777215*Math.random()).toString(16));f.setStrokeStyle(10);f.beginStroke("#000");f.beginFill("red");f.rect(0,0,k,e);c.rect(0,0,k,e);c.endStroke();f.endStroke();f.endFill();c.endFill();a.cache(-5+(0>k?k:0),-5+(0>e?e:0),a.width+10,a.height+10);return!0};a.circle=function(a,c,f){c=new createjs.Point(c,f);f=a.bg.graphics;f.clear();a.points=[];f.setStrokeStyle(5);f.beginStroke("#"+Math.floor(16777215*
Math.random()).toString(16));f.beginFill("#"+Math.floor(16777215*Math.random()).toString(16));f.drawEllipse(0,0,c.x,c.y);a.points.push(c);f.endStroke();f.endFill()};a.circlePerm=function(a,c,f){c=a.bg.graphics;f=a.bg.hitArea.graphics;c.clear();f.clear();if(0==a.points.length)return a.parent.removeChild(this),!1;olc=a.points[0];lc=g(a,olc);a.regX=0>lc.x?-Math.abs(.5*lc.x):Math.abs(.5*lc.x);a.x+=a.regX;a.regY=0>lc.y?-Math.abs(.5*lc.y):Math.abs(.5*lc.y);a.y+=a.regY;var k=Math.floor(lc.x),e=Math.floor(lc.y);
a.width=Math.abs(k);a.height=Math.abs(e);if(10>a.width||10>a.height)return a.parent.removeChild(a),delete a,!1;c.setStrokeStyle(5);c.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));c.beginFill("#"+Math.floor(16777215*Math.random()).toString(16));f.setStrokeStyle(10);f.beginStroke("#000");f.beginFill("red");f.drawEllipse(0,0,k,e);c.drawEllipse(0,0,k,e);c.endStroke();f.endStroke();f.endFill();c.endFill();a.cache(-5+(0>k?k:0),-5+(0>e?e:0),a.width+10,a.height+10);return!0};a.star=function(a,
c,f){new createjs.Point(c,f);var g={},e=a.bg.graphics;e.clear();a.points=[];e.setStrokeStyle(5);e.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));e.beginFill("#"+Math.floor(16777215*Math.random()).toString(16));console.log("---=-=-=--=-=-=-=-=>>>>");g.radius=c/mainStage.canvas.width*200;g.pointy=f/mainStage.canvas.height*.9;g.points=5;e.drawPolyStar(0,0,g.radius,g.points,g.pointy,-90);a.points.push(g);e.endStroke();e.endFill()};a.starPerm=function(a,c,f){c=a.bg.graphics;f=a.bg.hitArea.graphics;
c.clear();f.clear();if(0==a.points.length)return c=a.parent,console.log(c.getNumChildren()),a.parent.removeChild(this),console.log(c.getNumChildren()),!1;sPos=a.points[0];a.width=Math.abs(Math.floor(2*sPos.radius));a.height=Math.abs(Math.floor(2*sPos.radius));c.setStrokeStyle(5);c.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));c.beginFill("#"+Math.floor(16777215*Math.random()).toString(16));f.setStrokeStyle(10);f.beginStroke("#000");f.beginFill("red");f.drawPolyStar(0,0,sPos.radius,
sPos.points,sPos.pointy,-90);c.drawPolyStar(0,0,sPos.radius,sPos.points,sPos.pointy,-90);a.x-=sPos.radius;a.y-=sPos.radius;this.x+=sPos.radius;this.y+=sPos.radius;c.endStroke();f.endStroke();f.endFill();c.endFill();return!0};a.destroy=function(a){this.uncache();this._commited=!1};m.FormFill=createjs.promote(h,"Container")})(window.WBdraw);(function(m){function h(a,b){this.Container_constructor();this.id=this.name=a;this.color="";this.type=b;this.limitDraw=!1;this.rect=null;this.segSize=12;this.regY=this.regX=0;this.scaled=!1;this.rel=null;this.lastXY={x:0,y:0};this._commited=!1;this.related=this._listenEnd=this._listenMove=null;this.bidirection=!1;this.rotary=this.elastic=!0;this.setup()}function g(a,b,n){a=a.graphics;a.clear();a.setStrokeStyle(5);a.beginStroke(n);a.beginFill(n);a.moveTo(-b,b);a.lineTo(0,0);a.lineTo(-b,-b);a.endStroke();
a.endFill()}function a(a,b,n){a=a.graphics;a.clear();var l=.5*-b;a.setStrokeStyle(5);a.beginStroke(n);a.beginFill(n);a.drawEllipse(l,l,b,b);a.endStroke();a.endFill()}function b(a,b,n){var l=window.WBdraw.rotateAngle(b,n);console.log(l);a.arrow.rotation=l;a.ball.rotation=180+l;a.ball.x=0;a.ball.y=0;a.arrow.x=n.x-b.x;a.arrow.y=n.y-b.y}function c(a){console.log(a);this.moveLink(this,window.WBdraw.FormProxy.UPDATE)}function f(a){a.action==window.WBdraw.FormProxy.DELETE?(this._commited=!1,this.commit(a.action),
this.parent&&this.parent.removeChild(this),this.destroy(!1)):this.moveLink(this,window.WBdraw.FormProxy.UPDATE);console.log(a)}createjs.EventDispatcher.initialize(h.prototype);var k=createjs.extend(h,createjs.Container);k.setup=function(){this.points=[];this.bg=new createjs.Shape;this.hitHelper=new createjs.Shape;this.bg.hitArea=this.hitHelper;this.addChild(this.bg);this.on("mousedown",this.handlePress.bind(this));this.on("pressup",this.handleRelease.bind(this));this.cursor="pointer";this.mouseChildren=
!1;this.offset=10*Math.random();this.count=0;"links"==this.type&&(this.elastic=this.rotary=!1,this.arrow=new createjs.Shape,this.ball=new createjs.Shape,g(this.arrow,20,"#000000"),a(this.ball,20,"#000000"),this.addChild(this.arrow,this.ball));this.status=window.WBdraw.FormProxy.NEW};k.drawTemp=function(a,b){this._commited=!1;k[this.type](this,a,b)};k.linked=function(){console.log(this.related);return null!=this.related?null!=this.related.from:!1};k.link=function(a){var b={from:null,to:null};if(null!=
this.related){b=this.related;if(b.from==a)return console.log("[E]  --\x3eSAME shape AS to"),!1;if(null!=b.to&&null!=b.from)return!0;b.to=a;console.log(b);a=b.to;var n=b.from;this._listenMove=c.bind(this);this._listenEnd=f.bind(this);a.addEventListener("MoveEvent",this._listenMove);n.addEventListener("MoveEvent",this._listenMove);a.addEventListener("CommitEvent",this._listenEnd);n.addEventListener("CommitEvent",this._listenEnd);(finalIn=this.linksPerm(this,b.to,b.from,this.bidirection))&&this.commit(window.WBdraw.FormProxy.UPDATE);
return!0}b.from=a;this.related=b;return!1};k.moveLink=function(a,b){var n=a.related.to,l=a.related.from;a.x=l.x;a.y=l.y;a.points=[];a.points.push(new createjs.Point(n.x-l.x,n.y-l.y));a.linksPerm(a,!1);null!=b&&a.commit(b)};k.drawPerm=function(a,b){if(a.id==this.id){try{var n=k[this.type+"Perm"](this,a,b)}catch(l){throw console.log(l),"[E] No function matches:"+this.type+"Perm() in FormLine (wbFormLine.js)";}n&&this.commit(window.WBdraw.FormProxy.UPDATE)}};k.commit=function(a){this.dispatchEvent({type:"CommitEvent",
param:this,action:a})};k.width=0;k.height=0;k.scaleState=function(a){this.scaled=a;this.scaleX=this.scaleY=1};k.setSize=function(a,b,n){};k.getWidth=function(){return width};k.moveSTART=function(a){a.stopImmediatePropagation();a=a.target;for(var b,n=a.getObjectsUnderPoint(a.mouseX,a.mouseY,1),l=0;l<n.length;l++)if(n[l].parent.scaled){b=n[l].parent;break}null!=b&&(b.x=a.mouseX-b.rel.x+b.regX,b.y=a.mouseY-b.rel.y+b.regY)};k.moveEND=function(a){a=a.target;if(this.x!=this.lastXY.x||this.y!=this.lastXY.y){var b;
a=a.getObjectsUnderPoint(a.mouseX,a.mouseY,1);for(var n=0;n<a.length;n++)if(a[n].parent.scaled){b=a[n].parent;break}null!=b&&(b.scaled=!1,createjs.Tween.get(b,{override:!0}).to({scaleX:1,scaleY:1},100,createjs.Ease.quadIn));this.commit(window.WBdraw.FormProxy.MOVED);this.lastXY.x=this.x;this.lastXY.y=this.y}};k.handlePress=function(a){var b={type:"PressEvent",param:this};a.stopImmediatePropagation();this.dispatchEvent(b)};k.handleRelease=function(a){var b={type:"ReleaseEvent",param:this};a.stopImmediatePropagation();
this.dispatchEvent(b)};k.handleRollOver=function(a){this.alpha="rollover"==a.type?.4:1};k.straight=function(a,b,n){b=new createjs.Point(b,n);n=a.bg.graphics;n.clear();a.points=[];n.setStrokeStyle(5);d=Math.sqrt(b.x*b.x+b.y*b.y);r=d%a.segSize;tot=d/a.segSize;for(var l=0,c=0,f=0;f<tot;++f){var g=f/tot*b.x,k=f/tot*b.y;n.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));n.moveTo(l,c);n.lineTo(g,k);l=g;c=k}n.moveTo(l,c);n.lineTo(b.x,b.y);a.points.push(b);n.endStroke()};k.straightPerm=function(a,
b,c){b=a.bg.graphics;c=a.bg.hitArea.graphics;b.clear();c.clear();if(0==a.points.length)return a.parent.removeChild(this),!1;lc=a.points[0];a.regX=0>lc.x?-Math.abs(.5*lc.x):Math.abs(.5*lc.x);a.x+=a.regX;a.regY=0>lc.y?-Math.abs(.5*lc.y):Math.abs(.5*lc.y);a.y+=a.regY;b.setStrokeStyle(5);a.color="#"+Math.floor(16777215*Math.random()).toString(16);b.beginStroke(a.color);c.setStrokeStyle(10);c.beginStroke("#000");c.beginFill("red");c.moveTo(0,0);b.moveTo(0,0);b.lineTo(lc.x,lc.y);c.lineTo(lc.x,lc.y);b.endStroke();
c.endStroke();c.endFill();a.setDimension(a,lc.x,lc.y);return!0};k.free=function(a,b,c){var l=a.bg.graphics,f=a.points[a.points.length-1],g=0;b=new createjs.Point(b,c);l.setStrokeStyle(5);l.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));void 0==f&&(f=new createjs.Point(0,0));g=b.y;c=f.x;var k=f.y,g=Math.sqrt((c-=b.x)*c+(k-=g)*k);g>a.segSize&&(l.moveTo(f.x,f.y),l.lineTo(b.x,b.y),l.endStroke(),a.points.push(b))};k.freePerm=function(a,b,c){b=a.bg.graphics;c=a.bg.hitArea.graphics;var l=
a.points.length;if(0==l)return a.parent.removeChild(this),!1;new createjs.Point(0,0);b.clear();b.setStrokeStyle(5);b.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));c.setStrokeStyle(10);c.beginStroke("#000");c.beginFill("red");for(var f=0,g=0,k=0,h=0,t=0,u=0,m=0;m<l;++m){var q=a.points[m];q.x>g&&(g=q.x);q.y>f&&(f=q.y);q.x<k&&(k=q.x);q.y<h&&(h=q.y)}0>k&&(t=k);0>h&&(u=h);for(m=0;m<l;++m)a.points[m].x+=Math.abs(t),a.points[m].y+=Math.abs(u),q=a.points[m],0==m&&(c.moveTo(q.x,q.y),b.moveTo(q.x,
q.y)),b.lineTo(q.x,q.y),c.lineTo(q.x,q.y);b.endStroke();c.endStroke();c.endFill();a.x+=t;a.y+=u;a.rect=new createjs.Rectangle(0,0,Math.abs(t)+g,Math.abs(u)+f);b=.5*a.rect.width;c=.5*a.rect.height;a.x-=b;a.y-=c;a.regX=b;a.x+=2*b;a.regY=c;a.y+=2*c;a.setDimension(a,a.rect.width,a.rect.height);return!0};k.bezier=function(a,b,c){var l={x:0,y:0},f=a.bg.graphics;c=new createjs.Point(b,c);f.clear();a.points=[];f.setStrokeStyle(5);b=Math.round(c.x);c=Math.round(c.y);l.fx=b;l.cx=l.fx;l.fy=c;l.cy=l.y;f.setStrokeStyle(1);
f.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));f.moveTo(l.fx,l.fy);f.lineTo(l.cx,l.cy);f.lineTo(l.x,l.y);f.setStrokeStyle(5);f.bezierCurveTo(l.fx,l.fy,l.cx,l.cy,l.x,l.y);a.points.push(l);f.endStroke()};k.bezierPerm=function(a,b,c){var l=a.points.length;b=a.bg.graphics;c=a.bg.hitArea.graphics;b.clear();c.clear();if(0==l)return b=a.parent,console.log(b.getNumChildren()),a.parent.removeChild(this),console.log(b.getNumChildren()),!1;l=a.points[0];c.setStrokeStyle(25);c.beginStroke("#000");
b.setStrokeStyle(5);b.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));b.bezierCurveTo(l.fx,l.fy,l.cx,l.cy,l.x,l.y);c.bezierCurveTo(l.fx,l.fy,l.cx,l.cy,l.x,l.y);b.endStroke();c.endStroke();a.setDimension(a,l.cx,l.fy);return!0};k.links=function(a,c,f){c=new createjs.Point(c,f);f=a.bg.graphics;f.clear();console.log("     >>> >> >     connector connecting");a.points=[];f.setStrokeStyle(5);d=Math.sqrt(c.x*c.x+c.y*c.y);r=d%a.segSize;var l=0,g=0,k=10*(0<c.x?-1:1),h=10*(0<c.y?-1:1);tot=d/
a.segSize;for(var m=0;m<tot;++m){var t=m/tot*c.x+k,u=m/tot*c.y+h;f.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));f.moveTo(l,g);f.lineTo(t,u);l=t;g=u}f.moveTo(l+k,g+h);f.lineTo(c.x+k,c.y+h);a.points.push(c);f.endStroke();b(a,{x:0,y:0},{x:c.x+k,y:c.y+h})};k.linksPerm=function(e,c){var f,l,k=e.related.to,h=e.related.from;e.points=[];b(e,h,k);e.points.push({x:e.arrow.x,y:e.arrow.y});e.straightPerm(e,e,!1);for(var z=k.x-h.x,m=k.y-h.y,t=Math.abs(0-z),u=Math.abs(0-m),z=z-0,m=m-0,t=Math.sqrt(Math.pow(t,
2)+Math.pow(u,2))/6,u=z/t,z=m/t,w=m=0,q=[],A=0;A<t;A++)m=0+u*A,w=0+z*A,q.push({x:Math.round(m),y:Math.round(w)});e.related.a=q;z=e.related.a?e.related.a:[];0<z.length&&(f=.5*z[z.length-1].x,l=.5*z[z.length-1].y);t={x:0,y:0,d:1E7};u={x:0,y:0,d:1E7};for(m=0;m<z.length;++m){var w=z[m].x,q=z[m].y,v=e.bg.localToLocal(w,q,k.bg),A=e.bg.localToLocal(w,q,h.bg);k.bg.hitTest(v.x,v.y)&&(v=Math.sqrt((f-w)*(f-w)+(l-q)*(l-q)),v<t.d&&(t.x=w,t.y=q,t.d=v));h.bg.hitTest(A.x,A.y)&&(A=Math.sqrt((f-w)*(f-w)+(l-q)*(l-q)),
A<u.d&&(u.x=w,u.y=q,u.d=A))}e.bg.localToLocal(t.x,t.y,e.parent);f=e.bg.localToLocal(u.x,u.y,e.parent);b(e,u,t);e.points=[];e.points.push({x:e.arrow.x,y:e.arrow.y});e.x=f.x;e.y=f.y;e.straightPerm(e,e,!1);g(e.arrow,20,e.color);e.bidirection?g(e.ball,20,e.color):a(e.ball,20,e.color);return!0};k.setDimension=function(a,b,c){a.width=Math.abs(b);a.height=Math.abs(c);console.log(a.width+"x"+a.height)};k.destroy=function(a){this.uncache();this._commited=!1;if("links"==this.type){a=this.related.to;var b=this.related.from;
a&&(a.removeEventListener("MoveEvent",this._listenMove),a.removeEventListener("CommitEvent",this._listenEnd));b.removeEventListener("MoveEvent",this._listenMove);b.removeEventListener("CommitEvent",this._listenEnd)}console.log(" delete link in FormLine................................")};m.FormLine=createjs.promote(h,"Container")})(window.WBdraw);(function(m){function h(a,b){console.log("hellow NO dude");this.segSize=3;this.id=this.name=null;this.color=g;this.type=null;this.status=g;this.pod=this.tab=null;this.y=this.x=0;this.related=this.points=this.type=g;this.biderectional=!1}var g="";h.NEW=1;h.UPDATE=2;h.DELETE=3;h.CLEAR=4;h.ORDER=5;h.STATISTIC=6;h.DELETE_SELECTABLE_AREA=7;h.MOVED=2;h.setup=function(){};h.flattenForm=function(a,b){a.id=a.name=b.name;a.x=b.x;a.y=b.y;a.status=b.status;a.type=b.type;a.points=b.points;a.related=b.related;
a.biderectional=b.biderectional;a.arrow=b.arrow;a.ball=b.ball;a.tab=b.tab;a.pod=b.pod;return a};m.FormProxy=h})(window.WBdraw);(function(m){function h(a,b){this.Container_constructor();this.id=this.name=a;this.color="";this.type=b;this.limitDraw=!1;this.rect=null;this.segSize=12;this.tolerance=10;this.regY=this.regX=0;this.scaled=!1;this.TXT=this.boxr=this.box4=this.box3=this.box2=this.box1=this.formTargetLAST=this.formTarget=this.rel=null;this.setup();console.log("@@@@@@  NEW FormResize  ")}function g(a,e){null!==this.TXT&&(this.TXT.visible=!1);if(-1!=e.indexOf("r"))a.on("pressmove",b.bind(this));else a.on("pressmove",c.bind(this));
return""}function a(a,b){a.off("pressmove");console.log("bx1------------\x3e>>>>>>>>>>> stop"+this.formTarget.type);this.formTarget.globalToLocal(2*this.box4.x,2*this.box4.y);this.rotation=this.formTarget.rotation;switch(this.formTarget.type){case "bezier":break;case "free":break;default:this.formTarget.x=this.x-this.box4.x+this.tolerance,this.formTarget.y=this.y-this.box4.y+this.tolerance,this.formTarget.drawTemp(2*this.box4.x-2*this.tolerance,2*this.box4.y-2*this.tolerance),this.formTarget.drawPerm(this.formTarget)}null!==
this.TXT&&(this.TXT.visible=!0,f(this,this.formTarget));this.formTarget.commit("resize");return""}function b(a){a=this.globalToLocal(a.stageX,a.stageY);var b=0-Math.sqrt(Math.abs(a.x-0)*Math.abs(a.x-0)+Math.abs(a.y-0)*Math.abs(a.y-0));a=360*Math.atan2(a.y-b,a.x-0)/Math.PI;this.formTarget.rotation=a+this.rotation}function c(a){var b=a.currentTarget,c=this.globalToLocal(a.stageX,a.stageY),f=0,g=0,f=b.x,g=b.y;b.x=c.x;b.y=c.y;nX=Math.abs(c.x);nY=Math.abs(c.y);var c=Math.ceil(.5*nX),h=Math.ceil(.5*nY),
n=!1,p=this.box1.globalToLocal(a.stageX,a.stageY),m=this.box2.globalToLocal(a.stageX,a.stageY),A=this.box3.globalToLocal(a.stageX,a.stageY);a=this.box4.globalToLocal(a.stageX,a.stageY);if(10>c||10>h)n=!0;this.box1.hitTest(p.x,p.y)&&"bx1"!=b.name?n=!0:this.box2.hitTest(m.x,m.y)&&"bx2"!=b.name?n=!0:this.box3.hitTest(A.x,A.y)&&"bx3"!=b.name?n=!0:this.box4.hitTest(a.x,a.y)&&"bx4"!=b.name&&(n=!0);n?(b.x=f,b.y=g):(k(this,2*c,2*h,b),e(this,Math.ceil(nX),Math.ceil(nY)))}function f(a,b){var e=window.WBdraw.getCanvasDiv("editTxt");
window.WBdraw.getCanvasDiv("txt2edit").style.width="inherit";e.style.width=b.width+"px";var e=Math.ceil(.5*b.width)+a.tolerance,c=Math.ceil(.5*b.height)+a.tolerance;a.TXT.x=-e+5;a.TXT.y=-c+5}function k(a,b,e,c){"bx4"!=c.name&&(a.box4.x=b,a.box4.y=e);"bx3"!=c.name&&(a.box3.x=0-b,a.box3.y=e);"bx2"!=c.name&&(a.box2.x=b,a.box2.y=0-e);"bx1"!=c.name&&(a.box1.x=0-b,a.box1.y=0-e);a.boxr.x=0;a.boxr.y=-60-e}function e(a,b,e){var c=a.bg.graphics;c.clear();c.beginStroke("red");c.setStrokeStyle(2);var f=new createjs.Point(-b,
-e),g=new createjs.Point(0,0),k=new createjs.Point(b,-e),n=new createjs.Point(b,e),h=new createjs.Point(-b,e);b=new createjs.Point(b,e);e=new createjs.Point(0,-60-e);p(c,f,k,!1);p(c,f,h,!0);p(c,h,n,!1);p(c,k,b,!0);a.boxr.visible&&p(c,e,g,!0)}function p(a,b,e,c){dx1=b.x;var f=dx2=e.x;dy1=b.y;e=dy2=e.y;d=Math.sqrt((dx2-=dx1)*dx2+(dy2-=dy1)*dy2);tot=d/12;var g=b.x;b=b.y;for(var k=d/tot,h=0;h<=tot;++h){if(c){var n=Math.ceil(b+k),p=f;b=n<b?b-2:b+2;if(n>Math.abs(e))break}else{var p=Math.ceil(g+k),n=e,g=
p<g?g-2:g+2;if(Math.abs(p)>Math.abs(f))break}a.moveTo(g,b);a.lineTo(p,n);g=p;b=n}}createjs.EventDispatcher.initialize(h.prototype);var n=createjs.extend(h,createjs.Container);n.setup=function(){this.points=[];this.bg=new createjs.Shape;this.box1=new WBdraw.resizeBtn("bx1","#FFF",g.bind(this),a.bind(this));this.box2=new WBdraw.resizeBtn("bx2","#FFF",g.bind(this),a.bind(this));this.box3=new WBdraw.resizeBtn("bx3","#FFF",g.bind(this),a.bind(this));this.box4=new WBdraw.resizeBtn("bx4","#FFF",g.bind(this),
a.bind(this));this.boxr=new WBdraw.resizeBtn("bxr","#FFF",g.bind(this),a.bind(this));var b=window.WBdraw.getCanvasDiv("editTxt");b.style.display="none";b.innerHTML='<textarea name="txt2edit" id="txt2edit" cols="" rows="" style="width:inherit" readOnly>dfasf</textarea>';var e=window.WBdraw.getCanvasDiv("txt2edit"),c=this;e.onclick=function(a){e.readOnly=!1};e.onblur=function(a){null!=c.formTargetLAST&&(c.formTargetLAST.setText(e.value),c.formTargetLAST.commit("text"));c.formTargetLAST=null};this.TXT=
new createjs.DOMElement(b);this.addChild(this.bg,this.box1,this.box2,this.box3,this.box4,this.boxr,this.TXT)};n.width=0;n.height=0;n.handleRollOver=function(a){this.alpha="rollover"==a.type?.4:1};n.wrapTarget=function(a,b){var c=window.WBdraw.getCanvasDiv("editTxt"),g=window.WBdraw.getCanvasDiv("txt2edit");if(null==b)g.blur(),null!=a.formTarget&&(a.formTarget.scaleState(!1),a.formTargetLAST=a.formTarget),a.formTarget=null,a.parent&&a.parent.removeChild(this),c.style.display="none";else{this.rotation=
b.rotation;var n="text"==b.type;n&&g.blur();a.formTargetLAST=a.formTarget;a.formTarget=b;a.x=b.x;a.y=b.y;var h=Math.ceil(.5*b.width)+a.tolerance,p=Math.ceil(.5*b.height)+a.tolerance;a.box4.visible=a.box3.visible=a.box2.visible=a.box1.visible=b.elastic;a.boxr.visible=b.rotary;f(a,b);k(a,h,p,"");e(a,h,p);null!=a.formTarget&&(n?(a.formTargetLAST=a.formTarget,""!=a.formTarget.text.text&&(c.style.display="block",g.focus(),g.value=a.formTarget.text.text,"enter text here"==g.value&&g.select())):c.style.display=
"none")}};m.FormResize=createjs.promote(h,"Container")})(window.WBdraw);(function(m){function h(a,b,c,f){this.Container_constructor();this.id=this.name=a;this.color=f;this.type=c;this.label=b;this.setup();this._commited=!1}var g=createjs.extend(h,createjs.Container);g.setup=function(){var a=new createjs.Text(this.label,"20px Arial","#000");a.name=a.id="txt";a.textBaseline="top";a.textAlign="center";var b=a.getMeasuredWidth()+30,c=a.getMeasuredHeight()+20;a.x=b/2;a.y=10;var f=new createjs.Shape;f.name=f.id="bg";f.graphics.setStrokeStyle(5);f.graphics.beginStroke("#"+Math.floor(16777215*
Math.random()).toString(16));f.graphics.beginFill(this.color).drawRoundRect(0,0,b,c,10);this.addChild(f,a);this.on("click",this.handleClick);this.on("rollover",this.handleRollOver);this.on("rollout",this.handleRollOver);this.on("mousedown",this.handlePress);this.on("pressup",this.handleRelease);this.cursor="pointer";this.mouseChildren=!1;this.offset=10*Math.random();this.count=0};g.handleClick=function(a){};g.hello=function(a){console.log(a);g.width=100};g.width=0;g.height=0;g.setSize=function(a,
b,c){target.getChildByName("bg").graphics.clear().beginStroke("#ccc").beginFill("#"+Math.floor(16777215*Math.random())).drawRect(0,0,a,b);g.width=a;g.height=b};g.getWidth=function(){return width};g.handlePress=function(a){mainStage.addEventListener("stagemousemove",this.drawLine);mainStage.addEventListener("stagemouseup",this.endDraw);console.log(this.id);this.scaled||(createjs.Tween.get(this,{override:!0}).to({scaleX:1.1,scaleY:1.1},100,createjs.Ease.quadIn),this.scaled=!0,this.rel=this.globalToLocal(mainStage.mouseX,
mainStage.mouseY))};g.handleRelease=function(a){mainStage.removeEventListener("stagemousemove",this.drawLine);mainStage.removeEventListener("stagemouseup",this.endDraw);this.dispatchEvent({type:"SelectEvent",param:this})};g.drawLine=function(a){a=a.target;for(var b,c=a.getObjectsUnderPoint(a.mouseX,a.mouseY,1),f=0;f<c.length;f++)if(c[f].parent.scaled){b=c[f].parent;break}null!=b&&(b.x=a.mouseX-b.rel.x,b.y=a.mouseY-b.rel.y,b.getChildByName("bg").graphics.clear().beginStroke("#"+Math.floor(16777215*
Math.random())).beginFill("#"+Math.floor(16777215*Math.random())).drawRect(0,0,a.mouseX,a.mouseY))};g.endDraw=function(a){a=a.target;var b;a=a.getObjectsUnderPoint(a.mouseX,a.mouseY,1);for(var c=0;c<a.length;c++)if(a[c].parent.scaled){b=a[c].parent;break}console.log(b.scaled);null!=b&&(b.scaled=!1,createjs.Tween.get(b,{override:!0}).to({scaleX:1,scaleY:1},100,createjs.Ease.quadIn))};g.handleRollOver=function(a){this.alpha="rollover"==a.type?.4:1};m.FormShape=createjs.promote(h,"Container")})(window.WBdraw);(function(m){function h(a,b){this.Container_constructor();this.id=this.name=a;this.color="000";this.type=b;this.limitDraw=!1;this.rect=null;this.segSize=12;this.regY=this.regX=0;this.scaled=!1;this.tempOrigin=this.text=this.rel=null;this.lastXY={x:0,y:0};this.points=[];this.related=null;this.biderectional=!1;this.label="enter text here";this.rotary=this.elastic=!0;this.setup()}createjs.EventDispatcher.initialize(h.prototype);var g=createjs.extend(h,createjs.Container);g.setup=function(){this.bg=new createjs.Shape;
this.hitHelper=new createjs.Shape;this.text=new createjs.Text(this.label,"20px Arial","#000");this.text.hitArea=this.hitHelper;this.addChild(this.bg,this.text);this.on("mousedown",this.handlePress.bind(this));this.on("pressup",this.handleRelease.bind(this));this.cursor="pointer";this.mouseChildren=!1;this.offset=10*Math.random();this.count=0;this.text.name=this.text.id="txt";this.text.textBaseline="top";this.text.textAlign="left";this.text.wordWrap=!0;this.width=this.text.getMeasuredWidth()+30;this.height=
this.text.getMeasuredHeight()+20;this.points.push(new createjs.Point(this.text.getMeasuredWidth()+30,this.text.getMeasuredHeight()+20));this.squarePerm(this);this.status=window.WBdraw.FormProxy.NEW};g.setText=function(a){this.text.text=a;this.updateCache()};g.drawTemp=function(a,b){this.uncache();this.bg.alpha=1;this.square(this,a,b)};g.drawPerm=function(a,b){if(a.id==this.id){try{var c=this.squarePerm(this,a,b)}catch(f){throw console.log(f),"[E] No function matches:"+this.type+"Perm() in FormText (wbFormText.js)";
}console.log("...create....");c&&this.commit(window.WBdraw.FormProxy.UPDATE)}};g.commit=function(a){this.dispatchEvent({type:"CommitEvent",param:this,action:a})};g.width=0;g.height=0;g.scaleState=function(a){this.scaled=a;this.scaleX=this.scaleY=1};g.setSize=function(a,b,c){};g.getWidth=function(){return width};g.moveSTART=function(a){a.stopImmediatePropagation();for(var b=a.target,c,b=b.getObjectsUnderPoint(b.mouseX,b.mouseY,1),f=0;f<b.length;f++)if(b[f].parent.scaled){c=b[f].parent;break}null!=
c&&(console.log(c.rel+","+c.regX),console.log(a),console.log("@@@  start 9 @@@@"))};g.moveEND=function(a){a=a.target;if(this.x!=this.lastXY.x||this.y!=this.lastXY.y){var b;a=a.getObjectsUnderPoint(a.mouseX,a.mouseY,1);for(var c=0;c<a.length;c++)if(a[c].parent.scaled){b=a[c].parent;break}null!=b&&(b.scaled=!1,createjs.Tween.get(b,{override:!0}).to({scaleX:1,scaleY:1},100,createjs.Ease.quadIn));console.log("...moved....");this.commit(window.WBdraw.FormProxy.MOVED);this.lastXY.x=this.x;this.lastXY.y=
this.y}};g.handlePress=function(a){console.log("...handlePress....");var b={type:"PressEvent",param:this};a.stopImmediatePropagation();this.dispatchEvent(b)};g.handleRelease=function(a){var b={type:"ReleaseEvent",param:this};a.stopImmediatePropagation();this.dispatchEvent(b)};g.handleRollOver=function(a){this.alpha="rollover"==a.type?.4:1};g.square=function(a,b,c){b=new createjs.Point(b,c);c=a.bg.graphics;c.clear();a.points=[];c.setStrokeStyle(5);c.beginStroke("#000");c.beginFill("#FFF");c.rect(0,
0,b.x,b.y);a.points.push(b);c.endStroke();c.endFill()};g.squarePerm=function(a,b,c){b=a.bg.graphics;c=a.text.hitArea.graphics;b.clear();c.clear();if(0==a.points.length)return b=a.parent,console.log(b.getNumChildren()),a.parent.removeChild(this),console.log(b.getNumChildren()),!1;var f=olc=a.points[0];0>f.x&&(f.x=Math.abs(f.x),a.x-=f.x);0>f.y&&(f.y=Math.abs(f.y),a.y-=f.y);lc=f;a.regX=0>lc.x?-Math.abs(.5*lc.x):Math.abs(.5*lc.x);a.x+=a.regX;a.regY=0>lc.y?-Math.abs(.5*lc.y):Math.abs(.5*lc.y);a.y+=a.regY;
var f=Math.floor(lc.x),g=Math.floor(lc.y);a.width=Math.abs(f);a.height=Math.abs(g);if(30>a.width||20>a.height)a.width<a.text.getMeasuredWidth()&&(a.width=a.text.getMeasuredWidth()+30),a.height<a.text.getMeasuredHeight()&&(a.height=a.text.getMeasuredHeight()+20);b.setStrokeStyle(5);b.beginStroke("#000");b.beginFill("#FFF");c.setStrokeStyle(10);c.beginStroke("#000");c.beginFill("red");c.rect(0,0,f,g);b.rect(0,0,f,g);b.endStroke();c.endStroke();c.endFill();b.endFill();a.text.x=a.text.y=5;a.text.lineWidth=
f;a.text.width=f;a.text.height=g;a.bg.visible=!1;a.cache(-5+(0>f?f:0),-5+(0>g?g:0),a.width+10,a.height+10);return!0};g.destroy=function(a){this.uncache();this._commited=!1};m.FormText=createjs.promote(h,"Container")})(window.WBdraw);(function(m){function h(a,b){this.Container_constructor();this.id=this.name=a;this.color=b;this.hi_Y=0;this.Controller=null;this.matrix=new createjs.Matrix2D;this.angle=Math.PI/12;this.currentMenu="";this.options={};this.subscriberWL={select:!0,line:!0,fill:!0,math:!0,media:!0,select:!1,print:!0,clear:!0,modify:!0,text:!0,undo:!0,redo:!0};this.hostWL={select:!0,line:!0,fill:!0,math:!0,media:!0,select:!0,print:!0,clear:!0,modify:!0,text:!0,undo:!0,redo:!0};this.options.BR=[{name:"select",btns:{icon:"ss.png",
hint:"select opject",action:"select"}},{name:"line",btns:{icon:"ss.png",hint:"line",">":[{name:"free",icon:"ss.png",action:"method1",hint:""},{name:"straight",icon:"ss.png",action:"method1",hint:""},{name:"bezier",icon:"ss.png",action:"method1",hint:""},{name:"links",icon:"ss.png",action:"method1",hint:""}]}},{name:"fill",btns:{icon:"ss.png",hint:"fill",">":[{name:"square",icon:"ss.png",action:"method1",hint:""},{name:"circle",icon:"ss.png",action:"method1",hint:""},{name:"star",icon:"ss.png",action:"method1",
hint:""}]}},{name:"math",btns:{icon:"ss.png",hint:"math",">":[{name:"sqrt",icon:"ss.png",action:"method1",hint:""},{name:"axis",icon:"ss.png",action:"method1",hint:""},{name:"graph",icon:"ss.png",action:"method1",hint:""}]}},{name:"media",btns:{icon:"ss.png",hint:"media",">":[{name:"ppt",icon:"ss.png",action:"method1",hint:""},{name:"video",icon:"ss.png",action:"method1",hint:""}]}},{name:"select_area",btns:{icon:"ss.png",hint:"selectable area",">":[{name:"add",icon:"ss.png",action:"method1",hint:""},
{name:"remove",icon:"ss.png",action:"method1",hint:""}]}},{name:"text",btns:{icon:"ss.png",hint:"text area",action:"method1"}},{name:"print",btns:{icon:"ss.png",hint:"selectable area",action:"print"}},{name:"clear",btns:{icon:"ss.png",hint:"selectable area",action:"method1"}},{name:"modify",btns:{icon:"ss.png",hint:"modify",">":[{name:"delete",icon:"ss.png",action:"method1",hint:""},{name:"color",icon:"ss.png",action:"method1",hint:""},{name:"alpha",icon:"ss.png",action:"method1",hint:""},{name:"undo",
icon:"ss.png",action:"method1",hint:""},{name:"redu",icon:"ss.png",action:"method1",hint:""}]}}];this.options.EN=[{name:"select",btns:{icon:"ss.png",hint:"select opject",action:"select"}},{name:"line",btns:{icon:"ss.png",hint:"line",">":[{name:"free",icon:"ss.png",action:"method1",hint:""},{name:"straight",icon:"ss.png",action:"method1",hint:""},{name:"bezier",icon:"ss.png",action:"method1",hint:""},{name:"links",icon:"ss.png",action:"method1",hint:""}]}},{name:"fill",btns:{icon:"ss.png",hint:"fill",
">":[{name:"square",icon:"ss.png",action:"method1",hint:""},{name:"circle",icon:"ss.png",action:"method1",hint:""},{name:"star",icon:"ss.png",action:"method1",hint:""}]}},{name:"math",btns:{icon:"ss.png",hint:"math",">":[{name:"sqrt",icon:"ss.png",action:"method1",hint:""},{name:"axis",icon:"ss.png",action:"method1",hint:""},{name:"graph",icon:"ss.png",action:"method1",hint:""}]}},{name:"media",btns:{icon:"ss.png",hint:"media",">":[{name:"ppt",icon:"ss.png",action:"method1",hint:""},{name:"video",
icon:"ss.png",action:"method1",hint:""}]}},{name:"select_area",btns:{icon:"ss.png",hint:"selectable area",">":[{name:"add",icon:"ss.png",action:"method1",hint:""},{name:"remove",icon:"ss.png",action:"method1",hint:""}]}},{name:"text",btns:{icon:"ss.png",hint:"text area",action:"method1"}},{name:"print",btns:{icon:"ss.png",hint:"selectable area",action:"print"}},{name:"clear",btns:{icon:"ss.png",hint:"selectable area",action:"method1"}},{name:"modify",btns:{icon:"ss.png",hint:"modify",">":[{name:"delete",
icon:"ss.png",action:"method1",hint:""},{name:"color",icon:"ss.png",action:"method1",hint:""},{name:"alpha",icon:"ss.png",action:"method1",hint:""},{name:"undo",icon:"ss.png",action:"method1",hint:""},{name:"redu",icon:"ss.png",action:"method1",hint:""}]}}];this.setup()}function g(a,c){b(a.parent.parent)}function a(a,b){}function b(a){createjs.Tween.get(a.submenu,{override:!0}).to({x:a.menucontain.width,scaleX:0},250,createjs.Ease.quadIn);createjs.Tween.get(a.menucontain,{override:!0}).to({x:0,scaleX:1},
250,createjs.Ease.quadIn);window.WBdraw.trace("-----\x3eOUT");window.WBdraw.trace(a);window.WBdraw.trace(a.hi_Y);if(0!=a.hi_Y){var b=a.getChildByName("hi");createjs.Tween.get(b,{override:!0}).to({y:a.hi_Y},250,createjs.Ease.quadIn)}}function c(a,b){var c=a.parent.parent;void 0==c.options&&console.log("[E] submenu functions out of context. Please make sure function is delegated");var l=void 0;null==l&&(l="EN");var k=c.options[l];stot=k.length;l=c.hostWL=null;if(c.submenu.currentMenu!=b){c.submenu.requestedMenu(b);
c.submenu.removeAllBtns();var h=new WBdraw.Button("back","back.png","back to menu","back","#999",g);c.submenu.addChild(h);l=h;for(h=0;h<stot;++h){var m=k[h];if(c.subscriberWL[m.name]&&m.name==b){k=m.btns[">"];stot=k.length;for(m=0;m<stot;++m)h=new WBdraw.Button(k[m].name,k[m].icon,k[m].hint,k[m].name,"#"+Math.floor(16777215*Math.random()).toString(16),f),null!=l?(h.x=0,h.y=l.y+l.height+10):h.x=h.y=0,h.alpha=.5,c.submenu.addChild(h),l=h;break}}window.WBdraw.trace(".........FINISHED ");c.submenu.setSize(c.menucontain.width,
c.menucontain.height,"#"+Math.floor(16777215*Math.random()).toString(16),!0);c.submenu.x=c.menucontain.width;c.submenu.scaleX=0}createjs.Tween.get(c.submenu,{override:!0}).to({x:0,scaleX:1},250,createjs.Ease.quadIn);createjs.Tween.get(c.menucontain,{override:!0}).to({x:0,scaleX:.01},250,createjs.Ease.quadIn);window.WBdraw.trace("-----\x3eIN");window.WBdraw.trace(c.hi_Y);0!=c.hi_Y&&(c=c.getChildByName("hi"),createjs.Tween.get(c,{override:!0}).to({y:-20},250,createjs.Ease.quadIn))}function f(a,c){var f=
a.parent.parent,g=f.getChildByName("hi"),h="",k="",m;if(0==f.submenu.scaleX)h=a.name,m=a;else{m=f.menucontain.getChildByName(f.submenu.currentMenu);var B=4,t;a:{t=f.options.EN;tot=t.length;for(var u=0;u<tot;++u){var w=t[u],q=w.btns[">"];if(void 0!=q)for(var A=q.length,v=0;v<A;++v)if(q[v].name==a.name){t=[w.name,a.name];break a}}t=[a.name]}console.log("....submenu Button pressed...");1<t.length&&(h=t[0],k=t[1])}g.x=f.menucontain.x+f.menucontain.width;null!=m&&(f.hi_Y=m.y,f.setHiSize(B,m.height,"#FF0000"));
window.WBdraw.trace("---==>> ||>>  main:"+h+"  sub:"+k);window.WBdraw.trace("........---------__bb__---\x3e>>>>   event Controller>>>>>   ");f.dispatchEvent({type:"MenuEvent",param:[h,k]});0==f.submenu.x&&b(f)}createjs.EventDispatcher.initialize(h.prototype);var k=createjs.extend(h,createjs.Container);k.getLayer=function(a){return this.layers[a]};k.hi_Y=0;k.width=0;k.height=0;k.setup=function(){var a=new createjs.Shape,b=new createjs.Shape;a.alpha=1;a.name=a.id="bg";b.alpha=1;b.name=b.id="hi";this.menucontain=
new WBdraw.MenuBar("wbmenu");this.menucontain.scaleX=1;this.submenu=new WBdraw.MenuBar("sub_wbmenu");this.menubuttons(this.options);this.addChild(a,this.menucontain,b,this.submenu);this.on("mousedown",this.handlePress);this.on("pressup",this.handleRelease);this.on("pressmove",this.moveLocally);window.WBdraw.trace("box1");this.offset=10*Math.random();this.count=0};k.setSize=function(a,b,c){this.setBgSize(a,b,c);this.width=a;this.height=b;for(var f in this.layers)this.layers[f].setSize(a,b,c);k.width=
a;k.height=b};k.setBgSize=function(a,b,c){var f=this.getChildByName("bg");null!=f&&f.graphics.clear().beginStroke("#ccc").beginFill(c).drawRect(0,0,a,b)};k.setHiSize=function(a,b,c){var f=this.getChildByName("hi");null!=f&&f.graphics.clear().beginFill(c).drawRect(0,0,a,b)};k.getWidth=function(){window.WBdraw.trace("get width");return width};k.wbRegister=function(a,b){};k.clear=function(a,b){};k.wbSwitch=function(a){};k.unshift=function(a){};k.push=function(a){};k.handlePress=function(a){a.stopImmediatePropagation()};
k.handleRelease=function(a){a.stopImmediatePropagation()};k.moveLocally=function(a){a.stopImmediatePropagation()};k.menubuttons=function(b,g){null==g&&(g="EN");options=b[g];stot=options.length;var h=this.hostWL=null,k=null,k=this.oInvoke,k=new WBdraw.Button("up","up.png","back to menu","up","#999",a);this.menucontain.addChild(k);for(var h=k,m=0;m<stot;++m){var y=options[m];this.subscriberWL[y.name]&&(k=void 0==y.btns[">"]?f:k=c,k=new WBdraw.Button(y.name,y.btns.icon,y.btns.hint,y.name,"#"+Math.floor(16777215*
Math.random()).toString(16),k),null!=h?(k.x=0,k.y=h.y+h.height+10):k.x=k.y=0,k.alpha=.5,this.menucontain.addChild(k,null==h?!0:!1),h=k)}window.WBdraw.trace("________done...");h=this.menucontain.getSize();console.log(h);createjs.Tween.get(this).wait(1).wait(300).call(this.setBgSize,[h.x,h.y,"#DDD"],this)};m.Menu=createjs.promote(h,"Container")})(window.WBdraw);(function(m){function h(a,b,c,f){this.Container_constructor();this.id=this.name=a;this.color=f;this.label=b;this.text=new createjs.Text("tools","20px Arial","#000");this.setup();this.currentMenu=""}var g=createjs.extend(h,createjs.Container);g.requestedMenu=function(a){this.currentMenu=a};g.addChild=function(a){console.log(a.id);this.Container_addChild(a);this.setSize(a.x+a.width,a.y+a.height,"#"+Math.floor(16777215*Math.random()).toString(16));a=this.children;for(var b in a)"btn"==a[b].type&&(a[b].x=
.5*Math.abs(this.width-a[b].width))};g.width=function(a){console.log("@@!!!!@@@  "+this.getWidth());this.Container_width(a)};g.removeAllBtns=function(){for(var a=this.children.length,b=0;b<a;++b)console.log(this.children[b]),"btn"==this.children[b].type&&(this.removeChild(this.children[b]),--a,--b)};g.setup=function(){this.scaleX=0;var a=new createjs.Shape;a.name=a.id="bg";a.alpha=.5;this.on("mousedown",this.handlePress);this.on("pressup",this.handleRelease);this.on("pressmove",this.moveLocally);
this.addChild(a);this.offset=10*Math.random();this.count=0};g.handlePress=function(a){a.stopImmediatePropagation()};g.handleRelease=function(a){a.stopImmediatePropagation()};g.moveLocally=function(a){a.stopImmediatePropagation()};g.width=0;g.height=0;g.setSize=function(a,b,c,f){var g=this.getChildByName("bg");if(null==g)throw Error("FAILED to load bg in wbMenuBar");g.graphics.clear().beginStroke("#ccc").beginFill(c).drawRect(0,0,a,b);this.width=a;this.height=b;if(f)for(c=this.children.length,f=0;f<
c;++f)"btn"==this.children[f].type&&(this.children[f].width=a),this.children[f].height=b};g.getWidth=function(){return width};g.getSize=function(){return new createjs.Point(this.width,this.height)};g.endDraw=function(a){a=a.target;var b;a=a.getObjectsUnderPoint(a.mouseX,a.mouseY,1);for(var c=0;c<a.length;c++)if(a[c].parent.scaled){b=a[c].parent;break}console.log(b.scaled);null!=b&&(b.scaled=!1,createjs.Tween.get(b,{override:!0}).to({scaleX:1,scaleY:1},100,createjs.Ease.quadIn))};m.MenuBar=createjs.promote(h,
"Container")})(window.WBdraw);(function(m){function h(g,a,b){this.initialize(g,a,b)}h.PLATFORM_DESKTOP="desktop";h.PLATFORM_WP7="wp7";h.PLATFORM_WP8="wp8";h.PLATFORM_IPHONE="iPhone";h.PLATFORM_IPHONE3="iPhone3";h.PLATFORM_IPHONE_PINNED="iPhonePinned";h.PLATFORM_IPHONE3_PINNED="iPhone3Pinned";h.QUALITY_NORMAL=0;h.QUALITY_HIGH=1;h.QUALITY_LOW=2;h.prototype={touchEnabled:!1,isIOS:!1,width:1024,height:622,scaleFactor:1,platform:null,quality:h.QUALITY_NORMAL,initialize:function(g,a,b){null!=a&&(this.width=a);null!=b&&(this.height=
b);this.platform=g;switch(g){case h.PLATFORM_DESKTOP:this.width=1024;this.height=622;break;case h.PLATFORM_WP7:this.width=800;this.height=410;this.scaleFactor=.6;this.quality=h.QUALITY_LOW;break;case h.PLATFORM_WP8:this.width=1280;this.height=700;this.scaleFactor=.6;this.quality=h.QUALITY_HIGH;break;case h.PLATFORM_IPHONE:this.width=960,this.height=640,this.scaleFactor=.5,this.quality=h.QUALITY_HIGH}},toString:function(){return"[Config.ConfigWB]"}};m.ConfigWB=h})(window.WBdraw);
//# sourceMappingURL=final.map
