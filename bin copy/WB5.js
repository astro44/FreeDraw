(function(n){var e={browser:null,version:null,os:null,isIE:function(){return"Explorer"==e.browser},isVista:function(){return-1!=navigator.userAgent.indexOf("Windows NT 6.0")},isXP:function(){return-1!=navigator.userAgent.indexOf("Windows NT 5")},isWindows:function(){return"Windows"==e.os},isWP8:function(){return-1!=navigator.userAgent.indexOf("Windows Phone 8")},isWP7:function(){return-1!=navigator.userAgent.indexOf("Windows Phone 7")},isAndroid:function(){return-1!=navigator.userAgent.indexOf("Android")},
isIE9:function(){return this.isIE()&&9==this.getInternetExplorerVersion()},isMac:function(){return"Mac"==e.os||e.isIOS()},isIOS:function(){return"iPhone/iPod"==e.os||"iPad"==e.os},isIOSRetina:function(){return e.isIOS()&&1<window.devicePixelRatio},isMobileSafari:function(){return e.isSafari()&&e.isIOS()},isSafari:function(){return"Safari"==e.browser},isChrome:function(){return"Chrome"==e.browser},isFirefox:function(){return"Firefox"==e.browser||"Mozilla"==e.browser},isOpera:function(){return"Opera"==
e.browser},getInternetExplorerVersion:function(){var c=-1;"Microsoft Internet Explorer"==navigator.appName&&null!=/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)&&(c=parseFloat(RegExp.$1));return c}};e._dataBrowser=[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",
versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},
{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}];e._dataOS=[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.userAgent,subString:"iPad",identity:"iPad"},{string:navigator.platform,subString:"Linux",identity:"Linux"}];e._versionSearchString=null;e.init=function(){e.browser=e._searchString(e._dataBrowser)||
"An unknown browser";e.version=e._searchVersion(navigator.userAgent)||e._searchVersion(navigator.appVersion)||"An unknown version";e.os=e._searchString(e._dataOS)||"An unknown OS"};e._searchString=function(c){for(var a=0,b=c.length;a<b;a++){var m=c[a].string,p=c[a].prop;e._versionSearchString=c[a].versionSearch||c[a].identity;if(m){if(-1!=m.indexOf(c[a].subString))return c[a].identity}else if(p)return c[a].identity}};e._searchVersion=function(c){var a=c.indexOf(e._versionSearchString);if(-1!=a)return parseFloat(c.substring(a+
e._versionSearchString.length+1))};n.BrowserDetect=e;e.init()})(null!=window.Main?window.Main:window);(function(n){function e(a,b,c,e,g,h){this.Container_constructor();this.method=h;this.color=g;this.label=e;this.name=this.id=a;this.hint=c;this.icon=b;this.type="btn";this.height=this.width=0;this.setup()}var c=createjs.extend(e,createjs.Container);c.setup=function(){var a=window.WBdraw.ConfigWB.luma(this.color),b=window.WBdraw.ConfigWB.getContrast50(this.color);130>a&&(b="#FFF");a=new createjs.Text(this.label,"20px Arial",b);a.textBaseline="top";a.textAlign="center";this.width=a.getMeasuredWidth()+
30;this.height=a.getMeasuredHeight()+20;a.x=this.width/2;a.y=10;b=new createjs.Shape;b.graphics.beginFill(this.color).drawRoundRect(0,0,this.width,this.height,10);b.snapToPixel=!0;a.snapToPixel=!0;this.addChild(b,a);this.on("click",this.handleClick);this.on("rollover",this.handleRollOver);this.on("rollout",this.handleRollOver);this.cursor="pointer";this.mouseChildren=!1;this.offset=10*Math.random();this.count=0};c.handleClick=function(a){this.method(this,this.id)};c.handleRollOver=function(a){this.alpha=
"rollover"==a.type?.4:1};n.Button=createjs.promote(e,"Container")})(window.WBdraw);var BUILD="debug";
(function(n){function e(){}function c(a){a=mainStage.getChildByName("BASE_main");window.stats.begin();window.stats1.begin();window.stats2.begin();if(a.width!=mainStage.canvas.width||a.height!=mainStage.canvas.height)if(a.setSize(mainStage.canvas.width,mainStage.canvas.height,"#CCC"),console.log("abc tick  width:"+a.width+"  widthCvs:"+mainStage.canvas.width+"  height:"+a.height+"  heightCvs:"+mainStage.canvas.height),a=mainStage.canvas,void 0!=a){var b=mainStage.getChildByName("BASE_main"),b=new window.WBdraw.ConfigWB(BrowserDetect.os,
b.width,b.height);window.WBdraw.trace(b.width+", "+b.height+", "+b.scaleFactor);a.width=b.width;a.height=b.height;a.style.width=b.width*b.scaleFactor+"px";a.style.height=b.height*b.scaleFactor+"px"}window.stats.end();window.stats1.end();window.stats2.end()}e.main=function(){(new e).initialize()};e.prototype.initialize=function(){this.mainCanvas=document.getElementById("mainCanvas");this.mainCanvas.setStrokeStyle="#FF0000";this.mainStage=new createjs.Stage(this.mainCanvas);this.mainStage.snapToPixelsEnabled=
!0;this.mainStage.id="mainIn";window.mainStage=this.mainStage;this.mainStage.enableMouseOver(10);var a=new Stats,b=new Stats,m=new Stats;a.setMode(0);b.setMode(1);m.setMode(2);a.domElement.style.position="absolute";a.domElement.style.left="0px";a.domElement.style.bottom="10px";document.body.appendChild(a.domElement);window.stats=a;b.domElement.style.position="absolute";b.domElement.style.left="90px";b.domElement.style.bottom="10px";document.body.appendChild(b.domElement);window.stats1=b;m.domElement.style.position=
"absolute";m.domElement.style.left="180px";m.domElement.style.bottom="10px";document.body.appendChild(m.domElement);window.stats2=m;createjs.Ticker.addEventListener("tick",this.mainStage);createjs.Ticker.timingMode=createjs.Ticker.RAF_SYNCHED;createjs.Ticker.setFPS(60);createjs.Ticker.on("tick",c);createjs.Touch.enable(this.mainStage);this.mainStage.enableMouseOver();window.WBdraw.trace("main...start");window.WBdraw.trace(BrowserDetect.browser);window.WBdraw.trace(BrowserDetect.version);window.WBdraw.trace(BrowserDetect.os);
window.WBdraw.trace(BrowserDetect.isIOS());a=new WBdraw.WBoard("BASE_main","#ccc");a.snapToPixel=!0;WBdraw.currentBoard=a;this.mainStage.addChild(a)};n.Main=e})(window);(function(n){function e(a,b,c,e){this.Container_constructor();this.method=c;this.methodStop=e;this.color=b;this.name=this.id=a;this.type="btn";this.height=this.width=0;this.background=null;this.stroke=1;this.setup()}var c=createjs.extend(e,createjs.Container);c.setup=function(){this.width=this.height=30;this.background=new createjs.Shape;this.background.snapToPixel=!0;this.background.graphics.beginStroke("#000");this.background.graphics.beginFill(this.color).drawCircle(0,0,.5*this.height);this.background.graphics.endFill();
this.addChild(this.background);this.cache(.5*-this.width-this.stroke,.5*-this.width-this.stroke,this.width+1.7*this.stroke,this.width+1.7*this.stroke);this.on("click",this.handleClick);this.on("mousedown",this.handlePress);this.on("pressup",this.handleRelease);this.on("rollover",this.handleRollOver);this.on("rollout",this.handleRollOver);this.cursor="pointer";this.mouseChildren=!1;this.offset=10*Math.random();this.count=0};c.resize=function(a,b){this.uncache();this.height=this.width=a;this.background.graphics.clear();
this.background.graphics.beginStroke("#000");this.background.graphics.beginFill(this.color).drawEllipse(0,0,a,b);this.background.graphics.endFill();this.background.x=.5*-a;this.background.y=.5*-b;this.cache(.5*-this.width-this.stroke,.5*-this.height-this.stroke,this.width+this.stroke,this.height+this.stroke)};c.handlePress=function(a){this.method(this,this.id);a.stopImmediatePropagation()};c.handleRelease=function(a){console.log("release");this.methodStop(this,this.id);a.stopImmediatePropagation()};
c.handleClick=function(a){a.stopImmediatePropagation()};c.handleRollOver=function(a){this.alpha="rollover"==a.type?.4:1};n.resizeBtn=createjs.promote(e,"Container")})(window.WBdraw);var Stats=function(){function n(a,f,l){a=document.createElement(a);a.id=f;a.style.cssText=l;return a}function e(a,f,l){var h=n("div",a,"padding:0 0 3px 3px;text-align:left;background:"+l),b=n("div",a+"Text","font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px;color:"+f);b.innerHTML=a.toUpperCase();h.appendChild(b);a=n("div",a+"Graph","width:74px;height:30px;background:"+f);h.appendChild(a);for(f=0;74>f;f++)a.appendChild(n("span","","width:1px;height:30px;float:left;opacity:0.9;background:"+
l));return h}function c(a){for(var l=f.children,b=0;b<l.length;b++)l[b].style.display=b===a?"block":"none";h=a}function a(a,f){a.appendChild(a.firstChild).style.height=Math.min(30,30-30*f)+"px"}var b=self.performance&&self.performance.now?self.performance.now.bind(performance):Date.now,m=b(),p=m,g=0,h=0,f=n("div","stats","width:80px;opacity:0.9;cursor:pointer");f.addEventListener("mousedown",function(a){a.preventDefault();c(++h%f.children.length)},!1);var l=0,w=Infinity,k=0,A=e("fps","#0ff","#002"),
B=A.children[0],D=A.children[1];f.appendChild(A);var y=0,v=Infinity,x=0,A=e("ms","#0f0","#020"),t=A.children[0],q=A.children[1];f.appendChild(A);if(self.performance&&self.performance.memory){var z=0,u=Infinity,C=0,A=e("mb","#f08","#201"),E=A.children[0],F=A.children[1];f.appendChild(A)}c(h);return{REVISION:14,domElement:f,setMode:c,begin:function(){m=b()},end:function(){var f=b();y=f-m;v=Math.min(v,y);x=Math.max(x,y);t.textContent=(y|0)+" MS ("+(v|0)+"-"+(x|0)+")";a(q,y/200);g++;if(f>p+1E3&&(l=Math.round(1E3*
g/(f-p)),w=Math.min(w,l),k=Math.max(k,l),B.textContent=l+" FPS ("+w+"-"+k+")",a(D,l/100),p=f,g=0,void 0!==z)){var h=performance.memory.usedJSHeapSize,c=performance.memory.jsHeapSizeLimit;z=Math.round(9.54E-7*h);u=Math.min(u,z);C=Math.max(C,z);E.textContent=z+" MB ("+u+"-"+C+")";a(F,h/c)}return f},update:function(){m=this.end()}}};"object"===typeof module&&(module.exports=Stats);(function(n){function e(a,f){this.Container_constructor();this.id=this.name=a;this.color=f;this.layers={};this.controller=null;this.currentTab=0;this.allTabs={};this._tempModel=this._sandboxRect=this._isConnector=this._undoRange=this._objectInit=this.shapeNOW=this._currentdeckIndex=null;this._isSynched=!1;this._int=0;this._pressMove=null;this.setup()}function c(a){var f=a.currentTarget;if("links"!=this._tempModel.type){var l=a.stageY-f.rel.y+f.regY;f.x=a.stageX-f.rel.x+f.regX;f.y=l;update=!0;a.stopImmediatePropagation();
f.dispatchEvent({type:"MoveEvent",param:f})}}function a(a){window.WBdraw.trace("=========commited-========"+this.currentTab);var f=a.param;console.log(f);if("links"==f.type&&a.action!=window.WBdraw.FormProxy.DELETE){var l=this.uniqueLink(f,this.currentTab);l&&(window.WBdraw.trace("========= C O P Y ========"),this.onDelete(f,this.currentTab,!1,!0),f=l);f.visible=!0}f._commited=!0;this.updateShape(f,a.action,this.currentTab)}function b(a){window.WBdraw.trace("=========onPRESS-========"+this.currentTab);
null!=this.shapeNOW&&(this.shapeNOW.visible=!0);a=a.param;console.log("   ===>"+a.id);if("links"==this._tempModel.type){console.log("ola links just happened");var f=null;null==this.shapeNOW?(f=p(this),console.log("=========  ( A )")):"links"==this.shapeNOW.type?(f=this.shapeNOW,console.log("=========  ( B )"+f),f.linked&&console.log("=========  ( C )")):(f=p(this),console.log("=========  ( D )"));f.link(a)?(this.shapeNOW=null,mainStage.removeEventListener("stagemousemove",this._pressMove)):(this.shapeNOW=
f,f.x=a.x,f.y=a.y,mainStage.addEventListener("stagemousemove",this._pressMove))}else mainStage.addEventListener("stagemouseup",a.moveEND.bind(a)),a.scaled||(createjs.Tween.get(a,{override:!0}).to({scaleX:1.05,scaleY:1.05},100,createjs.Ease.quadIn),a.scaled=!0,a.rel2=new createjs.Point(mainStage.mouseX-a.x,mainStage.mouseY-a.y),a.rel=new createjs.Point(.5*a.width+a.rel2.x,.5*a.height+a.rel2.y))}function m(a){window.WBdraw.trace("=========onRelease-========"+this.currentTab);var f=a.param;"links"==
this._tempModel.type?console.log("ola links just happened"):(mainStage.removeEventListener("stagemousemove",f.moveSTART),mainStage.removeEventListener("stagemouseup",f.moveEND),window.WBdraw.trace(this.resizer),window.WBdraw.trace("=========onSelect-=22222======="),this.resizer.handleRollOver(a),void 0==this.resizer.parent&&this.addChild(this.resizer),this.resizer.wrapTarget(this.resizer,f),console.log(f),this.shapeNOW=f)}function p(h){console.log("!!!!! create    !!!"+h._tempModel.classIn);var f=
h.layers.cvsMAIN,l=h._tempModel.type,w="rcolvi_";h._isSynched||(w+=h._int,++h._int);l=new (WBdraw["Form"+window.WBdraw.toTitleCase(h._tempModel.classIn)])(w,l);l.x=mainStage.mouseX;l.y=mainStage.mouseY;f.addChild(l);h.shapeNOW=l;l.addEventListener("CommitEvent",a.bind(h));l.addEventListener("PressEvent",b.bind(h));l.addEventListener("ReleaseEvent",m.bind(h));if("links"!=l.type)l.on("pressmove",c.bind(h));return l}var g=createjs.extend(e,createjs.Container);g.getLayer=function(a){return this.layers[a]};
g.drawinit=function(a,f,l,b){if(null==l||""==l)l=f;console.log("!@#@!!@###@@@====>>  form:"+f+" type:"+l);switch(f){case "modify":switch(l){case "delete":null!=this.shapeNOW&&(this.onDelete(this.shapeNOW,this.currentTab,!1,!1),this.shapeNOW=null)}break;case "clear":this.onDeleteAll(this.currentTab);this.shapeNOW=null;break;case "print":break;default:a._objectInit=!1,a._tempModel={classIn:f,type:l,path:b}}};g.shapeTweenUpdate=function(a,f){f.alpha=.5;createjs.Tween.get(owner.form,{override:!0}).to({x:f.x,
y:f.y,alpha:1},300,createjs.Ease.quadIn)};g.menuEventProxy=function(a){this.drawinit(this,a.param[0],a.param[1])};g.shapeStart=function(){if(null!=this.shapeNOW){console.log("...found shape in use..."+this.shapeNOW.id);if(!this.shapeNOW._commited)if("links"!=this.shapeNOW.type)this.shapeNOW.drawPerm(this.shapeNOW,!1);else this.onDelete(this.shapeNOW,this.currentTab,!1,!0);this.shapeNOW=null}console.log(this.shapeNOW);switch(this._tempModel.type){case "select":break;case "ungroup":break;case "links":console.log("links[IN]");
break;default:this._objectInit||(window.WBdraw.trace(" Form"+window.WBdraw.toTitleCase(this._tempModel.classIn)),p(this))}};g.drawing=function(a,f){if(0==this._objectInit&&(console.log("..drawing nwo"),void 0!=this.shapeNOW&&this.shapeNOW!=this.resizer.formTarget)){var l=this.shapeNOW.bg.globalToLocal(a,f);this.shapeNOW.drawTemp(l.x,l.y)}};g.drawdone=function(a){window.WBdraw.trace("...done nwo",g);void 0!=a.shapeNOW&&(a.shapeNOW.drawPerm(a.shapeNOW,!1),"text"==a.shapeNOW.type&&(void 0==a.resizer.parent&&
a.addChild(this.resizer),a.resizer.wrapTarget(a.resizer,a.shapeNOW),a.test_draw("line","free")));a.shapeNOW=null};g.clearObject=function(){this.shapeNOW=null};g.setup=function(){var a=new createjs.Shape;a.snapToPixel=!0;a.alpha=1;a.name=a.id="bg";var f=new WBdraw.Box("cvsDECK","#ccc",!0),l=new WBdraw.Box("cvsMAIN","#ccc",!0),b=new WBdraw.Box("cvsSAND","#ccc",!0);f.snapToPixel=!0;l.snapToPixel=!0;b.snapToPixel=!0;this.layers[f.id]=f;this.layers[l.id]=l;this.layers[b.id]=b;window.WBdraw.trace("8=====1====o");
this.resizer=new WBdraw.FormResize("rsize","rtool");this.resizer.x=200;this.resizer.y=20;this.resizer.snapToPixel=!0;this.addChild(a,f,l,b);this.menu=new WBdraw.Menu("m1",this);this.menu.snapToPixel=!0;this.menu.addEventListener("MenuEvent",this.menuEventProxy.bind(this));this.addChild(this.menu);this.on("click",this.handleClick.bind(this));this.on("mousedown",this.handlePress.bind(this));this.on("pressup",this.handleRelease.bind(this));this.offset=10*Math.random();this.count=0;this.test_draw("line",
"free");this._pressMove=this.drawLine.bind(this)};g.width=0;g.height=0;g.setSize=function(a,f,l){var b=this.getChildByName("bg");console.log("resizeBy");b.graphics.clear().beginStroke("#ccc").beginFill(l).drawRect(0,0,a,f);for(var k in this.layers)this.layers[k].setSize(a,f,l);g.width=a;g.height=f};g.getWidth=function(){console.log("get width");return width};g.wbRegister=function(a,f){};g.clear=function(a,f){};g.wbSwitch=function(a){};g.unshift=function(a){};g.push=function(a){};g.handleClick=function(a){window.WBdraw.trace("click1")};
g.handlePress=function(a){console.log("pressing.33gfw...");this.shapeStart();this.on("pressmove",this._pressMove);this.resizer.EMPTY()&&(this.shapeNOW.id==this.resizer.formTarget.id&&(this.shapeNOW=null),this.onDelete(this.resizer.formTarget,this.currentTab,!1,!1));this.resizer.wrapTarget(this.resizer,null);a.stopImmediatePropagation()};g.handleRelease=function(a){this.drawdone(this);this.off("pressmove",this._pressMove)};g.drawLine=function(a){this.drawing(mainStage.mouseX,mainStage.mouseY)};g.endDraw=
function(a){window.WBdraw.trace("enddraw1");this.off("pressmove",this._pressMove)};g.test_draw=function(a,f){window.WBdraw.trace("enddraw1");this.drawinit(this,a,f)};g.onDelete=function(a,f,l,b){window.WBdraw.trace("8=========o");console.log(a);void 0==a?window.WBdraw.trace("<<<<<<<<<< undefined in DELETE >>>>>>>>>>"):(a=this.layers.cvsMAIN.getChildByName(a.name),l||this.updateShape(a,window.WBdraw.FormProxy.DELETE,f),null!=a&&null!=a.parent&&(console.log(a.parent),a.destroy(b),window.WBdraw.trace("<<<<===delete...====o"),
a.commit(window.WBdraw.FormProxy.DELETE),a.removeAllEventListeners(),a.parent.removeChild(a),delete a),b||console.log("send to JMS server"),this.resizer.wrapTarget(this.resizer,null))};g.onDeleteAll=function(a){if(a==this.currentTab){window.WBdraw.trace("< [START] removeAll>");console.log(this.allTabs);for(var f=this.allTabs[a].length;0<this.allTabs[a].length;)console.log(this.allTabs[a][f-1]),this.onDelete(this.allTabs[a][f-1],a,!0,!1),--f}window.WBdraw.trace("< [END] removeAll>");console.log(this.allTabs[a]);
void 0!=this.allTabs[a]&&this.allTabs[a].splice(0)};g.updateShape=function(a,f,l){var b=!1;console.log("~~~~!-updateShape-!~~~~"+l);void 0==a&&(window.WBdraw.trace("<<<<<<<  [1] ???????????   >>>>>>>>>"+a),window.WBdraw.trace("<<<<<<<<<<      >>>>>>>>>>"),window.WBdraw.trace("<<<<<<<<<<      >>>>>>>>>>"),window.WBdraw.trace("<<<<<<<<<< undefined in updateShape >>>>>>>>>>"));void 0==this.allTabs[l]&&(this.allTabs[l]=[]);var k=this.allTabs[l].length;console.log(this.allTabs);console.log(this.allTabs[l]);
var c=new window.WBdraw.FormProxy;window.WBdraw.FormProxy.flattenForm(c,a);void 0==c&&(window.WBdraw.trace("     [2]   <<<<<<<   ???????????   >>>>>>>>>"+c),window.WBdraw.trace("        <<<<<<<<<<      >>>>>>>>>>"),window.WBdraw.trace("        <<<<<<<<<<      >>>>>>>>>>"),window.WBdraw.trace("        <<<<<<<<<< undefined in updateShape >>>>>>>>>>"));for(a=0;a<k;++a)if(this.allTabs[l][a].name==c.name){f==window.WBdraw.FormProxy.DELETE?this.allTabs[l].splice(a,1):this.allTabs[l][a]=c;b=!0;break}b||
f==window.WBdraw.FormProxy.DELETE?f==window.WBdraw.FormProxy.DELETE&&console.log("see if event already exists in undo/redo with SAME timeStamp"):this.allTabs[l].push(c)};g.uniqueLink=function(a,f){console.log("~~~~!-link check-!~~~~"+f);void 0==this.allTabs[f]&&(this.allTabs[f]=[]);for(var l=this.allTabs[f].length,b=a.related,k=null,c=null,m=0;m<l;++m)if("links"==this.allTabs[f][m].type&&this.allTabs[f][m].id!=a.id){c=this.allTabs[f][m];k=c.related;if(b.to.id==c.id||b.from.id==c.id)if(b.from.id==
k.to.id||b.from.id==k.from.id||b.to.id==k.to.id||b.to.id==k.from.id)return console.log("  @@!!@@!!@@found same And ITS A copy"),c;if(k.from.id==b.from.id||k.from.id==b.to.id)if(k.to.id==b.to.id||k.to.id==b.from.id)return l=this.allTabs[f][m],k.from.id!=b.from.id&&(c=this.layers.cvsMAIN.getChildByName(l.id),c.bidirection=l.bidirection=!0,c.moveLink(c,window.WBdraw.FormProxy.UPDATE)),console.log("  @@!!@@!!@@f should it be bidirectionl?"),console.log(k.from.id),console.log(b.from.id),console.log(b.to.id),
console.log("  @@!---------____________--------!!@@"),l}return!1};createjs.EventDispatcher.initialize(e.prototype);n.WBoard=createjs.promote(e,"Container")})(window.WBdraw);(function(n){function e(a,b,c){this.Container_constructor();this.id=this.name=a;this.transparent=c;this.color=b;this.setup()}var c=createjs.extend(e,createjs.Container);c.setup=function(){var a=new createjs.Shape;a.snapToPixel=!0;a.alpha=1;a.name=a.id="bg";this.on("click",this.handleClick);this.on("mousedown",this.handlePress);this.on("pressup",this.handleRelease);console.log("box1");this.offset=10*Math.random();this.count=0};c.width=0;c.height=0;c.setSize=function(a,b,m){c.width=a;c.height=b;if(!this.transparent){var e=
this.getChildByName("bg");console.log("resizerrrBy");e.graphics.clear().beginStroke("#ccc").beginFill(m).drawRect(0,0,a,b);this.cache(0,0,a,b)}};c.getWidth=function(){console.log("get width");return width};c.handleClick=function(a){console.log("click");a.stopImmediatePropagation()};c.handlePress=function(a){console.log(a);console.log("press")};c.handleRelease=function(a){console.log("release");a.stopImmediatePropagation()};c.drawLine=function(a){console.log("draw");a.stopImmediatePropagation()};c.endDraw=
function(a){console.log("enddraw");a.stopImmediatePropagation()};n.Box=createjs.promote(e,"Container")})(window.WBdraw);(function(n){function e(a,b){this.Container_constructor();this.id=this.name=a;this.color="";this.type=b;this.limitDraw=!1;this.rect=null;this.segSize=12;this.regY=this.regX=0;this.scaled=!1;this.rel={x:0,y:0};this.text=null;this.label="";this.tempOrigin=null;this.lastXY={x:0,y:0};this.related=null;this._commited=this.biderectional=!1;this.rotary=this.elastic=!0;this.setup()}createjs.EventDispatcher.initialize(e.prototype);var c=createjs.extend(e,createjs.Container);c.setup=function(){this.points=
[];this.bg=new createjs.Shape;this.bg.snapToPixel=!0;this.hitHelper=new createjs.Shape;this.hitHelper.snapToPixel=!0;this.bg.hitArea=this.hitHelper;this.addChild(this.bg);this.on("mousedown",this.handlePress.bind(this));this.on("pressup",this.handleRelease.bind(this));this.cursor="pointer";this.mouseChildren=!1;this.offset=10*Math.random();this.count=0;this.status=window.WBdraw.FormProxy.NEW};c.drawTemp=function(a,b){this._commited=!1;this.uncache();c[this.type](this,a,b)};c.drawPerm=function(a,b){if(a.id==
this.id){try{var m=c[this.type+"Perm"](this,a,b)}catch(e){throw"[E] No function matches:"+this.type+"Perm() in FormFill (wbFormFill.js)";}m&&this.commit(window.WBdraw.FormProxy.UPDATE)}};c.EMPTY=function(){return!1};c.commit=function(a){"blur"!=a&&this.dispatchEvent({type:"CommitEvent",param:this,action:a})};c.scaleState=function(a){this.scaled=a;this.scaleX=this.scaleY=1};c.setSize=function(a,b,c){};c.moveSTART=function(a){a.stopImmediatePropagation();a=a.target;var b;a=a.getObjectsUnderPoint(a.mouseX,
a.mouseY,1);for(var c=0;c<a.length;c++)if(a[c].parent.scaled){b=a[c].parent;break}null!=b&&console.log("@@@  start 9 @@@@")};c.moveEND=function(a){a=a.target;if(this.x!=this.lastXY.x||this.y!=this.lastXY.y){var b;a=a.getObjectsUnderPoint(a.mouseX,a.mouseY,1);for(var c=0;c<a.length;c++)if(a[c].parent.scaled){b=a[c].parent;break}null!=b&&(b.scaled=!1,createjs.Tween.get(b,{override:!0}).to({scaleX:1,scaleY:1},100,createjs.Ease.quadIn));this.commit(window.WBdraw.FormProxy.MOVED);this.lastXY.x=this.x;
this.lastXY.y=this.y}};c.handlePress=function(a){var b={type:"PressEvent",param:this};a.stopImmediatePropagation();this.dispatchEvent(b)};c.handleRelease=function(a){var b={type:"ReleaseEvent",param:this};a.stopImmediatePropagation();this.dispatchEvent(b)};c.handleRollOver=function(a){this.alpha="rollover"==a.type?.4:1};c.square=function(a,b,c){b=new createjs.Point(b,c);c=a.bg.graphics;c.clear();a.points=[];c.setStrokeStyle(5);c.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));c.beginFill("#"+
Math.floor(16777215*Math.random()).toString(16));c.rect(0,0,b.x,b.y);a.points.push(b);c.endStroke();c.endFill()};c.squarePerm=function(a,b,c){b=a.bg.graphics;c=a.bg.hitArea.graphics;b.clear();c.clear();if(0==a.points.length)return a.parent.removeChild(this),!1;olc=a.points[0];lc=window.WBdraw.ConfigWB.convert2pos(a,olc);a.regX=0>lc.x?-Math.abs(.5*lc.x):Math.abs(.5*lc.x);a.x+=a.regX;a.regY=0>lc.y?-Math.abs(.5*lc.y):Math.abs(.5*lc.y);a.y+=a.regY;var e=Math.floor(lc.x),g=Math.floor(lc.y);a.width=Math.abs(e);
a.height=Math.abs(g);if(10>a.width||10>a.height)return a.parent.removeChild(a),delete a,!1;b.setStrokeStyle(5);b.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));b.beginFill("#"+Math.floor(16777215*Math.random()).toString(16));c.setStrokeStyle(10);c.beginStroke("#000");c.beginFill("red");c.rect(0,0,e,g);b.rect(0,0,e,g);b.endStroke();c.endStroke();c.endFill();b.endFill();a.cache(-5+(0>e?e:0),-5+(0>g?g:0),a.width+10,a.height+10);return!0};c.circle=function(a,b,c){b=new createjs.Point(b,
c);c=a.bg.graphics;c.clear();a.points=[];c.setStrokeStyle(5);c.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));c.beginFill("#"+Math.floor(16777215*Math.random()).toString(16));c.drawEllipse(0,0,b.x,b.y);a.points.push(b);c.endStroke();c.endFill()};c.circlePerm=function(a,b,c){b=a.bg.graphics;c=a.bg.hitArea.graphics;b.clear();c.clear();if(0==a.points.length)return a.parent.removeChild(this),!1;olc=a.points[0];lc=window.WBdraw.ConfigWB.convert2pos(a,olc);a.regX=0>lc.x?-Math.abs(.5*lc.x):
Math.abs(.5*lc.x);a.x+=a.regX;a.regY=0>lc.y?-Math.abs(.5*lc.y):Math.abs(.5*lc.y);a.y+=a.regY;var e=Math.floor(lc.x),g=Math.floor(lc.y);a.width=Math.abs(e);a.height=Math.abs(g);if(10>a.width||10>a.height)return a.parent.removeChild(a),delete a,!1;b.setStrokeStyle(5);b.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));b.beginFill("#"+Math.floor(16777215*Math.random()).toString(16));c.setStrokeStyle(10);c.beginStroke("#000");c.beginFill("red");c.drawEllipse(0,0,e,g);b.drawEllipse(0,0,
e,g);b.endStroke();c.endStroke();c.endFill();b.endFill();a.cache(-5+(0>e?e:0),-5+(0>g?g:0),a.width+10,a.height+10);return!0};c.star=function(a,b,c){new createjs.Point(b,c);var e={},g=a.bg.graphics;g.clear();a.points=[];g.setStrokeStyle(5);g.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));g.beginFill("#"+Math.floor(16777215*Math.random()).toString(16));console.log("---=-=-=--=-=-=-=-=>>>>");e.radius=b/mainStage.canvas.width*200;e.pointy=c/mainStage.canvas.height*.9;e.points=5;g.drawPolyStar(0,
0,e.radius,e.points,e.pointy,-90);a.points.push(e);g.endStroke();g.endFill()};c.starPerm=function(a,b,c){b=a.bg.graphics;c=a.bg.hitArea.graphics;b.clear();c.clear();if(0==a.points.length)return b=a.parent,console.log(b.getNumChildren()),a.parent.removeChild(this),console.log(b.getNumChildren()),!1;sPos=a.points[0];a.width=Math.abs(Math.floor(2*sPos.radius));a.height=Math.abs(Math.floor(2*sPos.radius));b.setStrokeStyle(5);b.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));b.beginFill("#"+
Math.floor(16777215*Math.random()).toString(16));c.setStrokeStyle(10);c.beginStroke("#000");c.beginFill("red");c.drawPolyStar(0,0,sPos.radius,sPos.points,sPos.pointy,-90);b.drawPolyStar(0,0,sPos.radius,sPos.points,sPos.pointy,-90);a.x-=sPos.radius;a.y-=sPos.radius;this.x+=sPos.radius;this.y+=sPos.radius;b.endStroke();c.endStroke();c.endFill();b.endFill();return!0};c.destroy=function(a){this.uncache();this._commited=!1};n.FormFill=createjs.promote(e,"Container")})(window.WBdraw);(function(n){function e(a,b){this.Container_constructor();this.id=this.name=a;this.color="";this.type=b;this.limitDraw=!1;this.rect=null;this.segSize=12;this.regY=this.regX=0;this.scaled=!1;this.rel={x:0,y:0};this.text=null;this.label="";this.lastXY={x:0,y:0};this.cacheXY={x:0,y:0};this._commited=!1;this.related=this._listenEnd=this._listenMove=null;this.bidirection=!1;this.rotary=this.elastic=!0;this.setup()}function c(a,b,c){a=a.graphics;a.clear();a.setStrokeStyle(5);a.beginStroke(c);a.beginFill(c);
a.moveTo(-b,b);a.lineTo(0,0);a.lineTo(-b,-b);a.endStroke();a.endFill()}function a(a,b,c){a=a.graphics;a.clear();var k=.5*-b;a.setStrokeStyle(5);a.beginStroke(c);a.beginFill(c);a.drawEllipse(k,k,b,b);a.endStroke();a.endFill()}function b(a,b,c){var k=window.WBdraw.ConfigWB.rotateAngle(b,c);console.log(k);a.arrow.rotation=k;a.ball.rotation=180+k;a.ball.x=0;a.ball.y=0;a.arrow.x=c.x-b.x;a.arrow.y=c.y-b.y}function m(a){console.log(a);this.moveLink(this,window.WBdraw.FormProxy.UPDATE)}function p(a){a.action==
window.WBdraw.FormProxy.DELETE?(this._commited=!1,this.commit(a.action),this.parent&&this.parent.removeChild(this),this.destroy(!1)):this.moveLink(this,window.WBdraw.FormProxy.UPDATE);console.log(a)}function g(a,b,c){b=a.bg.graphics;var k=a.bg.hitArea.graphics;b.clear();k.clear();lc=a.points[0];a.regX=0>lc.x?-Math.abs(.5*lc.x):Math.abs(.5*lc.x);a.x+=a.regX;a.regY=0>lc.y?-Math.abs(.5*lc.y):Math.abs(.5*lc.y);a.y+=a.regY;var e=Math.floor(lc.x),h=Math.floor(lc.y);1!=c&&(b.setStrokeStyle(5),a.color="#"+
Math.floor(16777215*Math.random()).toString(16),b.beginStroke(a.color),k.setStrokeStyle(10),k.beginStroke("#000"),k.beginFill("red"),k.moveTo(0,0),b.moveTo(0,0),b.lineTo(lc.x,lc.y),k.lineTo(lc.x,lc.y),b.endStroke(),k.endStroke(),k.endFill(),a.setDimension(a,lc.x,lc.y,0>e?e:0,0>h?h:0))}createjs.EventDispatcher.initialize(e.prototype);var h=createjs.extend(e,createjs.Container);h.setup=function(){this.points=[];this.bg=new createjs.Shape;this.bg.snapToPixel=!0;this.hitHelper=new createjs.Shape;this.hitHelper.snapToPixel=
!0;this.bg.hitArea=this.hitHelper;this.addChild(this.bg);this.on("mousedown",this.handlePress.bind(this));this.on("pressup",this.handleRelease.bind(this));this.cursor="pointer";this.mouseChildren=!1;this.offset=10*Math.random();this.count=0;"links"==this.type&&(this.elastic=this.rotary=!1,this.arrow=new createjs.Shape,this.arrow.snapToPixel=!0,this.ball=new createjs.Shape,this.ball.snapToPixel=!0,c(this.arrow,20,"#000000"),a(this.ball,20,"#000000"),this.addChild(this.arrow,this.ball));this.status=
window.WBdraw.FormProxy.NEW};h.drawTemp=function(a,b){this._commited=!1;h[this.type](this,a,b)};h.linked=function(){console.log(this.related);return null!=this.related?null!=this.related.from:!1};h.link=function(a){var b={from:null,to:null};if(null!=this.related){b=this.related;if(b.from==a)return console.log("[E]  --\x3eSAME shape AS to"),!1;if(null!=b.to&&null!=b.from)return!0;b.to=a;console.log(b);a=b.to;var c=b.from;this._listenMove=m.bind(this);this._listenEnd=p.bind(this);!BrowserDetect.isIOS()&&
BrowserDetect.isChrome()&&(a.addEventListener("MoveEvent",this._listenMove),c.addEventListener("MoveEvent",this._listenMove));a.addEventListener("CommitEvent",this._listenEnd);c.addEventListener("CommitEvent",this._listenEnd);(finalIn=this.linksPerm(this,b.to,b.from,this.bidirection))&&this.commit(window.WBdraw.FormProxy.UPDATE);return!0}b.from=a;this.related=b;return!1};h.moveLink=function(a,b){var c=a.related.to,k=a.related.from;a.x=k.x;a.y=k.y;a.points=[];a.points.push(new createjs.Point(c.x-k.x,
c.y-k.y));a.linksPerm(a,!1);null!=b&&a.commit(b)};h.drawPerm=function(a,b){if(a.id==this.id){try{var c=h[this.type+"Perm"](this,a,b)}catch(k){throw console.log(k),"[E] No function matches:"+this.type+"Perm() in FormLine (wbFormLine.js)";}c&&this.commit(window.WBdraw.FormProxy.UPDATE)}};h.EMPTY=function(){return!1};h.commit=function(a){"blur"!=a&&this.dispatchEvent({type:"CommitEvent",param:this,action:a})};h.width=0;h.height=0;h.scaleState=function(a){this.scaled=a;this.scaleX=this.scaleY=1};h.setSize=
function(a,b,c){};h.getWidth=function(){return width};h.moveSTART=function(a){a.stopImmediatePropagation();a=a.target;for(var b,c=a.getObjectsUnderPoint(a.mouseX,a.mouseY,1),k=0;k<c.length;k++)if(c[k].parent.scaled){b=c[k].parent;break}null!=b&&(b.x=a.mouseX-b.rel.x+b.regX,b.y=a.mouseY-b.rel.y+b.regY)};h.moveEND=function(a){a=a.target;if(this.x!=this.lastXY.x||this.y!=this.lastXY.y){var b;a=a.getObjectsUnderPoint(a.mouseX,a.mouseY,1);for(var c=0;c<a.length;c++)if(a[c].parent.scaled){b=a[c].parent;
break}null!=b&&(b.scaled=!1,createjs.Tween.get(b,{override:!0}).to({scaleX:1,scaleY:1},100,createjs.Ease.quadIn));this.commit(window.WBdraw.FormProxy.MOVED);this.lastXY.x=this.x;this.lastXY.y=this.y}};h.handlePress=function(a){var b={type:"PressEvent",param:this};a.stopImmediatePropagation();this.dispatchEvent(b)};h.handleRelease=function(a){var b={type:"ReleaseEvent",param:this};a.stopImmediatePropagation();this.dispatchEvent(b)};h.handleRollOver=function(a){this.alpha="rollover"==a.type?.4:1};h.straight=
function(a,b,c){b=new createjs.Point(b,c);c=a.bg.graphics;c.clear();a.points=[];c.setStrokeStyle(5);d=Math.sqrt(b.x*b.x+b.y*b.y);r=d%a.segSize;tot=d/a.segSize;for(var k=0,e=0,h=0;h<tot;++h){var g=h/tot*b.x,m=h/tot*b.y;c.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));c.moveTo(k,e);c.lineTo(g,m);k=g;e=m}c.moveTo(k,e);c.lineTo(b.x,b.y);a.points.push(b);c.endStroke()};h.straightPerm=function(a,b,c){b=a.bg.graphics;c=a.bg.hitArea.graphics;b.clear();c.clear();if(0==a.points.length)return a.parent.removeChild(this),
!1;olc=a.points[0];lc=window.WBdraw.ConfigWB.convert2pos(a,olc);0>lc.x?(a.regX=.5*Math.abs(lc.x),a.bg.x=Math.abs(lc.x),a.x-=a.bg.x):a.regX=Math.abs(.5*lc.x);a.x+=a.regX;0>lc.y?(a.regY=.5*Math.abs(lc.y),a.bg.y=Math.abs(lc.y),a.y-=a.bg.y):a.regY=Math.abs(.5*lc.y);a.y+=a.regY;var k=Math.floor(lc.x),e=Math.floor(lc.y);b.setStrokeStyle(5);a.color="#"+Math.floor(16777215*Math.random()).toString(16);b.beginStroke(a.color);c.setStrokeStyle(10);c.beginStroke("#000");c.beginFill("red");c.moveTo(0,0);b.moveTo(0,
0);b.lineTo(lc.x,lc.y);c.lineTo(lc.x,lc.y);b.endStroke();c.endStroke();c.endFill();a.setDimension(a,lc.x,lc.y,0>k?k:0,0>e?e:0);a.cache(-5,-5,a.width+10,a.height+10);return!0};h.free=function(a,b,c){var k=a.bg.graphics,e=a.points[a.points.length-1],h=0;b=new createjs.Point(b,c);k.setStrokeStyle(5);k.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));void 0==e&&(e=new createjs.Point(0,0));h=b.y;c=e.x;var g=e.y,h=Math.sqrt((c-=b.x)*c+(g-=h)*g);h>a.segSize&&(k.moveTo(e.x,e.y),k.lineTo(b.x,
b.y),k.endStroke(),a.points.push(b))};h.freePerm=function(a,b,c){b=a.bg.graphics;c=a.bg.hitArea.graphics;var k=a.points.length;if(0==k)return a.parent.removeChild(this),!1;new createjs.Point(0,0);b.clear();b.setStrokeStyle(5);b.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));c.setStrokeStyle(10);c.beginStroke("#000");c.beginFill("red");for(var e=0,h=0,g=0,m=0,p=0,n=0,t=0;t<k;++t){var q=a.points[t];q.x>h&&(h=q.x);q.y>e&&(e=q.y);q.x<g&&(g=q.x);q.y<m&&(m=q.y)}0>g&&(p=g);0>m&&(n=m);for(t=
0;t<k;++t)a.points[t].x+=Math.abs(p),a.points[t].y+=Math.abs(n),q=a.points[t],0==t&&(c.moveTo(q.x,q.y),b.moveTo(q.x,q.y)),b.lineTo(q.x,q.y),c.lineTo(q.x,q.y);b.endStroke();c.endStroke();c.endFill();a.x+=p;a.y+=n;a.rect=new createjs.Rectangle(0,0,Math.abs(p)+h,Math.abs(n)+e);b=.5*a.rect.width;c=.5*a.rect.height;a.x-=b;a.y-=c;a.regX=b;a.x+=2*b;a.regY=c;a.y+=2*c;a.setDimension(a,a.rect.width,a.rect.height);console.log(a.points);a.cache(-5,-5,a.rect.width+10,a.rect.height+10);return!0};h.bezier=function(a,
b,c){var k={x:0,y:0},e=a.bg.graphics;c=new createjs.Point(b,c);e.clear();a.points=[];e.setStrokeStyle(5);b=Math.round(c.x);c=Math.round(c.y);k.fx=b;k.cx=k.fx;k.fy=c;k.cy=k.y;e.setStrokeStyle(1);e.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));e.moveTo(k.fx,k.fy);e.lineTo(k.cx,k.cy);e.lineTo(k.x,k.y);e.setStrokeStyle(5);e.bezierCurveTo(k.fx,k.fy,k.cx,k.cy,k.x,k.y);a.points.push(k);e.endStroke()};h.bezierPerm=function(a,b,c){var k=a.points.length;b=a.bg.graphics;c=a.bg.hitArea.graphics;
b.clear();c.clear();if(0==k)return b=a.parent,console.log(b.getNumChildren()),a.parent.removeChild(this),console.log(b.getNumChildren()),!1;k=a.points[0];c.setStrokeStyle(25);c.beginStroke("#000");b.setStrokeStyle(5);b.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));b.bezierCurveTo(k.fx,k.fy,k.cx,k.cy,k.x,k.y);c.bezierCurveTo(k.fx,k.fy,k.cx,k.cy,k.x,k.y);b.endStroke();c.endStroke();a.setDimension(a,k.cx,k.fy);return!0};h.links=function(a,c,e){c=new createjs.Point(c,e);e=a.bg.graphics;
e.clear();console.log("     >>> >> >     connector connecting");a.points=[];e.setStrokeStyle(5);d=Math.sqrt(c.x*c.x+c.y*c.y);r=d%a.segSize;var k=0,h=0,g=10*(0<c.x?-1:1),m=10*(0<c.y?-1:1);tot=d/a.segSize;for(var p=0;p<tot;++p){var n=p/tot*c.x+g,x=p/tot*c.y+m;e.beginStroke("#"+Math.floor(16777215*Math.random()).toString(16));e.moveTo(k,h);e.lineTo(n,x);k=n;h=x}e.moveTo(k+g,h+m);e.lineTo(c.x+g,c.y+m);a.points.push(c);e.endStroke();b(a,{x:0,y:0},{x:c.x+g,y:c.y+m})};h.linksPerm=function(f,e){var h,k,m=
f.related.to,B=f.related.from;f.points=[];b(f,B,m);f.points.push({x:f.arrow.x,y:f.arrow.y});g(f,f,!0);var p=window.WBdraw.ConfigWB.lineInterpolate(f,m.x-B.x,m.y-B.y,6);f.related.a=p;var n=f.related.a?f.related.a:[];0<n.length&&(h=.5*n[n.length-1].x,k=.5*n[n.length-1].y);for(var p={x:0,y:0,d:1E7},v={x:0,y:0,d:1E7},x=0;x<n.length;++x){var t=n[x].x,q=n[x].y,z=f.bg.localToLocal(t,q,m.bg),u=f.bg.localToLocal(t,q,B.bg);m.bg.hitTest(z.x,z.y)&&(z=Math.sqrt((h-t)*(h-t)+(k-q)*(k-q)),z<p.d&&(p.x=t,p.y=q,p.d=
z));B.bg.hitTest(u.x,u.y)&&(u=Math.sqrt((h-t)*(h-t)+(k-q)*(k-q)),u<v.d&&(v.x=t,v.y=q,v.d=u))}f.bg.localToLocal(p.x,p.y,f.parent);h=f.bg.localToLocal(v.x,v.y,f.parent);b(f,v,p);f.points=[];f.points.push({x:f.arrow.x,y:f.arrow.y});f.x=h.x;f.y=h.y;g(f,f,!1);c(f.arrow,20,f.color);f.bidirection?c(f.ball,20,f.color):a(f.ball,20,f.color);f.uncache();f.cache(-5+f.cacheXY.x-10,-5+f.cacheXY.y-10,f.width+10+20,f.height+10+20);return!0};h.setDimension=function(a,b,c,k,e){a.width=Math.abs(b);a.height=Math.abs(c);
a.cacheXY={x:k,y:e};console.log(a.width+"x"+a.height)};h.destroy=function(a){this.uncache();this._commited=!1;if("links"==this.type){a=this.related.to;var b=this.related.from;a&&(BrowserDetect.isIOS()||BrowserDetect.isChrome()&&a.removeEventListener("MoveEvent",this._listenMove),a.removeEventListener("CommitEvent",this._listenEnd));BrowserDetect.isIOS()||BrowserDetect.isChrome()&&b.removeEventListener("MoveEvent",this._listenMove);b.removeEventListener("CommitEvent",this._listenEnd)}console.log(" delete link in FormLine................................")};
n.FormLine=createjs.promote(e,"Container")})(window.WBdraw);(function(n){function e(a,b){console.log("hellow NO dude");this.segSize=3;this.id=this.name=null;this.color=c;this.type=null;this.status=this.label=c;this.pod=this.tab=null;this.y=this.x=0;this.related=this.points=this.type=c;this.biderectional=!1}var c="";e.NEW=1;e.UPDATE=2;e.DELETE=3;e.CLEAR=4;e.ORDER=5;e.STATISTIC=6;e.DELETE_SELECTABLE_AREA=7;e.MOVED=2;e.setup=function(){};e.flattenForm=function(a,b){a.id=a.name=b.name;a.x=b.x;a.y=b.y;a.status=b.status;a.type=b.type;a.points=b.points;a.related=
b.related;a.biderectional=b.biderectional;a.arrow=b.arrow;a.ball=b.ball;a.tab=b.tab;a.pod=b.pod;a.label=b.label;return a};n.FormProxy=e})(window.WBdraw);(function(n){function e(a,b){this.Container_constructor();this.id=this.name=a;this.color="";this.type=b;this.limitDraw=!1;this.rect=null;this.segSize=12;this.tolerance=10;this.regY=this.regX=0;this.scaled=!1;this.TXT=this.boxm=this.boxr=this.box4=this.box3=this.box2=this.box1=this.formTargetLAST=this.formTarget=this.rel=null;this.setup();console.log("@@@@@@  NEW FormResize  ")}function c(a,c){null!==this.TXT&&console.log("<<<<<<<<<<   003  >>>>>>>>>>");if(-1!=c.indexOf("r"))a.on("pressmove",b.bind(this));
else if(-1!=c.indexOf("m"))a.on("pressmove",m.bind(this));else a.on("pressmove",p.bind(this));return""}function a(a,b){a.off("pressmove");console.log("bx1------------\x3e>>>>>>>>>>> stop"+this.formTarget.type);this.formTarget.globalToLocal(2*this.box4.x,2*this.box4.y);this.rotation=this.formTarget.rotation;switch(this.formTarget.type){case "bezier":break;case "free":break;default:this.formTarget.x=this.x-this.box4.x+this.tolerance,this.formTarget.y=this.y-this.box4.y+this.tolerance,this.formTarget.drawTemp(2*
this.box4.x-2*this.tolerance,2*this.box4.y-2*this.tolerance),this.formTarget.drawPerm(this.formTarget)}null!==this.TXT&&(this.TXT.visible=!0,g(this,this.formTarget));this.formTarget.commit("resize");return""}function b(a){a=this.globalToLocal(a.stageX,a.stageY);var b=0-Math.sqrt(Math.abs(a.x-0)*Math.abs(a.x-0)+Math.abs(a.y-0)*Math.abs(a.y-0));a=360*Math.atan2(a.y-b,a.x-0)/Math.PI;this.formTarget.rotation=a+this.rotation;"text"==this.formTarget.type&&(this.rotation=a+this.rotation)}function m(a){this.x=
a.stageX;this.y=a.stageY+.5*this.formTarget.height+10;this.formTarget.x=this.x;this.formTarget.y=this.y}function p(a){var b=a.currentTarget,c=this.globalToLocal(a.stageX,a.stageY),e=0,l=0,e=b.x,l=b.y;b.x=c.x;b.y=c.y;nX=Math.abs(c.x);nY=Math.abs(c.y);var c=Math.ceil(.5*nX),m=Math.ceil(.5*nY),g=!1,p=this.box1.globalToLocal(a.stageX,a.stageY),n=this.box2.globalToLocal(a.stageX,a.stageY),w=this.box3.globalToLocal(a.stageX,a.stageY);a=this.box4.globalToLocal(a.stageX,a.stageY);if(10>c||10>m)g=!0;this.box1.hitTest(p.x,
p.y)&&"bx1"!=b.name?g=!0:this.box2.hitTest(n.x,n.y)&&"bx2"!=b.name?g=!0:this.box3.hitTest(w.x,w.y)&&"bx3"!=b.name?g=!0:this.box4.hitTest(a.x,a.y)&&"bx4"!=b.name&&(g=!0);g?(b.x=e,b.y=l):(h(this,2*c,2*m,b),f(this,Math.ceil(nX),Math.ceil(nY)))}function g(a,b){var c=window.WBdraw.getCanvasDiv("editTxt"),f=window.WBdraw.getCanvasDiv("txt2edit");f.style.width="inherit";c.style.width=b.width+"px";f.style.height="inherit";c.style.height=b.height-10+"px";c=Math.ceil(.5*b.width)+a.tolerance;f=Math.ceil(.5*
b.height)+a.tolerance;a.TXT.x=-c+5;a.TXT.y=-f+5}function h(a,b,c,f){"bx4"!=f.name&&(a.box4.x=b,a.box4.y=c);"bx3"!=f.name&&(a.box3.x=0-b,a.box3.y=c);"bx2"!=f.name&&(a.box2.x=b,a.box2.y=0-c);"bx1"!=f.name&&(a.box1.x=0-b,a.box1.y=0-c);a.boxr.x=0;a.boxm.x=0;a.boxm.y=-c;a.boxr.y=-60-c}function f(a,b,c){var f=a.bg.graphics;f.clear();f.beginStroke("red");f.setStrokeStyle(2);var e=new createjs.Point(-b,-c),h=new createjs.Point(0,0),g=new createjs.Point(b,-c),m=new createjs.Point(b,c),p=new createjs.Point(-b,
c);b=new createjs.Point(b,c);c=new createjs.Point(0,-60-c);l(f,e,g,!1);l(f,e,p,!0);l(f,p,m,!1);l(f,g,b,!0);a.boxr.visible&&l(f,c,h,!0)}function l(a,b,c,f){dx1=b.x;var e=dx2=c.x;dy1=b.y;c=dy2=c.y;d=Math.sqrt((dx2-=dx1)*dx2+(dy2-=dy1)*dy2);tot=d/12;var h=b.x;b=b.y;for(var l=d/tot,g=0;g<=tot;++g){if(f){var m=Math.ceil(b+l),p=e;b=m<b?b-2:b+2;if(m>Math.abs(c))break}else{var p=Math.ceil(h+l),m=c,h=p<h?h-2:h+2;if(Math.abs(p)>Math.abs(e))break}a.moveTo(h,b);a.lineTo(p,m);h=p;b=m}}createjs.EventDispatcher.initialize(e.prototype);
var w=createjs.extend(e,createjs.Container);w.setup=function(){this.points=[];this.bg=new createjs.Shape;this.box1=new WBdraw.resizeBtn("bx1","#FFF",c.bind(this),a.bind(this));this.box2=new WBdraw.resizeBtn("bx2","#FFF",c.bind(this),a.bind(this));this.box3=new WBdraw.resizeBtn("bx3","#FFF",c.bind(this),a.bind(this));this.box4=new WBdraw.resizeBtn("bx4","#FFF",c.bind(this),a.bind(this));this.boxr=new WBdraw.resizeBtn("bxr","#FFF",c.bind(this),a.bind(this));this.boxm=new WBdraw.resizeBtn("bxm","#FFF",
c.bind(this),a.bind(this));var b=window.WBdraw.getCanvasDiv("editTxt");b.style.display="none";b.innerHTML='<textarea name="txt2edit" id="txt2edit" placeholder="enter text here" cols="" rows="" style="width:inherit;font-size:20px; lineHeight:1.0em" readOnly></textarea>';var f=window.WBdraw.getCanvasDiv("txt2edit");f.style.background="rgba(0,0,0,0)";f.style.color="black";f.style.border="none";f.style.overflow="hidden";f.style.fontFamily="Arial";f.style.padding="8px";f.style.fontSize="20px";f.style.lineHeight=
"1.0em";var e=this;f.onclick=function(a){f.readOnly=!1};f.onblur=function(a){null!=e.formTargetLAST&&(e.formTargetLAST.setText(f.value),e.formTarget.x=e.x-e.box4.x+e.tolerance,e.formTarget.y=e.y-e.box4.y+e.tolerance,e.formTarget.drawTemp(2*e.box4.x-2*e.tolerance,2*e.box4.y-2*e.tolerance),e.formTarget.drawPerm(e.formTarget),e.formTargetLAST.commit("text"),e.formTarget!=e.formTargetLAST&&(e.formTargetLAST.visible=!0));e.formTargetLAST=null};this.TXT=new createjs.DOMElement(b);this.bg.snapToPixel=!0;
this.box1.snapToPixel=!0;this.box2.snapToPixel=!0;this.box3.snapToPixel=!0;this.box4.snapToPixel=!0;this.boxr.snapToPixel=!0;this.boxm.resize(50,20);this.boxm.snapToPixel=!0;this.TXT.snapToPixel=!0;this.addChild(this.bg,this.box1,this.box2,this.box3,this.box4,this.boxr,this.boxm,this.TXT)};w.EMPTY=function(){return null!=this.formTarget?this.formTarget.EMPTY():!1};w.width=0;w.height=0;w.handleRollOver=function(a){this.alpha="rollover"==a.type?.4:1};w.wrapTarget=function(a,b){var c=window.WBdraw.getCanvasDiv("editTxt"),
e=window.WBdraw.getCanvasDiv("txt2edit");if(null==b)e.blur(),null!=a.formTarget&&(a.formTarget.scaleState(!1),"text"==a.formTarget.type&&(a.formTarget.visible=!0),a.formTargetLAST=a.formTarget),a.formTarget=null,a.parent&&a.parent.removeChild(this),c.style.display="none";else{this.rotation=b.rotation;var l="text"==b.type;l&&e.blur();a.formTargetLAST=a.formTarget;a.formTarget=b;a.x=b.x;a.y=b.y;var m=Math.ceil(.5*b.width)+a.tolerance,p=Math.ceil(.5*b.height)+a.tolerance;a.box4.visible=a.box3.visible=
a.box2.visible=a.box1.visible=b.elastic;a.boxr.visible=a.boxm.visible=b.rotary;g(a,b);h(a,m,p,"");f(a,m,p);null!=a.formTarget&&(l?(a.formTargetLAST=a.formTarget,""!=a.formTarget.text.text&&(c.style.display="block",console.log("<<<<<<<<<<   001  >>>>>>>>>>"),"enter text here"!=a.formTarget.text.text&&(e.value=a.formTarget.text.text),a.formTarget.visible=!1,BrowserDetect.isIOS()||BrowserDetect.isAndroid()||e.focus())):c.style.display="none")}};n.FormResize=createjs.promote(e,"Container")})(window.WBdraw);(function(n){function e(a,b,c,e){this.Container_constructor();this.id=this.name=a;this.color=e;this.type=c;this.label=b;this.setup();this._commited=!1}var c=createjs.extend(e,createjs.Container);c.setup=function(){var a=new createjs.Text(this.label,"20px Arial","#000");a.name=a.id="txt";a.textBaseline="top";a.textAlign="center";var b=a.getMeasuredWidth()+30,c=a.getMeasuredHeight()+20;a.x=b/2;a.y=10;var e=new createjs.Shape;e.name=e.id="bg";e.graphics.setStrokeStyle(5);e.graphics.beginStroke("#"+Math.floor(16777215*
Math.random()).toString(16));e.graphics.beginFill(this.color).drawRoundRect(0,0,b,c,10);this.addChild(e,a);this.on("click",this.handleClick);this.on("rollover",this.handleRollOver);this.on("rollout",this.handleRollOver);this.on("mousedown",this.handlePress);this.on("pressup",this.handleRelease);this.cursor="pointer";this.mouseChildren=!1;this.offset=10*Math.random();this.count=0};c.handleClick=function(a){};c.hello=function(a){console.log(a);c.width=100};c.width=0;c.height=0;c.setSize=function(a,
b,e){target.getChildByName("bg").graphics.clear().beginStroke("#ccc").beginFill("#"+Math.floor(16777215*Math.random())).drawRect(0,0,a,b);c.width=a;c.height=b};c.getWidth=function(){return width};c.handlePress=function(a){mainStage.addEventListener("stagemousemove",this.drawLine);mainStage.addEventListener("stagemouseup",this.endDraw);console.log(this.id);this.scaled||(createjs.Tween.get(this,{override:!0}).to({scaleX:1.1,scaleY:1.1},100,createjs.Ease.quadIn),this.scaled=!0,this.rel=this.globalToLocal(mainStage.mouseX,
mainStage.mouseY))};c.handleRelease=function(a){mainStage.removeEventListener("stagemousemove",this.drawLine);mainStage.removeEventListener("stagemouseup",this.endDraw);this.dispatchEvent({type:"SelectEvent",param:this})};c.drawLine=function(a){a=a.target;for(var b,c=a.getObjectsUnderPoint(a.mouseX,a.mouseY,1),e=0;e<c.length;e++)if(c[e].parent.scaled){b=c[e].parent;break}null!=b&&(b.x=a.mouseX-b.rel.x,b.y=a.mouseY-b.rel.y,b.getChildByName("bg").graphics.clear().beginStroke("#"+Math.floor(16777215*
Math.random())).beginFill("#"+Math.floor(16777215*Math.random())).drawRect(0,0,a.mouseX,a.mouseY))};c.endDraw=function(a){a=a.target;var b;a=a.getObjectsUnderPoint(a.mouseX,a.mouseY,1);for(var c=0;c<a.length;c++)if(a[c].parent.scaled){b=a[c].parent;break}console.log(b.scaled);null!=b&&(b.scaled=!1,createjs.Tween.get(b,{override:!0}).to({scaleX:1,scaleY:1},100,createjs.Ease.quadIn))};c.handleRollOver=function(a){this.alpha="rollover"==a.type?.4:1};n.FormShape=createjs.promote(e,"Container")})(window.WBdraw);(function(n){function e(a,b){this.Container_constructor();this.id=this.name=a;this.color="000";this.type=b;this.limitDraw=!1;this.rect=null;this.segSize=12;this.regY=this.regX=0;this.scaled=!1;this.text=this.rel=null;this.label="";this.tempOrigin=null;this.lastXY={x:0,y:0};this.points=[];this.related=null;this.biderectional=!1;this.label="enter text here";this.rotary=this.elastic=!0;this.setup()}createjs.EventDispatcher.initialize(e.prototype);var c=createjs.extend(e,createjs.Container);c.setup=function(){this.bg=
new createjs.Shape;this.bg.snapToPixel=!0;this.hitHelper=new createjs.Shape;this.hitHelper.snapToPixel=!0;this.text=new createjs.Text(this.label,"20px Arial","#000");this.text.font="20px Arial";this.text.color="#000000";this.text.padding="10px";this.text.y=-10;this.text.snapToPixel=!0;this.text.hitArea=this.hitHelper;this.addChild(this.bg,this.text);this.on("mousedown",this.handlePress.bind(this));this.on("pressup",this.handleRelease.bind(this));this.cursor="pointer";this.mouseChildren=!1;this.offset=
10*Math.random();this.count=0;this.text.name=this.text.id="txt";this.text.textBaseline="top";this.text.textAlign="left";this.text.wordWrap=!0;this.width=this.text.getMeasuredWidth()+30;this.height=this.text.getMeasuredHeight()+20;this.points.push(new createjs.Point(this.text.getMeasuredWidth()+30,this.text.getMeasuredHeight()+20));this.squarePerm(this);this.status=window.WBdraw.FormProxy.NEW};c.setText=function(a){this.text.text=this.label=a};c.drawTemp=function(a,b){this.uncache();this.bg.alpha=
1;this.square(this,a,b)};c.drawPerm=function(a,b){if(a.id==this.id){try{var c=this.squarePerm(this,a,b)}catch(e){throw console.log(e),"[E] No function matches:"+this.type+"Perm() in FormText (wbFormText.js)";}console.log("...create....");c&&this.commit(window.WBdraw.FormProxy.UPDATE)}};c.EMPTY=function(){return""==this.text.text?!0:!1};c.commit=function(a){"blur"!=a&&this.dispatchEvent({type:"CommitEvent",param:this,action:a})};c.width=0;c.height=0;c.scaleState=function(a){this.scaled=a;this.scaleX=
this.scaleY=1};c.setSize=function(a,b,c){};c.getWidth=function(){return width};c.moveSTART=function(a){a.stopImmediatePropagation();for(var b=a.target,c,b=b.getObjectsUnderPoint(b.mouseX,b.mouseY,1),e=0;e<b.length;e++)if(b[e].parent.scaled){c=b[e].parent;break}null!=c&&(console.log(c.rel+","+c.regX),console.log(a),console.log("@@@  start 9 @@@@"))};c.moveEND=function(a){a=a.target;if(this.x!=this.lastXY.x||this.y!=this.lastXY.y){var b;a=a.getObjectsUnderPoint(a.mouseX,a.mouseY,1);for(var c=0;c<a.length;c++)if(a[c].parent.scaled){b=
a[c].parent;break}null!=b&&(b.scaled=!1,createjs.Tween.get(b,{override:!0}).to({scaleX:1,scaleY:1},100,createjs.Ease.quadIn));console.log("...moved....");this.commit(window.WBdraw.FormProxy.MOVED);this.lastXY.x=this.x;this.lastXY.y=this.y}};c.handlePress=function(a){console.log("...handlePress....");var b={type:"PressEvent",param:this};a.stopImmediatePropagation();this.dispatchEvent(b)};c.handleRelease=function(a){var b={type:"ReleaseEvent",param:this};a.stopImmediatePropagation();this.dispatchEvent(b)};
c.handleRollOver=function(a){this.alpha="rollover"==a.type?.4:1};c.square=function(a,b,c){b=new createjs.Point(b,c);c=a.bg.graphics;c.clear();a.points=[];c.setStrokeStyle(5);c.beginStroke("#000");c.beginFill("#FFF");c.rect(0,0,b.x,b.y);a.points.push(b);c.endStroke();c.endFill()};c.squarePerm=function(a,b,c){b=a.bg.graphics;c=a.text.hitArea.graphics;b.clear();c.clear();if(0==a.points.length)return b=a.parent,console.log(b.getNumChildren()),a.parent.removeChild(this),console.log(b.getNumChildren()),
!1;olc=a.points[0];lc=window.WBdraw.ConfigWB.convert2pos(a,olc);a.regX=0>lc.x?-Math.abs(.5*lc.x):Math.abs(.5*lc.x);a.x+=a.regX;a.regY=0>lc.y?-Math.abs(.5*lc.y):Math.abs(.5*lc.y);a.y+=a.regY;var e=Math.floor(lc.x),g=Math.floor(lc.y);a.width=Math.abs(e);a.height=Math.abs(g)+5;if(30>a.width||20>a.height)a.width<a.text.getMeasuredWidth()&&(a.width=a.text.getMeasuredWidth()+30),a.height<a.text.getMeasuredHeight()&&(a.height=a.text.getMeasuredHeight()+20);30>a.height&&(a.height=40);b.setStrokeStyle(5);
b.beginStroke("#000");b.beginFill("#FFF");c.setStrokeStyle(10);c.beginStroke("#000");c.beginFill("red");c.rect(0,0,e,g);b.rect(0,0,e,g);b.endStroke();c.endStroke();c.endFill();b.endFill();a.text.x=a.text.y=4;a.text.y=-1;a.text.lineWidth=e;a.text.width=e;a.text.height=g;a.bg.visible=!1;a.cache(-5+(0>e?e:0),-5+(0>g?g:0),a.width+10,a.height+10);return!0};c.destroy=function(a){this.uncache();this._commited=!1};n.FormText=createjs.promote(e,"Container")})(window.WBdraw);(function(n){function e(a,b){this.Container_constructor();this.id=this.name=a;this.color=b;this.hi_Y=0;this.Controller=null;this.matrix=new createjs.Matrix2D;this.angle=Math.PI/12;this.currentMenu="";this.options={};this.subscriberWL={select:!0,line:!0,fill:!0,math:!0,media:!0,select:!1,print:!0,clear:!0,modify:!0,text:!0,undo:!0,redo:!0};this.hostWL={select:!0,line:!0,fill:!0,math:!0,media:!0,select:!0,print:!0,clear:!0,modify:!0,text:!0,undo:!0,redo:!0};this.options.BR=[{name:"select",btns:{icon:"ss.png",
hint:"select opject",action:"select"}},{name:"line",btns:{icon:"ss.png",hint:"line",">":[{name:"free",icon:"ss.png",action:"method1",hint:""},{name:"straight",icon:"ss.png",action:"method1",hint:""},{name:"bezier",icon:"ss.png",action:"method1",hint:""},{name:"links",icon:"ss.png",action:"method1",hint:""}]}},{name:"fill",btns:{icon:"ss.png",hint:"fill",">":[{name:"square",icon:"ss.png",action:"method1",hint:""},{name:"circle",icon:"ss.png",action:"method1",hint:""},{name:"star",icon:"ss.png",action:"method1",
hint:""}]}},{name:"math",btns:{icon:"ss.png",hint:"math",">":[{name:"sqrt",icon:"ss.png",action:"method1",hint:""},{name:"axis",icon:"ss.png",action:"method1",hint:""},{name:"graph",icon:"ss.png",action:"method1",hint:""}]}},{name:"media",btns:{icon:"ss.png",hint:"media",">":[{name:"ppt",icon:"ss.png",action:"method1",hint:""},{name:"video",icon:"ss.png",action:"method1",hint:""}]}},{name:"select_area",btns:{icon:"ss.png",hint:"selectable area",">":[{name:"add",icon:"ss.png",action:"method1",hint:""},
{name:"remove",icon:"ss.png",action:"method1",hint:""}]}},{name:"text",btns:{icon:"ss.png",hint:"text area",action:"method1"}},{name:"print",btns:{icon:"ss.png",hint:"selectable area",action:"print"}},{name:"clear",btns:{icon:"ss.png",hint:"selectable area",action:"method1"}},{name:"modify",btns:{icon:"ss.png",hint:"modify",">":[{name:"delete",icon:"ss.png",action:"method1",hint:""},{name:"color",icon:"ss.png",action:"method1",hint:""},{name:"alpha",icon:"ss.png",action:"method1",hint:""},{name:"undo",
icon:"ss.png",action:"method1",hint:""},{name:"redu",icon:"ss.png",action:"method1",hint:""}]}}];this.options.EN=[{name:"select",btns:{icon:"ss.png",hint:"select opject",action:"select"}},{name:"line",btns:{icon:"ss.png",hint:"line",">":[{name:"free",icon:"ss.png",action:"method1",hint:""},{name:"straight",icon:"ss.png",action:"method1",hint:""},{name:"bezier",icon:"ss.png",action:"method1",hint:""},{name:"links",icon:"ss.png",action:"method1",hint:""}]}},{name:"fill",btns:{icon:"ss.png",hint:"fill",
">":[{name:"square",icon:"ss.png",action:"method1",hint:""},{name:"circle",icon:"ss.png",action:"method1",hint:""},{name:"star",icon:"ss.png",action:"method1",hint:""}]}},{name:"math",btns:{icon:"ss.png",hint:"math",">":[{name:"sqrt",icon:"ss.png",action:"method1",hint:""},{name:"axis",icon:"ss.png",action:"method1",hint:""},{name:"graph",icon:"ss.png",action:"method1",hint:""}]}},{name:"media",btns:{icon:"ss.png",hint:"media",">":[{name:"ppt",icon:"ss.png",action:"method1",hint:""},{name:"video",
icon:"ss.png",action:"method1",hint:""}]}},{name:"select_area",btns:{icon:"ss.png",hint:"selectable area",">":[{name:"add",icon:"ss.png",action:"method1",hint:""},{name:"remove",icon:"ss.png",action:"method1",hint:""}]}},{name:"text",btns:{icon:"ss.png",hint:"text area",action:"method1"}},{name:"print",btns:{icon:"ss.png",hint:"selectable area",action:"print"}},{name:"clear",btns:{icon:"ss.png",hint:"selectable area",action:"method1"}},{name:"modify",btns:{icon:"ss.png",hint:"modify",">":[{name:"delete",
icon:"ss.png",action:"method1",hint:""},{name:"color",icon:"ss.png",action:"method1",hint:""},{name:"alpha",icon:"ss.png",action:"method1",hint:""},{name:"undo",icon:"ss.png",action:"method1",hint:""},{name:"redu",icon:"ss.png",action:"method1",hint:""}]}}];this.setup()}function c(a,c){b(a.parent.parent)}function a(a,b){}function b(a){createjs.Tween.get(a.submenu,{override:!0}).to({x:a.menucontain.width,scaleX:0},250,createjs.Ease.quadIn);createjs.Tween.get(a.menucontain,{override:!0}).to({x:0,scaleX:1},
250,createjs.Ease.quadIn);window.WBdraw.trace("-----\x3eOUT");window.WBdraw.trace(a);window.WBdraw.trace(a.hi_Y);if(0!=a.hi_Y){var b=a.getChildByName("hi");createjs.Tween.get(b,{override:!0}).to({y:a.hi_Y},250,createjs.Ease.quadIn)}}function m(a,b){var e=a.parent.parent;void 0==e.options&&console.log("[E] submenu functions out of context. Please make sure function is delegated");var g=void 0;null==g&&(g="EN");var k=e.options[g];stot=k.length;g=e.hostWL=null;if(e.submenu.currentMenu!=b){e.submenu.requestedMenu(b);
e.submenu.removeAllBtns();var m=new WBdraw.Button("back","back.png","back to menu","back","#999",c);e.submenu.addChild(m);g=m;for(m=0;m<stot;++m){var n=k[m];if(e.subscriberWL[n.name]&&n.name==b){k=n.btns[">"];stot=k.length;for(n=0;n<stot;++n)m=new WBdraw.Button(k[n].name,k[n].icon,k[n].hint,k[n].name,"#"+Math.floor(16777215*Math.random()).toString(16),p),null!=g?(m.x=0,m.y=g.y+g.height+10):m.x=m.y=0,m.alpha=.5,e.submenu.addChild(m),g=m;break}}window.WBdraw.trace(".........FINISHED ");e.submenu.setSize(e.menucontain.width,
e.menucontain.height,"#"+Math.floor(16777215*Math.random()).toString(16),!0);e.submenu.x=e.menucontain.width;e.submenu.scaleX=0}createjs.Tween.get(e.submenu,{override:!0}).to({x:0,scaleX:1},250,createjs.Ease.quadIn);createjs.Tween.get(e.menucontain,{override:!0}).to({x:0,scaleX:.01},250,createjs.Ease.quadIn);window.WBdraw.trace("-----\x3eIN");window.WBdraw.trace(e.hi_Y);0!=e.hi_Y&&(e=e.getChildByName("hi"),createjs.Tween.get(e,{override:!0}).to({y:-20},250,createjs.Ease.quadIn))}function p(a,c){var e=
a.parent.parent,g=e.getChildByName("hi"),k="",m="",n;if(0==e.submenu.scaleX)k=a.name,n=a;else{n=e.menucontain.getChildByName(e.submenu.currentMenu);var p=4,y;a:{y=e.options.EN;tot=y.length;for(var v=0;v<tot;++v){var x=y[v],t=x.btns[">"];if(void 0!=t)for(var q=t.length,z=0;z<q;++z)if(t[z].name==a.name){y=[x.name,a.name];break a}}y=[a.name]}console.log("....submenu Button pressed...");1<y.length&&(k=y[0],m=y[1])}g.x=e.menucontain.x+e.menucontain.width;null!=n&&(e.hi_Y=n.y,e.setHiSize(p,n.height,"#FF0000"));
window.WBdraw.trace("---==>> ||>>  main:"+k+"  sub:"+m);window.WBdraw.trace("........---------__bb__---\x3e>>>>   event Controller>>>>>   ");e.dispatchEvent({type:"MenuEvent",param:[k,m]});0==e.submenu.x&&b(e)}createjs.EventDispatcher.initialize(e.prototype);var g=createjs.extend(e,createjs.Container);g.getLayer=function(a){return this.layers[a]};g.hi_Y=0;g.width=0;g.height=0;g.setup=function(){var a=new createjs.Shape,b=new createjs.Shape;a.alpha=1;a.name=a.id="bg";b.alpha=1;b.name=b.id="hi";this.menucontain=
new WBdraw.MenuBar("wbmenu");this.menucontain.scaleX=1;this.submenu=new WBdraw.MenuBar("sub_wbmenu");this.menubuttons(this.options);a.snapToPixel=!0;this.menucontain.snapToPixel=!0;b.snapToPixel=!0;this.submenu.snapToPixel=!0;this.addChild(a,this.menucontain,b,this.submenu);this.on("mousedown",this.handlePress);this.on("pressup",this.handleRelease);this.on("pressmove",this.moveLocally);window.WBdraw.trace("box1");this.offset=10*Math.random();this.count=0};g.setSize=function(a,b,c){this.setBgSize(a,
b,c);this.width=a;this.height=b;for(var e in this.layers)this.layers[e].setSize(a,b,c);g.width=a;g.height=b};g.setBgSize=function(a,b,c){var e=this.getChildByName("bg");null!=e&&e.graphics.clear().beginStroke("#ccc").beginFill(c).drawRect(0,0,a,b)};g.setHiSize=function(a,b,c){var e=this.getChildByName("hi");null!=e&&e.graphics.clear().beginFill(c).drawRect(0,0,a,b)};g.getWidth=function(){window.WBdraw.trace("get width");return width};g.wbRegister=function(a,b){};g.clear=function(a,b){};g.wbSwitch=
function(a){};g.unshift=function(a){};g.push=function(a){};g.handlePress=function(a){a.stopImmediatePropagation()};g.handleRelease=function(a){a.stopImmediatePropagation()};g.moveLocally=function(a){a.stopImmediatePropagation()};g.menubuttons=function(b,c){null==c&&(c="EN");options=b[c];stot=options.length;var e=this.hostWL=null,g=null,g=this.oInvoke,g=new WBdraw.Button("up","up.png","back to menu","up","#999",a);this.menucontain.addChild(g);for(var e=g,k=0;k<stot;++k){var n=options[k];this.subscriberWL[n.name]&&
(g=void 0==n.btns[">"]?p:g=m,g=new WBdraw.Button(n.name,n.btns.icon,n.btns.hint,n.name,"#"+Math.floor(16777215*Math.random()).toString(16),g),null!=e?(g.x=0,g.y=e.y+e.height+10):g.x=g.y=0,g.alpha=.5,this.menucontain.addChild(g,null==e?!0:!1),e=g)}window.WBdraw.trace("________done...");e=this.menucontain.getSize();console.log(e);createjs.Tween.get(this).wait(1).wait(300).call(this.setBgSize,[e.x,e.y,"#DDD"],this)};n.Menu=createjs.promote(e,"Container")})(window.WBdraw);(function(n){function e(a,b,c,e){this.Container_constructor();this.id=this.name=a;this.color=e;this.label=b;this.text=new createjs.Text("tools","20px Arial","#000");this.setup();this.currentMenu=""}var c=createjs.extend(e,createjs.Container);c.requestedMenu=function(a){this.currentMenu=a};c.addChild=function(a){console.log(a.id);this.Container_addChild(a);this.setSize(a.x+a.width,a.y+a.height,"#"+Math.floor(16777215*Math.random()).toString(16));a=this.children;for(var b in a)"btn"==a[b].type&&(a[b].x=
.5*Math.abs(this.width-a[b].width))};c.width=function(a){console.log("@@!!!!@@@  "+this.getWidth());this.Container_width(a)};c.removeAllBtns=function(){for(var a=this.children.length,b=0;b<a;++b)console.log(this.children[b]),"btn"==this.children[b].type&&(this.removeChild(this.children[b]),--a,--b)};c.setup=function(){this.scaleX=0;var a=new createjs.Shape;a.name=a.id="bg";a.alpha=.5;this.on("mousedown",this.handlePress);this.on("pressup",this.handleRelease);this.on("pressmove",this.moveLocally);
this.addChild(a);this.offset=10*Math.random();this.count=0};c.handlePress=function(a){a.stopImmediatePropagation()};c.handleRelease=function(a){a.stopImmediatePropagation()};c.moveLocally=function(a){a.stopImmediatePropagation()};c.width=0;c.height=0;c.setSize=function(a,b,c,e){var g=this.getChildByName("bg");if(null==g)throw Error("FAILED to load bg in wbMenuBar");g.graphics.clear().beginStroke("#ccc").beginFill(c).drawRect(0,0,a,b);this.width=a;this.height=b;if(e)for(c=this.children.length,e=0;e<
c;++e)"btn"==this.children[e].type&&(this.children[e].width=a),this.children[e].height=b};c.getWidth=function(){return width};c.getSize=function(){return new createjs.Point(this.width,this.height)};c.endDraw=function(a){a=a.target;var b;a=a.getObjectsUnderPoint(a.mouseX,a.mouseY,1);for(var c=0;c<a.length;c++)if(a[c].parent.scaled){b=a[c].parent;break}console.log(b.scaled);null!=b&&(b.scaled=!1,createjs.Tween.get(b,{override:!0}).to({scaleX:1,scaleY:1},100,createjs.Ease.quadIn))};n.MenuBar=createjs.promote(e,
"Container")})(window.WBdraw);(function(n){function e(c,a,b){this.initialize(c,a,b)}e.PLATFORM_DESKTOP="desktop";e.PLATFORM_WP7="wp7";e.PLATFORM_WP8="wp8";e.PLATFORM_IPHONE="iPhone";e.PLATFORM_IPHONE3="iPhone3";e.PLATFORM_IPHONE_PINNED="iPhonePinned";e.PLATFORM_IPHONE3_PINNED="iPhone3Pinned";e.QUALITY_NORMAL=0;e.QUALITY_HIGH=1;e.QUALITY_LOW=2;e.prototype={touchEnabled:!1,isIOS:!1,width:1024,height:622,scaleFactor:1,platform:null,quality:e.QUALITY_NORMAL,initialize:function(c,a,b){null!=a&&(this.width=a);null!=b&&(this.height=
b);this.platform=c;switch(c){case e.PLATFORM_DESKTOP:this.width=1024;this.height=622;break;case e.PLATFORM_WP7:this.width=800;this.height=410;this.scaleFactor=.6;this.quality=e.QUALITY_LOW;break;case e.PLATFORM_WP8:this.width=1280;this.height=700;this.scaleFactor=.6;this.quality=e.QUALITY_HIGH;break;case e.PLATFORM_IPHONE:this.width=960,this.height=640,this.scaleFactor=.5,this.quality=e.QUALITY_HIGH}},toString:function(){return"[Config.ConfigWB]"}};e.getContrast50=function(c){return 8388607.5<parseInt(c.substring(1),
16)?"black":"white"};e.luma=function(c){c=c.substring(1);c=parseInt(c,16);return.2126*(c>>16&255)+.7152*(c>>8&255)+.0722*(c>>0&255)};e.MidPoint=function(c,a){var b=0,e=0,b=a.x-c.x,e=a.y-c.y;return Math.sqrt(b*b+e*e)};e.rotateAngle=function(c,a){return angleDeg=180*Math.atan2(a.y-c.y,a.x-c.x)/Math.PI};e.convert2pos=function(c,a){if(0<a.x&&0>a.y||0<a.y&&0>a.x)if(console.log(c.type),"straight"==c.type||"links"==c.type)return console.log(">>>>>  +%+%+%--GOT IT HOOKED--%+%+%+%++"+c.constructor.name+"   ::>> "+
window.WBdraw.FormLine.name),a;0>a.x&&(a.x=Math.abs(a.x),c.x-=a.x);0>a.y&&(a.y=Math.abs(a.y),c.y-=a.y);return a};e.lineInterpolate=function(c,a,b,e){c=Math.abs(0-a);var n=Math.abs(0-b);a-=0;var g=b-0;e=Math.sqrt(Math.pow(c,2)+Math.pow(n,2))/e;b=a/e;c=g/e;a=n=0;for(var g=[],h=0;h<e;h++)n=0+b*h,a=0+c*h,g.push({x:Math.round(n),y:Math.round(a)});return g};n.ConfigWB=e})(window.WBdraw);
//# sourceMappingURL=final.map
